start
Namespace(accum_iter=1, adapter=0, adaptive_margin=0.0, bitfit=0, bs=32, cache_dir='/projectnb/textconv/cliao25/data', captioner='LLAVA', checkpoint='', d=768, data_dir='/scratch/cliao25', dataset='', ema=0.995, eval_only=0, ice=True, ice_k=5, ice_lambda=0.0, init_lam=0.0, iters_per_epoch=750, label_smoothing=0.0, layer_start_t=9, layer_start_v=9, lora=0, loss='ce', lr=2e-05, lr_decay=0.0, maple=0, margin=0.0, modelname='coca_ViT-L-14', n_descriptors=-1, n_epochs=1, optimizer='sgd', pretrained='laion2B-s13B-b90k', prompt_lr_multi=10.0, rank=4, resblock_adapter=0, samples_per_class=1, save_model=0, seed=1, shallow_prompt_init='a photo of', shots=16, skip_ema_iters=0, ssf=0, subsample_classes='all', temp=60.0, text_prompt_depth=0, text_prompt_length=0, train_text_encoder=0, train_visual_encoder=0, use_all_logits=False, use_fixed_lambda=False, v=3, visual_prompt_depth=0, visual_prompt_length=0, wd=1e-05)
EVALUATING ON DATASET:  ImageNet
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/imagenet/shot_16-seed_1.pkl
ImageNet has 50000 test samples
loaded image features from cache/image_features.y_truth.ImageNetcoca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  75.02999901771545
EVALUATING ON DATASET:  Caltech101
Reading split from /scratch/cliao25/caltech-101/split_zhou_Caltech101.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/caltech-101/shot_16-seed_1.pkl
Caltech101 has 2465 test samples
loaded image features from cache/image_features.y_truth.Caltech101coca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  97.32251763343811
EVALUATING ON DATASET:  OxfordPets
Reading split from /scratch/cliao25/oxford_pets/split_zhou_OxfordPets.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/oxford_pets/shot_16-seed_1.pkl
OxfordPets has 3669 test samples
loaded image features from cache/image_features.y_truth.OxfordPetscoca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  94.08558011054993
EVALUATING ON DATASET:  StanfordCars
Reading split from /scratch/cliao25/stanford_cars/split_zhou_StanfordCars.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/stanford_cars/shot_16-seed_1.pkl
StanfordCars has 8041 test samples
loaded image features from cache/image_features.y_truth.StanfordCarscoca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  92.63773560523987
EVALUATING ON DATASET:  Flowers102
Reading split from /scratch/cliao25/oxford_flowers/split_zhou_OxfordFlowers.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/oxford_flowers/shot_16-seed_1.pkl
Flowers102 has 2463 test samples
loaded image features from cache/image_features.y_truth.Flowers102coca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  77.01989412307739
EVALUATING ON DATASET:  Food101
Reading split from /scratch/cliao25/food-101/split_zhou_Food101.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/food-101/shot_16-seed_1.pkl
Food101 has 30300 test samples
loaded image features from cache/image_features.y_truth.Food101coca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  87.43894100189209
EVALUATING ON DATASET:  FGVCAircraft
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/fgvc_aircraft/shot_16-seed_1.pkl
FGVCAircraft has 3333 test samples
loaded image features from cache/image_features.y_truth.FGVCAircraftcoca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  36.36363446712494
EVALUATING ON DATASET:  SUN397
Reading split from /scratch/cliao25/sun397/split_zhou_SUN397.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/sun397/shot_16-seed_1.pkl
SUN397 has 19850 test samples
loaded image features from cache/image_features.y_truth.SUN397coca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  73.82367253303528
EVALUATING ON DATASET:  DTD
Reading split from /scratch/cliao25/dtd/split_zhou_DescribableTextures.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/dtd/shot_16-seed_1.pkl
DTD has 1692 test samples
loaded image features from cache/image_features.y_truth.DTDcoca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  57.97872543334961
EVALUATING ON DATASET:  EuroSAT
Reading split from /scratch/cliao25/eurosat/split_zhou_EuroSAT.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/eurosat/shot_16-seed_1.pkl
EuroSAT has 8100 test samples
loaded image features from cache/image_features.y_truth.EuroSATcoca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  57.43209719657898
EVALUATING ON DATASET:  UCF101
Reading split from /scratch/cliao25/ucf101/split_zhou_UCF101.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/ucf101/shot_16-seed_1.pkl
UCF101 has 3783 test samples
loaded image features from cache/image_features.y_truth.UCF101coca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  74.12106394767761
EVALUATING ON DATASET:  ImageNetV2
ImageNetV2 has 10000 test samples
loaded image features from cache/image_features.y_truth.ImageNetV2coca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  67.36999750137329
EVALUATING ON DATASET:  ImageNetSketch
ImageNetSketch has 50889 test samples
loaded image features from cache/image_features.y_truth.ImageNetSketchcoca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  63.538289070129395
EVALUATING ON DATASET:  ImageNetA
ImageNetA has 7500 test samples
loaded image features from cache/image_features.y_truth.ImageNetAcoca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  53.33333611488342
EVALUATING ON DATASET:  ImageNetR
ImageNetR has 30000 test samples
loaded image features from cache/image_features.y_truth.ImageNetRcoca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  86.90666556358337
Results:
,ImageNet,Caltech101,OxfordPets,StanfordCars,Flowers102,Food101,FGVCAircraft,SUN397,DTD,EuroSAT,UCF101,ImageNetV2,ImageNetSketch,ImageNetA,ImageNetR,
coca_ViT-L-14 laion2B-s13B-b90k LLAVA ZS,75.02999901771545,97.32251763343811,94.08558011054993,92.63773560523987,77.01989412307739,87.43894100189209,36.36363446712494,73.82367253303528,57.97872543334961,57.43209719657898,74.12106394767761,67.36999750137329,63.538289070129395,53.33333611488342,86.90666556358337,
Namespace(accum_iter=1, adapter=0, adaptive_margin=0.0, bitfit=0, bs=32, cache_dir='/projectnb/textconv/cliao25/data', captioner='LLAVA', checkpoint='', d=768, data_dir='/scratch/cliao25', dataset='', ema=0.995, eval_only=0, ice=True, ice_k=5, ice_lambda=0.1, init_lam=0.0, iters_per_epoch=750, label_smoothing=0.0, layer_start_t=9, layer_start_v=9, lora=0, loss='ce', lr=2e-05, lr_decay=0.0, maple=0, margin=0.0, modelname='coca_ViT-L-14', n_descriptors=-1, n_epochs=1, optimizer='sgd', pretrained='laion2B-s13B-b90k', prompt_lr_multi=10.0, rank=4, resblock_adapter=0, samples_per_class=1, save_model=0, seed=1, shallow_prompt_init='a photo of', shots=16, skip_ema_iters=0, ssf=0, subsample_classes='all', temp=60.0, text_prompt_depth=0, text_prompt_length=0, train_text_encoder=0, train_visual_encoder=0, use_all_logits=False, use_fixed_lambda=False, v=3, visual_prompt_depth=0, visual_prompt_length=0, wd=1e-05)
EVALUATING ON DATASET:  ImageNet
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/imagenet/shot_16-seed_1.pkl
ImageNet has 50000 test samples
loaded image features from cache/image_features.y_truth.ImageNetcoca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  75.19999742507935
EVALUATING ON DATASET:  Caltech101
Reading split from /scratch/cliao25/caltech-101/split_zhou_Caltech101.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/caltech-101/shot_16-seed_1.pkl
Caltech101 has 2465 test samples
loaded image features from cache/image_features.y_truth.Caltech101coca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  97.56592512130737
EVALUATING ON DATASET:  OxfordPets
Reading split from /scratch/cliao25/oxford_pets/split_zhou_OxfordPets.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/oxford_pets/shot_16-seed_1.pkl
OxfordPets has 3669 test samples
loaded image features from cache/image_features.y_truth.OxfordPetscoca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  93.92204880714417
EVALUATING ON DATASET:  StanfordCars
Reading split from /scratch/cliao25/stanford_cars/split_zhou_StanfordCars.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/stanford_cars/shot_16-seed_1.pkl
StanfordCars has 8041 test samples
loaded image features from cache/image_features.y_truth.StanfordCarscoca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  92.67504215240479
EVALUATING ON DATASET:  Flowers102
Reading split from /scratch/cliao25/oxford_flowers/split_zhou_OxfordFlowers.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/oxford_flowers/shot_16-seed_1.pkl
Flowers102 has 2463 test samples
loaded image features from cache/image_features.y_truth.Flowers102coca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  76.41088366508484
EVALUATING ON DATASET:  Food101
Reading split from /scratch/cliao25/food-101/split_zhou_Food101.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/food-101/shot_16-seed_1.pkl
Food101 has 30300 test samples
loaded image features from cache/image_features.y_truth.Food101coca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  87.83498406410217
EVALUATING ON DATASET:  FGVCAircraft
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/fgvc_aircraft/shot_16-seed_1.pkl
FGVCAircraft has 3333 test samples
loaded image features from cache/image_features.y_truth.FGVCAircraftcoca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  36.72367036342621
EVALUATING ON DATASET:  SUN397
Reading split from /scratch/cliao25/sun397/split_zhou_SUN397.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/sun397/shot_16-seed_1.pkl
SUN397 has 19850 test samples
loaded image features from cache/image_features.y_truth.SUN397coca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  74.10579323768616
EVALUATING ON DATASET:  DTD
Reading split from /scratch/cliao25/dtd/split_zhou_DescribableTextures.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/dtd/shot_16-seed_1.pkl
DTD has 1692 test samples
loaded image features from cache/image_features.y_truth.DTDcoca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  59.63357090950012
EVALUATING ON DATASET:  EuroSAT
Reading split from /scratch/cliao25/eurosat/split_zhou_EuroSAT.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/eurosat/shot_16-seed_1.pkl
EuroSAT has 8100 test samples
loaded image features from cache/image_features.y_truth.EuroSATcoca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  62.6419723033905
EVALUATING ON DATASET:  UCF101
Reading split from /scratch/cliao25/ucf101/split_zhou_UCF101.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/ucf101/shot_16-seed_1.pkl
UCF101 has 3783 test samples
loaded image features from cache/image_features.y_truth.UCF101coca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  75.52207112312317
EVALUATING ON DATASET:  ImageNetV2
ImageNetV2 has 10000 test samples
loaded image features from cache/image_features.y_truth.ImageNetV2coca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  67.57000088691711
EVALUATING ON DATASET:  ImageNetSketch
ImageNetSketch has 50889 test samples
loaded image features from cache/image_features.y_truth.ImageNetSketchcoca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  63.79374861717224
EVALUATING ON DATASET:  ImageNetA
ImageNetA has 7500 test samples
loaded image features from cache/image_features.y_truth.ImageNetAcoca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  55.33333420753479
EVALUATING ON DATASET:  ImageNetR
ImageNetR has 30000 test samples
loaded image features from cache/image_features.y_truth.ImageNetRcoca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  87.73000240325928
Results:
,ImageNet,Caltech101,OxfordPets,StanfordCars,Flowers102,Food101,FGVCAircraft,SUN397,DTD,EuroSAT,UCF101,ImageNetV2,ImageNetSketch,ImageNetA,ImageNetR,
coca_ViT-L-14 laion2B-s13B-b90k LLAVA ZS,75.19999742507935,97.56592512130737,93.92204880714417,92.67504215240479,76.41088366508484,87.83498406410217,36.72367036342621,74.10579323768616,59.63357090950012,62.6419723033905,75.52207112312317,67.57000088691711,63.79374861717224,55.33333420753479,87.73000240325928,
Namespace(accum_iter=1, adapter=0, adaptive_margin=0.0, bitfit=0, bs=32, cache_dir='/projectnb/textconv/cliao25/data', captioner='LLAVA', checkpoint='', d=768, data_dir='/scratch/cliao25', dataset='', ema=0.995, eval_only=0, ice=True, ice_k=5, ice_lambda=0.2, init_lam=0.0, iters_per_epoch=750, label_smoothing=0.0, layer_start_t=9, layer_start_v=9, lora=0, loss='ce', lr=2e-05, lr_decay=0.0, maple=0, margin=0.0, modelname='coca_ViT-L-14', n_descriptors=-1, n_epochs=1, optimizer='sgd', pretrained='laion2B-s13B-b90k', prompt_lr_multi=10.0, rank=4, resblock_adapter=0, samples_per_class=1, save_model=0, seed=1, shallow_prompt_init='a photo of', shots=16, skip_ema_iters=0, ssf=0, subsample_classes='all', temp=60.0, text_prompt_depth=0, text_prompt_length=0, train_text_encoder=0, train_visual_encoder=0, use_all_logits=False, use_fixed_lambda=False, v=3, visual_prompt_depth=0, visual_prompt_length=0, wd=1e-05)
EVALUATING ON DATASET:  ImageNet
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/imagenet/shot_16-seed_1.pkl
ImageNet has 50000 test samples
loaded image features from cache/image_features.y_truth.ImageNetcoca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  74.81200098991394
EVALUATING ON DATASET:  Caltech101
Reading split from /scratch/cliao25/caltech-101/split_zhou_Caltech101.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/caltech-101/shot_16-seed_1.pkl
Caltech101 has 2465 test samples
loaded image features from cache/image_features.y_truth.Caltech101coca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  97.6064920425415
EVALUATING ON DATASET:  OxfordPets
Reading split from /scratch/cliao25/oxford_pets/split_zhou_OxfordPets.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/oxford_pets/shot_16-seed_1.pkl
OxfordPets has 3669 test samples
loaded image features from cache/image_features.y_truth.OxfordPetscoca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  93.45870614051819
EVALUATING ON DATASET:  StanfordCars
Reading split from /scratch/cliao25/stanford_cars/split_zhou_StanfordCars.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/stanford_cars/shot_16-seed_1.pkl
StanfordCars has 8041 test samples
loaded image features from cache/image_features.y_truth.StanfordCarscoca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  92.62530207633972
EVALUATING ON DATASET:  Flowers102
Reading split from /scratch/cliao25/oxford_flowers/split_zhou_OxfordFlowers.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/oxford_flowers/shot_16-seed_1.pkl
Flowers102 has 2463 test samples
loaded image features from cache/image_features.y_truth.Flowers102coca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  74.25903677940369
EVALUATING ON DATASET:  Food101
Reading split from /scratch/cliao25/food-101/split_zhou_Food101.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/food-101/shot_16-seed_1.pkl
Food101 has 30300 test samples
loaded image features from cache/image_features.y_truth.Food101coca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  87.41254210472107
EVALUATING ON DATASET:  FGVCAircraft
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/fgvc_aircraft/shot_16-seed_1.pkl
FGVCAircraft has 3333 test samples
loaded image features from cache/image_features.y_truth.FGVCAircraftcoca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  36.84368431568146
EVALUATING ON DATASET:  SUN397
Reading split from /scratch/cliao25/sun397/split_zhou_SUN397.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/sun397/shot_16-seed_1.pkl
SUN397 has 19850 test samples
loaded image features from cache/image_features.y_truth.SUN397coca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  73.72795939445496
EVALUATING ON DATASET:  DTD
Reading split from /scratch/cliao25/dtd/split_zhou_DescribableTextures.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/dtd/shot_16-seed_1.pkl
DTD has 1692 test samples
loaded image features from cache/image_features.y_truth.DTDcoca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  60.40189266204834
EVALUATING ON DATASET:  EuroSAT
Reading split from /scratch/cliao25/eurosat/split_zhou_EuroSAT.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/eurosat/shot_16-seed_1.pkl
EuroSAT has 8100 test samples
loaded image features from cache/image_features.y_truth.EuroSATcoca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  64.4444465637207
EVALUATING ON DATASET:  UCF101
Reading split from /scratch/cliao25/ucf101/split_zhou_UCF101.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/ucf101/shot_16-seed_1.pkl
UCF101 has 3783 test samples
loaded image features from cache/image_features.y_truth.UCF101coca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  75.41633248329163
EVALUATING ON DATASET:  ImageNetV2
ImageNetV2 has 10000 test samples
loaded image features from cache/image_features.y_truth.ImageNetV2coca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  67.21000075340271
EVALUATING ON DATASET:  ImageNetSketch
ImageNetSketch has 50889 test samples
loaded image features from cache/image_features.y_truth.ImageNetSketchcoca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  63.343745470047
EVALUATING ON DATASET:  ImageNetA
ImageNetA has 7500 test samples
loaded image features from cache/image_features.y_truth.ImageNetAcoca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  55.613332986831665
EVALUATING ON DATASET:  ImageNetR
ImageNetR has 30000 test samples
loaded image features from cache/image_features.y_truth.ImageNetRcoca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  87.93666958808899
Results:
,ImageNet,Caltech101,OxfordPets,StanfordCars,Flowers102,Food101,FGVCAircraft,SUN397,DTD,EuroSAT,UCF101,ImageNetV2,ImageNetSketch,ImageNetA,ImageNetR,
coca_ViT-L-14 laion2B-s13B-b90k LLAVA ZS,74.81200098991394,97.6064920425415,93.45870614051819,92.62530207633972,74.25903677940369,87.41254210472107,36.84368431568146,73.72795939445496,60.40189266204834,64.4444465637207,75.41633248329163,67.21000075340271,63.343745470047,55.613332986831665,87.93666958808899,
Namespace(accum_iter=1, adapter=0, adaptive_margin=0.0, bitfit=0, bs=32, cache_dir='/projectnb/textconv/cliao25/data', captioner='LLAVA', checkpoint='', d=768, data_dir='/scratch/cliao25', dataset='', ema=0.995, eval_only=0, ice=True, ice_k=5, ice_lambda=0.3, init_lam=0.0, iters_per_epoch=750, label_smoothing=0.0, layer_start_t=9, layer_start_v=9, lora=0, loss='ce', lr=2e-05, lr_decay=0.0, maple=0, margin=0.0, modelname='coca_ViT-L-14', n_descriptors=-1, n_epochs=1, optimizer='sgd', pretrained='laion2B-s13B-b90k', prompt_lr_multi=10.0, rank=4, resblock_adapter=0, samples_per_class=1, save_model=0, seed=1, shallow_prompt_init='a photo of', shots=16, skip_ema_iters=0, ssf=0, subsample_classes='all', temp=60.0, text_prompt_depth=0, text_prompt_length=0, train_text_encoder=0, train_visual_encoder=0, use_all_logits=False, use_fixed_lambda=False, v=3, visual_prompt_depth=0, visual_prompt_length=0, wd=1e-05)
EVALUATING ON DATASET:  ImageNet
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/imagenet/shot_16-seed_1.pkl
ImageNet has 50000 test samples
loaded image features from cache/image_features.y_truth.ImageNetcoca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  74.0399956703186
EVALUATING ON DATASET:  Caltech101
Reading split from /scratch/cliao25/caltech-101/split_zhou_Caltech101.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/caltech-101/shot_16-seed_1.pkl
Caltech101 has 2465 test samples
loaded image features from cache/image_features.y_truth.Caltech101coca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  97.64705896377563
EVALUATING ON DATASET:  OxfordPets
Reading split from /scratch/cliao25/oxford_pets/split_zhou_OxfordPets.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/oxford_pets/shot_16-seed_1.pkl
OxfordPets has 3669 test samples
loaded image features from cache/image_features.y_truth.OxfordPetscoca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  92.85908937454224
EVALUATING ON DATASET:  StanfordCars
Reading split from /scratch/cliao25/stanford_cars/split_zhou_StanfordCars.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/stanford_cars/shot_16-seed_1.pkl
StanfordCars has 8041 test samples
loaded image features from cache/image_features.y_truth.StanfordCarscoca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  92.41388440132141
EVALUATING ON DATASET:  Flowers102
Reading split from /scratch/cliao25/oxford_flowers/split_zhou_OxfordFlowers.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/oxford_flowers/shot_16-seed_1.pkl
Flowers102 has 2463 test samples
loaded image features from cache/image_features.y_truth.Flowers102coca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  71.86357975006104
EVALUATING ON DATASET:  Food101
Reading split from /scratch/cliao25/food-101/split_zhou_Food101.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/food-101/shot_16-seed_1.pkl
Food101 has 30300 test samples
loaded image features from cache/image_features.y_truth.Food101coca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  86.67656779289246
EVALUATING ON DATASET:  FGVCAircraft
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/fgvc_aircraft/shot_16-seed_1.pkl
FGVCAircraft has 3333 test samples
loaded image features from cache/image_features.y_truth.FGVCAircraftcoca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  36.03360056877136
EVALUATING ON DATASET:  SUN397
Reading split from /scratch/cliao25/sun397/split_zhou_SUN397.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/sun397/shot_16-seed_1.pkl
SUN397 has 19850 test samples
loaded image features from cache/image_features.y_truth.SUN397coca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  73.10830950737
EVALUATING ON DATASET:  DTD
Reading split from /scratch/cliao25/dtd/split_zhou_DescribableTextures.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/dtd/shot_16-seed_1.pkl
DTD has 1692 test samples
loaded image features from cache/image_features.y_truth.DTDcoca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  60.69740056991577
EVALUATING ON DATASET:  EuroSAT
Reading split from /scratch/cliao25/eurosat/split_zhou_EuroSAT.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/eurosat/shot_16-seed_1.pkl
EuroSAT has 8100 test samples
loaded image features from cache/image_features.y_truth.EuroSATcoca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  65.02469182014465
EVALUATING ON DATASET:  UCF101
Reading split from /scratch/cliao25/ucf101/split_zhou_UCF101.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/ucf101/shot_16-seed_1.pkl
UCF101 has 3783 test samples
loaded image features from cache/image_features.y_truth.UCF101coca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  74.49114322662354
EVALUATING ON DATASET:  ImageNetV2
ImageNetV2 has 10000 test samples
loaded image features from cache/image_features.y_truth.ImageNetV2coca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  66.62999987602234
EVALUATING ON DATASET:  ImageNetSketch
ImageNetSketch has 50889 test samples
loaded image features from cache/image_features.y_truth.ImageNetSketchcoca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  62.67562508583069
EVALUATING ON DATASET:  ImageNetA
ImageNetA has 7500 test samples
loaded image features from cache/image_features.y_truth.ImageNetAcoca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  55.640000104904175
EVALUATING ON DATASET:  ImageNetR
ImageNetR has 30000 test samples
loaded image features from cache/image_features.y_truth.ImageNetRcoca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  87.91000247001648
Results:
,ImageNet,Caltech101,OxfordPets,StanfordCars,Flowers102,Food101,FGVCAircraft,SUN397,DTD,EuroSAT,UCF101,ImageNetV2,ImageNetSketch,ImageNetA,ImageNetR,
coca_ViT-L-14 laion2B-s13B-b90k LLAVA ZS,74.0399956703186,97.64705896377563,92.85908937454224,92.41388440132141,71.86357975006104,86.67656779289246,36.03360056877136,73.10830950737,60.69740056991577,65.02469182014465,74.49114322662354,66.62999987602234,62.67562508583069,55.640000104904175,87.91000247001648,
Namespace(accum_iter=1, adapter=0, adaptive_margin=0.0, bitfit=0, bs=32, cache_dir='/projectnb/textconv/cliao25/data', captioner='LLAVA', checkpoint='', d=768, data_dir='/scratch/cliao25', dataset='', ema=0.995, eval_only=0, ice=True, ice_k=5, ice_lambda=0.4, init_lam=0.0, iters_per_epoch=750, label_smoothing=0.0, layer_start_t=9, layer_start_v=9, lora=0, loss='ce', lr=2e-05, lr_decay=0.0, maple=0, margin=0.0, modelname='coca_ViT-L-14', n_descriptors=-1, n_epochs=1, optimizer='sgd', pretrained='laion2B-s13B-b90k', prompt_lr_multi=10.0, rank=4, resblock_adapter=0, samples_per_class=1, save_model=0, seed=1, shallow_prompt_init='a photo of', shots=16, skip_ema_iters=0, ssf=0, subsample_classes='all', temp=60.0, text_prompt_depth=0, text_prompt_length=0, train_text_encoder=0, train_visual_encoder=0, use_all_logits=False, use_fixed_lambda=False, v=3, visual_prompt_depth=0, visual_prompt_length=0, wd=1e-05)
EVALUATING ON DATASET:  ImageNet
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/imagenet/shot_16-seed_1.pkl
ImageNet has 50000 test samples
loaded image features from cache/image_features.y_truth.ImageNetcoca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  73.40199947357178
EVALUATING ON DATASET:  Caltech101
Reading split from /scratch/cliao25/caltech-101/split_zhou_Caltech101.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/caltech-101/shot_16-seed_1.pkl
Caltech101 has 2465 test samples
loaded image features from cache/image_features.y_truth.Caltech101coca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  97.56592512130737
EVALUATING ON DATASET:  OxfordPets
Reading split from /scratch/cliao25/oxford_pets/split_zhou_OxfordPets.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/oxford_pets/shot_16-seed_1.pkl
OxfordPets has 3669 test samples
loaded image features from cache/image_features.y_truth.OxfordPetscoca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  92.09593534469604
EVALUATING ON DATASET:  StanfordCars
Reading split from /scratch/cliao25/stanford_cars/split_zhou_StanfordCars.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/stanford_cars/shot_16-seed_1.pkl
StanfordCars has 8041 test samples
loaded image features from cache/image_features.y_truth.StanfordCarscoca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  92.28951930999756
EVALUATING ON DATASET:  Flowers102
Reading split from /scratch/cliao25/oxford_flowers/split_zhou_OxfordFlowers.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/oxford_flowers/shot_16-seed_1.pkl
Flowers102 has 2463 test samples
loaded image features from cache/image_features.y_truth.Flowers102coca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  68.6561107635498
EVALUATING ON DATASET:  Food101
Reading split from /scratch/cliao25/food-101/split_zhou_Food101.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/food-101/shot_16-seed_1.pkl
Food101 has 30300 test samples
loaded image features from cache/image_features.y_truth.Food101coca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  85.65016388893127
EVALUATING ON DATASET:  FGVCAircraft
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/fgvc_aircraft/shot_16-seed_1.pkl
FGVCAircraft has 3333 test samples
loaded image features from cache/image_features.y_truth.FGVCAircraftcoca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  35.88358759880066
EVALUATING ON DATASET:  SUN397
Reading split from /scratch/cliao25/sun397/split_zhou_SUN397.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/sun397/shot_16-seed_1.pkl
SUN397 has 19850 test samples
loaded image features from cache/image_features.y_truth.SUN397coca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  72.59445786476135
EVALUATING ON DATASET:  DTD
Reading split from /scratch/cliao25/dtd/split_zhou_DescribableTextures.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/dtd/shot_16-seed_1.pkl
DTD has 1692 test samples
loaded image features from cache/image_features.y_truth.DTDcoca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  60.75649857521057
EVALUATING ON DATASET:  EuroSAT
Reading split from /scratch/cliao25/eurosat/split_zhou_EuroSAT.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/eurosat/shot_16-seed_1.pkl
EuroSAT has 8100 test samples
loaded image features from cache/image_features.y_truth.EuroSATcoca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  64.8888885974884
EVALUATING ON DATASET:  UCF101
Reading split from /scratch/cliao25/ucf101/split_zhou_UCF101.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/ucf101/shot_16-seed_1.pkl
UCF101 has 3783 test samples
loaded image features from cache/image_features.y_truth.UCF101coca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  73.80385398864746
EVALUATING ON DATASET:  ImageNetV2
ImageNetV2 has 10000 test samples
loaded image features from cache/image_features.y_truth.ImageNetV2coca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  66.03999733924866
EVALUATING ON DATASET:  ImageNetSketch
ImageNetSketch has 50889 test samples
loaded image features from cache/image_features.y_truth.ImageNetSketchcoca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  61.809033155441284
EVALUATING ON DATASET:  ImageNetA
ImageNetA has 7500 test samples
loaded image features from cache/image_features.y_truth.ImageNetAcoca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  55.373334884643555
EVALUATING ON DATASET:  ImageNetR
ImageNetR has 30000 test samples
loaded image features from cache/image_features.y_truth.ImageNetRcoca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  87.67333626747131
Results:
,ImageNet,Caltech101,OxfordPets,StanfordCars,Flowers102,Food101,FGVCAircraft,SUN397,DTD,EuroSAT,UCF101,ImageNetV2,ImageNetSketch,ImageNetA,ImageNetR,
coca_ViT-L-14 laion2B-s13B-b90k LLAVA ZS,73.40199947357178,97.56592512130737,92.09593534469604,92.28951930999756,68.6561107635498,85.65016388893127,35.88358759880066,72.59445786476135,60.75649857521057,64.8888885974884,73.80385398864746,66.03999733924866,61.809033155441284,55.373334884643555,87.67333626747131,
Namespace(accum_iter=1, adapter=0, adaptive_margin=0.0, bitfit=0, bs=32, cache_dir='/projectnb/textconv/cliao25/data', captioner='LLAVA', checkpoint='', d=768, data_dir='/scratch/cliao25', dataset='', ema=0.995, eval_only=0, ice=True, ice_k=5, ice_lambda=0.5, init_lam=0.0, iters_per_epoch=750, label_smoothing=0.0, layer_start_t=9, layer_start_v=9, lora=0, loss='ce', lr=2e-05, lr_decay=0.0, maple=0, margin=0.0, modelname='coca_ViT-L-14', n_descriptors=-1, n_epochs=1, optimizer='sgd', pretrained='laion2B-s13B-b90k', prompt_lr_multi=10.0, rank=4, resblock_adapter=0, samples_per_class=1, save_model=0, seed=1, shallow_prompt_init='a photo of', shots=16, skip_ema_iters=0, ssf=0, subsample_classes='all', temp=60.0, text_prompt_depth=0, text_prompt_length=0, train_text_encoder=0, train_visual_encoder=0, use_all_logits=False, use_fixed_lambda=False, v=3, visual_prompt_depth=0, visual_prompt_length=0, wd=1e-05)
EVALUATING ON DATASET:  ImageNet
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/imagenet/shot_16-seed_1.pkl
ImageNet has 50000 test samples
loaded image features from cache/image_features.y_truth.ImageNetcoca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  72.61999845504761
EVALUATING ON DATASET:  Caltech101
Reading split from /scratch/cliao25/caltech-101/split_zhou_Caltech101.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/caltech-101/shot_16-seed_1.pkl
Caltech101 has 2465 test samples
loaded image features from cache/image_features.y_truth.Caltech101coca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  97.4442183971405
EVALUATING ON DATASET:  OxfordPets
Reading split from /scratch/cliao25/oxford_pets/split_zhou_OxfordPets.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/oxford_pets/shot_16-seed_1.pkl
OxfordPets has 3669 test samples
loaded image features from cache/image_features.y_truth.OxfordPetscoca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  91.38729572296143
EVALUATING ON DATASET:  StanfordCars
Reading split from /scratch/cliao25/stanford_cars/split_zhou_StanfordCars.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/stanford_cars/shot_16-seed_1.pkl
StanfordCars has 8041 test samples
loaded image features from cache/image_features.y_truth.StanfordCarscoca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  91.9288694858551
EVALUATING ON DATASET:  Flowers102
Reading split from /scratch/cliao25/oxford_flowers/split_zhou_OxfordFlowers.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/oxford_flowers/shot_16-seed_1.pkl
Flowers102 has 2463 test samples
loaded image features from cache/image_features.y_truth.Flowers102coca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  65.6516432762146
EVALUATING ON DATASET:  Food101
Reading split from /scratch/cliao25/food-101/split_zhou_Food101.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/food-101/shot_16-seed_1.pkl
Food101 has 30300 test samples
loaded image features from cache/image_features.y_truth.Food101coca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  84.44884419441223
EVALUATING ON DATASET:  FGVCAircraft
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/fgvc_aircraft/shot_16-seed_1.pkl
FGVCAircraft has 3333 test samples
loaded image features from cache/image_features.y_truth.FGVCAircraftcoca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  35.31352877616882
EVALUATING ON DATASET:  SUN397
Reading split from /scratch/cliao25/sun397/split_zhou_SUN397.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/sun397/shot_16-seed_1.pkl
SUN397 has 19850 test samples
loaded image features from cache/image_features.y_truth.SUN397coca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  71.91939353942871
EVALUATING ON DATASET:  DTD
Reading split from /scratch/cliao25/dtd/split_zhou_DescribableTextures.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/dtd/shot_16-seed_1.pkl
DTD has 1692 test samples
loaded image features from cache/image_features.y_truth.DTDcoca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  60.638296604156494
EVALUATING ON DATASET:  EuroSAT
Reading split from /scratch/cliao25/eurosat/split_zhou_EuroSAT.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/eurosat/shot_16-seed_1.pkl
EuroSAT has 8100 test samples
loaded image features from cache/image_features.y_truth.EuroSATcoca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  64.81481194496155
EVALUATING ON DATASET:  UCF101
Reading split from /scratch/cliao25/ucf101/split_zhou_UCF101.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/ucf101/shot_16-seed_1.pkl
UCF101 has 3783 test samples
loaded image features from cache/image_features.y_truth.UCF101coca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  73.06370139122009
EVALUATING ON DATASET:  ImageNetV2
ImageNetV2 has 10000 test samples
loaded image features from cache/image_features.y_truth.ImageNetV2coca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  65.31999707221985
EVALUATING ON DATASET:  ImageNetSketch
ImageNetSketch has 50889 test samples
loaded image features from cache/image_features.y_truth.ImageNetSketchcoca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  60.91689467430115
EVALUATING ON DATASET:  ImageNetA
ImageNetA has 7500 test samples
loaded image features from cache/image_features.y_truth.ImageNetAcoca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  54.98666763305664
EVALUATING ON DATASET:  ImageNetR
ImageNetR has 30000 test samples
loaded image features from cache/image_features.y_truth.ImageNetRcoca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  87.34666705131531
Results:
,ImageNet,Caltech101,OxfordPets,StanfordCars,Flowers102,Food101,FGVCAircraft,SUN397,DTD,EuroSAT,UCF101,ImageNetV2,ImageNetSketch,ImageNetA,ImageNetR,
coca_ViT-L-14 laion2B-s13B-b90k LLAVA ZS,72.61999845504761,97.4442183971405,91.38729572296143,91.9288694858551,65.6516432762146,84.44884419441223,35.31352877616882,71.91939353942871,60.638296604156494,64.81481194496155,73.06370139122009,65.31999707221985,60.91689467430115,54.98666763305664,87.34666705131531,
Namespace(accum_iter=1, adapter=0, adaptive_margin=0.0, bitfit=0, bs=32, cache_dir='/projectnb/textconv/cliao25/data', captioner='LLAVA', checkpoint='', d=768, data_dir='/scratch/cliao25', dataset='', ema=0.995, eval_only=0, ice=True, ice_k=5, ice_lambda=0.6, init_lam=0.0, iters_per_epoch=750, label_smoothing=0.0, layer_start_t=9, layer_start_v=9, lora=0, loss='ce', lr=2e-05, lr_decay=0.0, maple=0, margin=0.0, modelname='coca_ViT-L-14', n_descriptors=-1, n_epochs=1, optimizer='sgd', pretrained='laion2B-s13B-b90k', prompt_lr_multi=10.0, rank=4, resblock_adapter=0, samples_per_class=1, save_model=0, seed=1, shallow_prompt_init='a photo of', shots=16, skip_ema_iters=0, ssf=0, subsample_classes='all', temp=60.0, text_prompt_depth=0, text_prompt_length=0, train_text_encoder=0, train_visual_encoder=0, use_all_logits=False, use_fixed_lambda=False, v=3, visual_prompt_depth=0, visual_prompt_length=0, wd=1e-05)
EVALUATING ON DATASET:  ImageNet
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/imagenet/shot_16-seed_1.pkl
ImageNet has 50000 test samples
loaded image features from cache/image_features.y_truth.ImageNetcoca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  71.86799645423889
EVALUATING ON DATASET:  Caltech101
Reading split from /scratch/cliao25/caltech-101/split_zhou_Caltech101.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/caltech-101/shot_16-seed_1.pkl
Caltech101 has 2465 test samples
loaded image features from cache/image_features.y_truth.Caltech101coca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  96.99797034263611
EVALUATING ON DATASET:  OxfordPets
Reading split from /scratch/cliao25/oxford_pets/split_zhou_OxfordPets.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/oxford_pets/shot_16-seed_1.pkl
OxfordPets has 3669 test samples
loaded image features from cache/image_features.y_truth.OxfordPetscoca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  90.81493616104126
EVALUATING ON DATASET:  StanfordCars
Reading split from /scratch/cliao25/stanford_cars/split_zhou_StanfordCars.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/stanford_cars/shot_16-seed_1.pkl
StanfordCars has 8041 test samples
loaded image features from cache/image_features.y_truth.StanfordCarscoca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  91.4438545703888
EVALUATING ON DATASET:  Flowers102
Reading split from /scratch/cliao25/oxford_flowers/split_zhou_OxfordFlowers.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/oxford_flowers/shot_16-seed_1.pkl
Flowers102 has 2463 test samples
loaded image features from cache/image_features.y_truth.Flowers102coca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  62.8501832485199
EVALUATING ON DATASET:  Food101
Reading split from /scratch/cliao25/food-101/split_zhou_Food101.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/food-101/shot_16-seed_1.pkl
Food101 has 30300 test samples
loaded image features from cache/image_features.y_truth.Food101coca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  83.3003282546997
EVALUATING ON DATASET:  FGVCAircraft
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/fgvc_aircraft/shot_16-seed_1.pkl
FGVCAircraft has 3333 test samples
loaded image features from cache/image_features.y_truth.FGVCAircraftcoca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  34.233421087265015
EVALUATING ON DATASET:  SUN397
Reading split from /scratch/cliao25/sun397/split_zhou_SUN397.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/sun397/shot_16-seed_1.pkl
SUN397 has 19850 test samples
loaded image features from cache/image_features.y_truth.SUN397coca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  71.17884159088135
EVALUATING ON DATASET:  DTD
Reading split from /scratch/cliao25/dtd/split_zhou_DescribableTextures.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/dtd/shot_16-seed_1.pkl
DTD has 1692 test samples
loaded image features from cache/image_features.y_truth.DTDcoca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  60.69740056991577
EVALUATING ON DATASET:  EuroSAT
Reading split from /scratch/cliao25/eurosat/split_zhou_EuroSAT.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/eurosat/shot_16-seed_1.pkl
EuroSAT has 8100 test samples
loaded image features from cache/image_features.y_truth.EuroSATcoca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  64.53086137771606
EVALUATING ON DATASET:  UCF101
Reading split from /scratch/cliao25/ucf101/split_zhou_UCF101.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/ucf101/shot_16-seed_1.pkl
UCF101 has 3783 test samples
loaded image features from cache/image_features.y_truth.UCF101coca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  72.61432409286499
EVALUATING ON DATASET:  ImageNetV2
ImageNetV2 has 10000 test samples
loaded image features from cache/image_features.y_truth.ImageNetV2coca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  64.5799994468689
EVALUATING ON DATASET:  ImageNetSketch
ImageNetSketch has 50889 test samples
loaded image features from cache/image_features.y_truth.ImageNetSketchcoca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  60.1446270942688
EVALUATING ON DATASET:  ImageNetA
ImageNetA has 7500 test samples
loaded image features from cache/image_features.y_truth.ImageNetAcoca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  54.680001735687256
EVALUATING ON DATASET:  ImageNetR
ImageNetR has 30000 test samples
loaded image features from cache/image_features.y_truth.ImageNetRcoca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  87.05000281333923
Results:
,ImageNet,Caltech101,OxfordPets,StanfordCars,Flowers102,Food101,FGVCAircraft,SUN397,DTD,EuroSAT,UCF101,ImageNetV2,ImageNetSketch,ImageNetA,ImageNetR,
coca_ViT-L-14 laion2B-s13B-b90k LLAVA ZS,71.86799645423889,96.99797034263611,90.81493616104126,91.4438545703888,62.8501832485199,83.3003282546997,34.233421087265015,71.17884159088135,60.69740056991577,64.53086137771606,72.61432409286499,64.5799994468689,60.1446270942688,54.680001735687256,87.05000281333923,
Namespace(accum_iter=1, adapter=0, adaptive_margin=0.0, bitfit=0, bs=32, cache_dir='/projectnb/textconv/cliao25/data', captioner='LLAVA', checkpoint='', d=768, data_dir='/scratch/cliao25', dataset='', ema=0.995, eval_only=0, ice=True, ice_k=5, ice_lambda=0.7, init_lam=0.0, iters_per_epoch=750, label_smoothing=0.0, layer_start_t=9, layer_start_v=9, lora=0, loss='ce', lr=2e-05, lr_decay=0.0, maple=0, margin=0.0, modelname='coca_ViT-L-14', n_descriptors=-1, n_epochs=1, optimizer='sgd', pretrained='laion2B-s13B-b90k', prompt_lr_multi=10.0, rank=4, resblock_adapter=0, samples_per_class=1, save_model=0, seed=1, shallow_prompt_init='a photo of', shots=16, skip_ema_iters=0, ssf=0, subsample_classes='all', temp=60.0, text_prompt_depth=0, text_prompt_length=0, train_text_encoder=0, train_visual_encoder=0, use_all_logits=False, use_fixed_lambda=False, v=3, visual_prompt_depth=0, visual_prompt_length=0, wd=1e-05)
EVALUATING ON DATASET:  ImageNet
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/imagenet/shot_16-seed_1.pkl
ImageNet has 50000 test samples
loaded image features from cache/image_features.y_truth.ImageNetcoca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  71.18200063705444
EVALUATING ON DATASET:  Caltech101
Reading split from /scratch/cliao25/caltech-101/split_zhou_Caltech101.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/caltech-101/shot_16-seed_1.pkl
Caltech101 has 2465 test samples
loaded image features from cache/image_features.y_truth.Caltech101coca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  96.75456285476685
EVALUATING ON DATASET:  OxfordPets
Reading split from /scratch/cliao25/oxford_pets/split_zhou_OxfordPets.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/oxford_pets/shot_16-seed_1.pkl
OxfordPets has 3669 test samples
loaded image features from cache/image_features.y_truth.OxfordPetscoca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  89.77922797203064
EVALUATING ON DATASET:  StanfordCars
Reading split from /scratch/cliao25/stanford_cars/split_zhou_StanfordCars.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/stanford_cars/shot_16-seed_1.pkl
StanfordCars has 8041 test samples
loaded image features from cache/image_features.y_truth.StanfordCarscoca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  90.80960750579834
EVALUATING ON DATASET:  Flowers102
Reading split from /scratch/cliao25/oxford_flowers/split_zhou_OxfordFlowers.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/oxford_flowers/shot_16-seed_1.pkl
Flowers102 has 2463 test samples
loaded image features from cache/image_features.y_truth.Flowers102coca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  60.73893904685974
EVALUATING ON DATASET:  Food101
Reading split from /scratch/cliao25/food-101/split_zhou_Food101.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/food-101/shot_16-seed_1.pkl
Food101 has 30300 test samples
loaded image features from cache/image_features.y_truth.Food101coca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  82.30032920837402
EVALUATING ON DATASET:  FGVCAircraft
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/fgvc_aircraft/shot_16-seed_1.pkl
FGVCAircraft has 3333 test samples
loaded image features from cache/image_features.y_truth.FGVCAircraftcoca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  33.5733562707901
EVALUATING ON DATASET:  SUN397
Reading split from /scratch/cliao25/sun397/split_zhou_SUN397.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/sun397/shot_16-seed_1.pkl
SUN397 has 19850 test samples
loaded image features from cache/image_features.y_truth.SUN397coca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  70.41309475898743
EVALUATING ON DATASET:  DTD
Reading split from /scratch/cliao25/dtd/split_zhou_DescribableTextures.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/dtd/shot_16-seed_1.pkl
DTD has 1692 test samples
loaded image features from cache/image_features.y_truth.DTDcoca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  60.28369069099426
EVALUATING ON DATASET:  EuroSAT
Reading split from /scratch/cliao25/eurosat/split_zhou_EuroSAT.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/eurosat/shot_16-seed_1.pkl
EuroSAT has 8100 test samples
loaded image features from cache/image_features.y_truth.EuroSATcoca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  63.88888955116272
EVALUATING ON DATASET:  UCF101
Reading split from /scratch/cliao25/ucf101/split_zhou_UCF101.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/ucf101/shot_16-seed_1.pkl
UCF101 has 3783 test samples
loaded image features from cache/image_features.y_truth.UCF101coca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  72.03277349472046
EVALUATING ON DATASET:  ImageNetV2
ImageNetV2 has 10000 test samples
loaded image features from cache/image_features.y_truth.ImageNetV2coca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  63.999998569488525
EVALUATING ON DATASET:  ImageNetSketch
ImageNetSketch has 50889 test samples
loaded image features from cache/image_features.y_truth.ImageNetSketchcoca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  59.4372034072876
EVALUATING ON DATASET:  ImageNetA
ImageNetA has 7500 test samples
loaded image features from cache/image_features.y_truth.ImageNetAcoca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  54.26666736602783
EVALUATING ON DATASET:  ImageNetR
ImageNetR has 30000 test samples
loaded image features from cache/image_features.y_truth.ImageNetRcoca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  86.73333525657654
Results:
,ImageNet,Caltech101,OxfordPets,StanfordCars,Flowers102,Food101,FGVCAircraft,SUN397,DTD,EuroSAT,UCF101,ImageNetV2,ImageNetSketch,ImageNetA,ImageNetR,
coca_ViT-L-14 laion2B-s13B-b90k LLAVA ZS,71.18200063705444,96.75456285476685,89.77922797203064,90.80960750579834,60.73893904685974,82.30032920837402,33.5733562707901,70.41309475898743,60.28369069099426,63.88888955116272,72.03277349472046,63.999998569488525,59.4372034072876,54.26666736602783,86.73333525657654,
Namespace(accum_iter=1, adapter=0, adaptive_margin=0.0, bitfit=0, bs=32, cache_dir='/projectnb/textconv/cliao25/data', captioner='LLAVA', checkpoint='', d=768, data_dir='/scratch/cliao25', dataset='', ema=0.995, eval_only=0, ice=True, ice_k=5, ice_lambda=0.8, init_lam=0.0, iters_per_epoch=750, label_smoothing=0.0, layer_start_t=9, layer_start_v=9, lora=0, loss='ce', lr=2e-05, lr_decay=0.0, maple=0, margin=0.0, modelname='coca_ViT-L-14', n_descriptors=-1, n_epochs=1, optimizer='sgd', pretrained='laion2B-s13B-b90k', prompt_lr_multi=10.0, rank=4, resblock_adapter=0, samples_per_class=1, save_model=0, seed=1, shallow_prompt_init='a photo of', shots=16, skip_ema_iters=0, ssf=0, subsample_classes='all', temp=60.0, text_prompt_depth=0, text_prompt_length=0, train_text_encoder=0, train_visual_encoder=0, use_all_logits=False, use_fixed_lambda=False, v=3, visual_prompt_depth=0, visual_prompt_length=0, wd=1e-05)
EVALUATING ON DATASET:  ImageNet
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/imagenet/shot_16-seed_1.pkl
ImageNet has 50000 test samples
loaded image features from cache/image_features.y_truth.ImageNetcoca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  70.46799659729004
EVALUATING ON DATASET:  Caltech101
Reading split from /scratch/cliao25/caltech-101/split_zhou_Caltech101.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/caltech-101/shot_16-seed_1.pkl
Caltech101 has 2465 test samples
loaded image features from cache/image_features.y_truth.Caltech101coca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  96.59229516983032
EVALUATING ON DATASET:  OxfordPets
Reading split from /scratch/cliao25/oxford_pets/split_zhou_OxfordPets.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/oxford_pets/shot_16-seed_1.pkl
OxfordPets has 3669 test samples
loaded image features from cache/image_features.y_truth.OxfordPetscoca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  89.20686841011047
EVALUATING ON DATASET:  StanfordCars
Reading split from /scratch/cliao25/stanford_cars/split_zhou_StanfordCars.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/stanford_cars/shot_16-seed_1.pkl
StanfordCars has 8041 test samples
loaded image features from cache/image_features.y_truth.StanfordCarscoca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  90.21266102790833
EVALUATING ON DATASET:  Flowers102
Reading split from /scratch/cliao25/oxford_flowers/split_zhou_OxfordFlowers.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/oxford_flowers/shot_16-seed_1.pkl
Flowers102 has 2463 test samples
loaded image features from cache/image_features.y_truth.Flowers102coca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  58.6682915687561
EVALUATING ON DATASET:  Food101
Reading split from /scratch/cliao25/food-101/split_zhou_Food101.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/food-101/shot_16-seed_1.pkl
Food101 has 30300 test samples
loaded image features from cache/image_features.y_truth.Food101coca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  81.33993148803711
EVALUATING ON DATASET:  FGVCAircraft
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/fgvc_aircraft/shot_16-seed_1.pkl
FGVCAircraft has 3333 test samples
loaded image features from cache/image_features.y_truth.FGVCAircraftcoca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  32.79327750205994
EVALUATING ON DATASET:  SUN397
Reading split from /scratch/cliao25/sun397/split_zhou_SUN397.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/sun397/shot_16-seed_1.pkl
SUN397 has 19850 test samples
loaded image features from cache/image_features.y_truth.SUN397coca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  69.72795724868774
EVALUATING ON DATASET:  DTD
Reading split from /scratch/cliao25/dtd/split_zhou_DescribableTextures.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/dtd/shot_16-seed_1.pkl
DTD has 1692 test samples
loaded image features from cache/image_features.y_truth.DTDcoca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  59.929078817367554
EVALUATING ON DATASET:  EuroSAT
Reading split from /scratch/cliao25/eurosat/split_zhou_EuroSAT.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/eurosat/shot_16-seed_1.pkl
EuroSAT has 8100 test samples
loaded image features from cache/image_features.y_truth.EuroSATcoca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  63.29629421234131
EVALUATING ON DATASET:  UCF101
Reading split from /scratch/cliao25/ucf101/split_zhou_UCF101.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/ucf101/shot_16-seed_1.pkl
UCF101 has 3783 test samples
loaded image features from cache/image_features.y_truth.UCF101coca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  71.4512288570404
EVALUATING ON DATASET:  ImageNetV2
ImageNetV2 has 10000 test samples
loaded image features from cache/image_features.y_truth.ImageNetV2coca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  63.33000063896179
EVALUATING ON DATASET:  ImageNetSketch
ImageNetSketch has 50889 test samples
loaded image features from cache/image_features.y_truth.ImageNetSketchcoca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  58.79462957382202
EVALUATING ON DATASET:  ImageNetA
ImageNetA has 7500 test samples
loaded image features from cache/image_features.y_truth.ImageNetAcoca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  53.68000268936157
EVALUATING ON DATASET:  ImageNetR
ImageNetR has 30000 test samples
loaded image features from cache/image_features.y_truth.ImageNetRcoca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  86.3966703414917
Results:
,ImageNet,Caltech101,OxfordPets,StanfordCars,Flowers102,Food101,FGVCAircraft,SUN397,DTD,EuroSAT,UCF101,ImageNetV2,ImageNetSketch,ImageNetA,ImageNetR,
coca_ViT-L-14 laion2B-s13B-b90k LLAVA ZS,70.46799659729004,96.59229516983032,89.20686841011047,90.21266102790833,58.6682915687561,81.33993148803711,32.79327750205994,69.72795724868774,59.929078817367554,63.29629421234131,71.4512288570404,63.33000063896179,58.79462957382202,53.68000268936157,86.3966703414917,
Namespace(accum_iter=1, adapter=0, adaptive_margin=0.0, bitfit=0, bs=32, cache_dir='/projectnb/textconv/cliao25/data', captioner='LLAVA', checkpoint='', d=768, data_dir='/scratch/cliao25', dataset='', ema=0.995, eval_only=0, ice=True, ice_k=5, ice_lambda=0.9, init_lam=0.0, iters_per_epoch=750, label_smoothing=0.0, layer_start_t=9, layer_start_v=9, lora=0, loss='ce', lr=2e-05, lr_decay=0.0, maple=0, margin=0.0, modelname='coca_ViT-L-14', n_descriptors=-1, n_epochs=1, optimizer='sgd', pretrained='laion2B-s13B-b90k', prompt_lr_multi=10.0, rank=4, resblock_adapter=0, samples_per_class=1, save_model=0, seed=1, shallow_prompt_init='a photo of', shots=16, skip_ema_iters=0, ssf=0, subsample_classes='all', temp=60.0, text_prompt_depth=0, text_prompt_length=0, train_text_encoder=0, train_visual_encoder=0, use_all_logits=False, use_fixed_lambda=False, v=3, visual_prompt_depth=0, visual_prompt_length=0, wd=1e-05)
EVALUATING ON DATASET:  ImageNet
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/imagenet/shot_16-seed_1.pkl
ImageNet has 50000 test samples
loaded image features from cache/image_features.y_truth.ImageNetcoca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  69.83199715614319
EVALUATING ON DATASET:  Caltech101
Reading split from /scratch/cliao25/caltech-101/split_zhou_Caltech101.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/caltech-101/shot_16-seed_1.pkl
Caltech101 has 2465 test samples
loaded image features from cache/image_features.y_truth.Caltech101coca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  96.38945460319519
EVALUATING ON DATASET:  OxfordPets
Reading split from /scratch/cliao25/oxford_pets/split_zhou_OxfordPets.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/oxford_pets/shot_16-seed_1.pkl
OxfordPets has 3669 test samples
loaded image features from cache/image_features.y_truth.OxfordPetscoca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  88.33469152450562
EVALUATING ON DATASET:  StanfordCars
Reading split from /scratch/cliao25/stanford_cars/split_zhou_StanfordCars.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/stanford_cars/shot_16-seed_1.pkl
StanfordCars has 8041 test samples
loaded image features from cache/image_features.y_truth.StanfordCarscoca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  89.61572051048279
EVALUATING ON DATASET:  Flowers102
Reading split from /scratch/cliao25/oxford_flowers/split_zhou_OxfordFlowers.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/oxford_flowers/shot_16-seed_1.pkl
Flowers102 has 2463 test samples
loaded image features from cache/image_features.y_truth.Flowers102coca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  56.841254234313965
EVALUATING ON DATASET:  Food101
Reading split from /scratch/cliao25/food-101/split_zhou_Food101.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/food-101/shot_16-seed_1.pkl
Food101 has 30300 test samples
loaded image features from cache/image_features.y_truth.Food101coca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  80.46864867210388
EVALUATING ON DATASET:  FGVCAircraft
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/fgvc_aircraft/shot_16-seed_1.pkl
FGVCAircraft has 3333 test samples
loaded image features from cache/image_features.y_truth.FGVCAircraftcoca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  32.25322365760803
EVALUATING ON DATASET:  SUN397
Reading split from /scratch/cliao25/sun397/split_zhou_SUN397.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/sun397/shot_16-seed_1.pkl
SUN397 has 19850 test samples
loaded image features from cache/image_features.y_truth.SUN397coca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  68.91687512397766
EVALUATING ON DATASET:  DTD
Reading split from /scratch/cliao25/dtd/split_zhou_DescribableTextures.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/dtd/shot_16-seed_1.pkl
DTD has 1692 test samples
loaded image features from cache/image_features.y_truth.DTDcoca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  59.45626497268677
EVALUATING ON DATASET:  EuroSAT
Reading split from /scratch/cliao25/eurosat/split_zhou_EuroSAT.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/eurosat/shot_16-seed_1.pkl
EuroSAT has 8100 test samples
loaded image features from cache/image_features.y_truth.EuroSATcoca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  62.753087282180786
EVALUATING ON DATASET:  UCF101
Reading split from /scratch/cliao25/ucf101/split_zhou_UCF101.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/ucf101/shot_16-seed_1.pkl
UCF101 has 3783 test samples
loaded image features from cache/image_features.y_truth.UCF101coca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  71.00184559822083
EVALUATING ON DATASET:  ImageNetV2
ImageNetV2 has 10000 test samples
loaded image features from cache/image_features.y_truth.ImageNetV2coca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  62.59999871253967
EVALUATING ON DATASET:  ImageNetSketch
ImageNetSketch has 50889 test samples
loaded image features from cache/image_features.y_truth.ImageNetSketchcoca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  58.21689963340759
EVALUATING ON DATASET:  ImageNetA
ImageNetA has 7500 test samples
loaded image features from cache/image_features.y_truth.ImageNetAcoca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  53.29333543777466
EVALUATING ON DATASET:  ImageNetR
ImageNetR has 30000 test samples
loaded image features from cache/image_features.y_truth.ImageNetRcoca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  86.12333536148071
Results:
,ImageNet,Caltech101,OxfordPets,StanfordCars,Flowers102,Food101,FGVCAircraft,SUN397,DTD,EuroSAT,UCF101,ImageNetV2,ImageNetSketch,ImageNetA,ImageNetR,
coca_ViT-L-14 laion2B-s13B-b90k LLAVA ZS,69.83199715614319,96.38945460319519,88.33469152450562,89.61572051048279,56.841254234313965,80.46864867210388,32.25322365760803,68.91687512397766,59.45626497268677,62.753087282180786,71.00184559822083,62.59999871253967,58.21689963340759,53.29333543777466,86.12333536148071,
Namespace(accum_iter=1, adapter=0, adaptive_margin=0.0, bitfit=0, bs=32, cache_dir='/projectnb/textconv/cliao25/data', captioner='LLAVA', checkpoint='', d=768, data_dir='/scratch/cliao25', dataset='', ema=0.995, eval_only=0, ice=True, ice_k=5, ice_lambda=1.0, init_lam=0.0, iters_per_epoch=750, label_smoothing=0.0, layer_start_t=9, layer_start_v=9, lora=0, loss='ce', lr=2e-05, lr_decay=0.0, maple=0, margin=0.0, modelname='coca_ViT-L-14', n_descriptors=-1, n_epochs=1, optimizer='sgd', pretrained='laion2B-s13B-b90k', prompt_lr_multi=10.0, rank=4, resblock_adapter=0, samples_per_class=1, save_model=0, seed=1, shallow_prompt_init='a photo of', shots=16, skip_ema_iters=0, ssf=0, subsample_classes='all', temp=60.0, text_prompt_depth=0, text_prompt_length=0, train_text_encoder=0, train_visual_encoder=0, use_all_logits=False, use_fixed_lambda=False, v=3, visual_prompt_depth=0, visual_prompt_length=0, wd=1e-05)
EVALUATING ON DATASET:  ImageNet
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/imagenet/shot_16-seed_1.pkl
ImageNet has 50000 test samples
loaded image features from cache/image_features.y_truth.ImageNetcoca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  69.22000050544739
EVALUATING ON DATASET:  Caltech101
Reading split from /scratch/cliao25/caltech-101/split_zhou_Caltech101.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/caltech-101/shot_16-seed_1.pkl
Caltech101 has 2465 test samples
loaded image features from cache/image_features.y_truth.Caltech101coca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  96.18661403656006
EVALUATING ON DATASET:  OxfordPets
Reading split from /scratch/cliao25/oxford_pets/split_zhou_OxfordPets.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/oxford_pets/shot_16-seed_1.pkl
OxfordPets has 3669 test samples
loaded image features from cache/image_features.y_truth.OxfordPetscoca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  87.21722364425659
EVALUATING ON DATASET:  StanfordCars
Reading split from /scratch/cliao25/stanford_cars/split_zhou_StanfordCars.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/stanford_cars/shot_16-seed_1.pkl
StanfordCars has 8041 test samples
loaded image features from cache/image_features.y_truth.StanfordCarscoca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  88.8695478439331
EVALUATING ON DATASET:  Flowers102
Reading split from /scratch/cliao25/oxford_flowers/split_zhou_OxfordFlowers.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/oxford_flowers/shot_16-seed_1.pkl
Flowers102 has 2463 test samples
loaded image features from cache/image_features.y_truth.Flowers102coca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  54.405200481414795
EVALUATING ON DATASET:  Food101
Reading split from /scratch/cliao25/food-101/split_zhou_Food101.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/food-101/shot_16-seed_1.pkl
Food101 has 30300 test samples
loaded image features from cache/image_features.y_truth.Food101coca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  79.68316674232483
EVALUATING ON DATASET:  FGVCAircraft
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/fgvc_aircraft/shot_16-seed_1.pkl
FGVCAircraft has 3333 test samples
loaded image features from cache/image_features.y_truth.FGVCAircraftcoca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  31.923189759254456
EVALUATING ON DATASET:  SUN397
Reading split from /scratch/cliao25/sun397/split_zhou_SUN397.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/sun397/shot_16-seed_1.pkl
SUN397 has 19850 test samples
loaded image features from cache/image_features.y_truth.SUN397coca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  68.38790774345398
EVALUATING ON DATASET:  DTD
Reading split from /scratch/cliao25/dtd/split_zhou_DescribableTextures.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/dtd/shot_16-seed_1.pkl
DTD has 1692 test samples
loaded image features from cache/image_features.y_truth.DTDcoca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  59.45626497268677
EVALUATING ON DATASET:  EuroSAT
Reading split from /scratch/cliao25/eurosat/split_zhou_EuroSAT.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/eurosat/shot_16-seed_1.pkl
EuroSAT has 8100 test samples
loaded image features from cache/image_features.y_truth.EuroSATcoca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  62.209874391555786
EVALUATING ON DATASET:  UCF101
Reading split from /scratch/cliao25/ucf101/split_zhou_UCF101.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/ucf101/shot_16-seed_1.pkl
UCF101 has 3783 test samples
loaded image features from cache/image_features.y_truth.UCF101coca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  70.57890295982361
EVALUATING ON DATASET:  ImageNetV2
ImageNetV2 has 10000 test samples
loaded image features from cache/image_features.y_truth.ImageNetV2coca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  62.049996852874756
EVALUATING ON DATASET:  ImageNetSketch
ImageNetSketch has 50889 test samples
loaded image features from cache/image_features.y_truth.ImageNetSketchcoca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  57.58218765258789
EVALUATING ON DATASET:  ImageNetA
ImageNetA has 7500 test samples
loaded image features from cache/image_features.y_truth.ImageNetAcoca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  52.89333462715149
EVALUATING ON DATASET:  ImageNetR
ImageNetR has 30000 test samples
loaded image features from cache/image_features.y_truth.ImageNetRcoca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  85.87666749954224
Results:
,ImageNet,Caltech101,OxfordPets,StanfordCars,Flowers102,Food101,FGVCAircraft,SUN397,DTD,EuroSAT,UCF101,ImageNetV2,ImageNetSketch,ImageNetA,ImageNetR,
coca_ViT-L-14 laion2B-s13B-b90k LLAVA ZS,69.22000050544739,96.18661403656006,87.21722364425659,88.8695478439331,54.405200481414795,79.68316674232483,31.923189759254456,68.38790774345398,59.45626497268677,62.209874391555786,70.57890295982361,62.049996852874756,57.58218765258789,52.89333462715149,85.87666749954224,
