Namespace(accum_iter=1, adapter=0, adaptive_margin=0.0, bitfit=0, bs=32, cache_dir='/projectnb/textconv/cliao25/data', captioner='COCA', checkpoint='', d=768, data_dir='/scratch/cliao25', dataset='', ema=0.995, eval_only=0, ice=True, ice_k=5, ice_lambda=0.08, init_lam=0.0, iters_per_epoch=750, label_smoothing=0.0, layer_start_t=9, layer_start_v=9, lora=0, loss='ce', lr=2e-05, lr_decay=0.0, maple=0, margin=0.0, modelname='coca_ViT-L-14', n_descriptors=-1, n_epochs=1, optimizer='sgd', pretrained='laion2B-s13B-b90k', prompt_lr_multi=10.0, rank=4, resblock_adapter=0, samples_per_class=1, save_model=0, seed=1, shallow_prompt_init='a photo of', shots=16, skip_ema_iters=0, ssf=0, subsample_classes='all', temp=60.0, text_prompt_depth=0, text_prompt_length=0, train_text_encoder=0, train_visual_encoder=0, use_all_logits=False, use_fixed_lambda=False, v=3, visual_prompt_depth=0, visual_prompt_length=0, wd=1e-05)
EVALUATING ON DATASET:  ImageNet
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/imagenet/shot_16-seed_1.pkl
ImageNet has 50000 test samples
loaded image features from cache/image_features.y_truth.ImageNetcoca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  75.35199522972107
EVALUATING ON DATASET:  Caltech101
Reading split from /scratch/cliao25/caltech-101/split_zhou_Caltech101.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/caltech-101/shot_16-seed_1.pkl
Caltech101 has 2465 test samples
loaded image features from cache/image_features.y_truth.Caltech101coca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  97.2819447517395
EVALUATING ON DATASET:  OxfordPets
Reading split from /scratch/cliao25/oxford_pets/split_zhou_OxfordPets.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/oxford_pets/shot_16-seed_1.pkl
OxfordPets has 3669 test samples
loaded image features from cache/image_features.y_truth.OxfordPetscoca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  93.84028315544128
EVALUATING ON DATASET:  StanfordCars
Reading split from /scratch/cliao25/stanford_cars/split_zhou_StanfordCars.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/stanford_cars/shot_16-seed_1.pkl
StanfordCars has 8041 test samples
loaded image features from cache/image_features.y_truth.StanfordCarscoca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  92.96107888221741
EVALUATING ON DATASET:  Flowers102
Reading split from /scratch/cliao25/oxford_flowers/split_zhou_OxfordFlowers.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/oxford_flowers/shot_16-seed_1.pkl
Flowers102 has 2463 test samples
loaded image features from cache/image_features.y_truth.Flowers102coca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  77.79131531715393
EVALUATING ON DATASET:  Food101
Reading split from /scratch/cliao25/food-101/split_zhou_Food101.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/food-101/shot_16-seed_1.pkl
Food101 has 30300 test samples
loaded image features from cache/image_features.y_truth.Food101coca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  87.71287202835083
EVALUATING ON DATASET:  FGVCAircraft
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/fgvc_aircraft/shot_16-seed_1.pkl
FGVCAircraft has 3333 test samples
loaded image features from cache/image_features.y_truth.FGVCAircraftcoca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  39.51394855976105
EVALUATING ON DATASET:  SUN397
Reading split from /scratch/cliao25/sun397/split_zhou_SUN397.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/sun397/shot_16-seed_1.pkl
SUN397 has 19850 test samples
loaded image features from cache/image_features.y_truth.SUN397coca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  74.12090301513672
EVALUATING ON DATASET:  DTD
Reading split from /scratch/cliao25/dtd/split_zhou_DescribableTextures.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/dtd/shot_16-seed_1.pkl
DTD has 1692 test samples
loaded image features from cache/image_features.y_truth.DTDcoca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  59.515368938446045
EVALUATING ON DATASET:  EuroSAT
Reading split from /scratch/cliao25/eurosat/split_zhou_EuroSAT.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/eurosat/shot_16-seed_1.pkl
EuroSAT has 8100 test samples
loaded image features from cache/image_features.y_truth.EuroSATcoca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  61.000001430511475
EVALUATING ON DATASET:  UCF101
Reading split from /scratch/cliao25/ucf101/split_zhou_UCF101.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/ucf101/shot_16-seed_1.pkl
UCF101 has 3783 test samples
loaded image features from cache/image_features.y_truth.UCF101coca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  74.86121654510498
EVALUATING ON DATASET:  ImageNetV2
ImageNetV2 has 10000 test samples
loaded image features from cache/image_features.y_truth.ImageNetV2coca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  67.82000064849854
EVALUATING ON DATASET:  ImageNetSketch
ImageNetSketch has 50889 test samples
loaded image features from cache/image_features.y_truth.ImageNetSketchcoca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  63.88021111488342
EVALUATING ON DATASET:  ImageNetA
ImageNetA has 7500 test samples
loaded image features from cache/image_features.y_truth.ImageNetAcoca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  54.13333177566528
EVALUATING ON DATASET:  ImageNetR
ImageNetR has 30000 test samples
loaded image features from cache/image_features.y_truth.ImageNetRcoca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  87.42333650588989
Results:
,ImageNet,Caltech101,OxfordPets,StanfordCars,Flowers102,Food101,FGVCAircraft,SUN397,DTD,EuroSAT,UCF101,ImageNetV2,ImageNetSketch,ImageNetA,ImageNetR,
coca_ViT-L-14 laion2B-s13B-b90k COCA ZS,75.35199522972107,97.2819447517395,93.84028315544128,92.96107888221741,77.79131531715393,87.71287202835083,39.51394855976105,74.12090301513672,59.515368938446045,61.000001430511475,74.86121654510498,67.82000064849854,63.88021111488342,54.13333177566528,87.42333650588989,
Namespace(accum_iter=1, adapter=0, adaptive_margin=0.0, bitfit=0, bs=32, cache_dir='/projectnb/textconv/cliao25/data', captioner='BLIP', checkpoint='', d=768, data_dir='/scratch/cliao25', dataset='', ema=0.995, eval_only=0, ice=True, ice_k=5, ice_lambda=0.08, init_lam=0.0, iters_per_epoch=750, label_smoothing=0.0, layer_start_t=9, layer_start_v=9, lora=0, loss='ce', lr=2e-05, lr_decay=0.0, maple=0, margin=0.0, modelname='coca_ViT-L-14', n_descriptors=-1, n_epochs=1, optimizer='sgd', pretrained='laion2B-s13B-b90k', prompt_lr_multi=10.0, rank=4, resblock_adapter=0, samples_per_class=1, save_model=0, seed=1, shallow_prompt_init='a photo of', shots=16, skip_ema_iters=0, ssf=0, subsample_classes='all', temp=60.0, text_prompt_depth=0, text_prompt_length=0, train_text_encoder=0, train_visual_encoder=0, use_all_logits=False, use_fixed_lambda=False, v=3, visual_prompt_depth=0, visual_prompt_length=0, wd=1e-05)
EVALUATING ON DATASET:  ImageNet
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/imagenet/shot_16-seed_1.pkl
ImageNet has 50000 test samples
loaded image features from cache/image_features.y_truth.ImageNetcoca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  75.46799778938293
EVALUATING ON DATASET:  Caltech101
Reading split from /scratch/cliao25/caltech-101/split_zhou_Caltech101.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/caltech-101/shot_16-seed_1.pkl
Caltech101 has 2465 test samples
loaded image features from cache/image_features.y_truth.Caltech101coca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  97.24137783050537
EVALUATING ON DATASET:  OxfordPets
Reading split from /scratch/cliao25/oxford_pets/split_zhou_OxfordPets.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/oxford_pets/shot_16-seed_1.pkl
OxfordPets has 3669 test samples
loaded image features from cache/image_features.y_truth.OxfordPetscoca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  94.05832290649414
EVALUATING ON DATASET:  StanfordCars
Reading split from /scratch/cliao25/stanford_cars/split_zhou_StanfordCars.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/stanford_cars/shot_16-seed_1.pkl
StanfordCars has 8041 test samples
loaded image features from cache/image_features.y_truth.StanfordCarscoca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  92.79940724372864
EVALUATING ON DATASET:  Flowers102
Reading split from /scratch/cliao25/oxford_flowers/split_zhou_OxfordFlowers.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/oxford_flowers/shot_16-seed_1.pkl
Flowers102 has 2463 test samples
loaded image features from cache/image_features.y_truth.Flowers102coca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  77.26350426673889
EVALUATING ON DATASET:  Food101
Reading split from /scratch/cliao25/food-101/split_zhou_Food101.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/food-101/shot_16-seed_1.pkl
Food101 has 30300 test samples
loaded image features from cache/image_features.y_truth.Food101coca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  88.06930780410767
EVALUATING ON DATASET:  FGVCAircraft
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/fgvc_aircraft/shot_16-seed_1.pkl
FGVCAircraft has 3333 test samples
loaded image features from cache/image_features.y_truth.FGVCAircraftcoca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  37.02370226383209
EVALUATING ON DATASET:  SUN397
Reading split from /scratch/cliao25/sun397/split_zhou_SUN397.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/sun397/shot_16-seed_1.pkl
SUN397 has 19850 test samples
loaded image features from cache/image_features.y_truth.SUN397coca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  74.211585521698
EVALUATING ON DATASET:  DTD
Reading split from /scratch/cliao25/dtd/split_zhou_DescribableTextures.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/dtd/shot_16-seed_1.pkl
DTD has 1692 test samples
loaded image features from cache/image_features.y_truth.DTDcoca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  59.7517728805542
EVALUATING ON DATASET:  EuroSAT
Reading split from /scratch/cliao25/eurosat/split_zhou_EuroSAT.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/eurosat/shot_16-seed_1.pkl
EuroSAT has 8100 test samples
loaded image features from cache/image_features.y_truth.EuroSATcoca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  60.148149728775024
EVALUATING ON DATASET:  UCF101
Reading split from /scratch/cliao25/ucf101/split_zhou_UCF101.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/ucf101/shot_16-seed_1.pkl
UCF101 has 3783 test samples
loaded image features from cache/image_features.y_truth.UCF101coca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  75.49563646316528
EVALUATING ON DATASET:  ImageNetV2
ImageNetV2 has 10000 test samples
loaded image features from cache/image_features.y_truth.ImageNetV2coca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  67.96000003814697
EVALUATING ON DATASET:  ImageNetSketch
ImageNetSketch has 50889 test samples
loaded image features from cache/image_features.y_truth.ImageNetSketchcoca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  64.15138840675354
EVALUATING ON DATASET:  ImageNetA
ImageNetA has 7500 test samples
loaded image features from cache/image_features.y_truth.ImageNetAcoca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  56.18667006492615
EVALUATING ON DATASET:  ImageNetR
ImageNetR has 30000 test samples
loaded image features from cache/image_features.y_truth.ImageNetRcoca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  88.03666830062866
Results:
,ImageNet,Caltech101,OxfordPets,StanfordCars,Flowers102,Food101,FGVCAircraft,SUN397,DTD,EuroSAT,UCF101,ImageNetV2,ImageNetSketch,ImageNetA,ImageNetR,
coca_ViT-L-14 laion2B-s13B-b90k BLIP ZS,75.46799778938293,97.24137783050537,94.05832290649414,92.79940724372864,77.26350426673889,88.06930780410767,37.02370226383209,74.211585521698,59.7517728805542,60.148149728775024,75.49563646316528,67.96000003814697,64.15138840675354,56.18667006492615,88.03666830062866,
Namespace(accum_iter=1, adapter=0, adaptive_margin=0.0, bitfit=0, bs=32, cache_dir='/projectnb/textconv/cliao25/data', captioner='LLAVA', checkpoint='', d=768, data_dir='/scratch/cliao25', dataset='', ema=0.995, eval_only=0, ice=True, ice_k=5, ice_lambda=0.08, init_lam=0.0, iters_per_epoch=750, label_smoothing=0.0, layer_start_t=9, layer_start_v=9, lora=0, loss='ce', lr=2e-05, lr_decay=0.0, maple=0, margin=0.0, modelname='coca_ViT-L-14', n_descriptors=-1, n_epochs=1, optimizer='sgd', pretrained='laion2B-s13B-b90k', prompt_lr_multi=10.0, rank=4, resblock_adapter=0, samples_per_class=1, save_model=0, seed=1, shallow_prompt_init='a photo of', shots=16, skip_ema_iters=0, ssf=0, subsample_classes='all', temp=60.0, text_prompt_depth=0, text_prompt_length=0, train_text_encoder=0, train_visual_encoder=0, use_all_logits=False, use_fixed_lambda=False, v=3, visual_prompt_depth=0, visual_prompt_length=0, wd=1e-05)
EVALUATING ON DATASET:  ImageNet
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/imagenet/shot_16-seed_1.pkl
ImageNet has 50000 test samples
loaded image features from cache/image_features.y_truth.ImageNetcoca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  75.23799538612366
EVALUATING ON DATASET:  Caltech101
Reading split from /scratch/cliao25/caltech-101/split_zhou_Caltech101.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/caltech-101/shot_16-seed_1.pkl
Caltech101 has 2465 test samples
loaded image features from cache/image_features.y_truth.Caltech101coca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  97.4442183971405
EVALUATING ON DATASET:  OxfordPets
Reading split from /scratch/cliao25/oxford_pets/split_zhou_OxfordPets.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/oxford_pets/shot_16-seed_1.pkl
OxfordPets has 3669 test samples
loaded image features from cache/image_features.y_truth.OxfordPetscoca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  94.03106570243835
EVALUATING ON DATASET:  StanfordCars
Reading split from /scratch/cliao25/stanford_cars/split_zhou_StanfordCars.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/stanford_cars/shot_16-seed_1.pkl
StanfordCars has 8041 test samples
loaded image features from cache/image_features.y_truth.StanfordCarscoca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  92.65016913414001
EVALUATING ON DATASET:  Flowers102
Reading split from /scratch/cliao25/oxford_flowers/split_zhou_OxfordFlowers.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/oxford_flowers/shot_16-seed_1.pkl
Flowers102 has 2463 test samples
loaded image features from cache/image_features.y_truth.Flowers102coca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  76.49208307266235
EVALUATING ON DATASET:  Food101
Reading split from /scratch/cliao25/food-101/split_zhou_Food101.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/food-101/shot_16-seed_1.pkl
Food101 has 30300 test samples
loaded image features from cache/image_features.y_truth.Food101coca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  87.85478472709656
EVALUATING ON DATASET:  FGVCAircraft
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/fgvc_aircraft/shot_16-seed_1.pkl
FGVCAircraft has 3333 test samples
loaded image features from cache/image_features.y_truth.FGVCAircraftcoca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  36.453643441200256
EVALUATING ON DATASET:  SUN397
Reading split from /scratch/cliao25/sun397/split_zhou_SUN397.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/sun397/shot_16-seed_1.pkl
SUN397 has 19850 test samples
loaded image features from cache/image_features.y_truth.SUN397coca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  74.16120767593384
EVALUATING ON DATASET:  DTD
Reading split from /scratch/cliao25/dtd/split_zhou_DescribableTextures.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/dtd/shot_16-seed_1.pkl
DTD has 1692 test samples
loaded image features from cache/image_features.y_truth.DTDcoca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  59.33806300163269
EVALUATING ON DATASET:  EuroSAT
Reading split from /scratch/cliao25/eurosat/split_zhou_EuroSAT.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/eurosat/shot_16-seed_1.pkl
EuroSAT has 8100 test samples
loaded image features from cache/image_features.y_truth.EuroSATcoca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  61.987656354904175
EVALUATING ON DATASET:  UCF101
Reading split from /scratch/cliao25/ucf101/split_zhou_UCF101.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/ucf101/shot_16-seed_1.pkl
UCF101 has 3783 test samples
loaded image features from cache/image_features.y_truth.UCF101coca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  75.54850578308105
EVALUATING ON DATASET:  ImageNetV2
ImageNetV2 has 10000 test samples
loaded image features from cache/image_features.y_truth.ImageNetV2coca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  67.58999824523926
EVALUATING ON DATASET:  ImageNetSketch
ImageNetSketch has 50889 test samples
loaded image features from cache/image_features.y_truth.ImageNetSketchcoca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  63.76426815986633
EVALUATING ON DATASET:  ImageNetA
ImageNetA has 7500 test samples
loaded image features from cache/image_features.y_truth.ImageNetAcoca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  55.026668310165405
EVALUATING ON DATASET:  ImageNetR
ImageNetR has 30000 test samples
loaded image features from cache/image_features.y_truth.ImageNetRcoca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  87.56999969482422
Results:
,ImageNet,Caltech101,OxfordPets,StanfordCars,Flowers102,Food101,FGVCAircraft,SUN397,DTD,EuroSAT,UCF101,ImageNetV2,ImageNetSketch,ImageNetA,ImageNetR,
coca_ViT-L-14 laion2B-s13B-b90k LLAVA ZS,75.23799538612366,97.4442183971405,94.03106570243835,92.65016913414001,76.49208307266235,87.85478472709656,36.453643441200256,74.16120767593384,59.33806300163269,61.987656354904175,75.54850578308105,67.58999824523926,63.76426815986633,55.026668310165405,87.56999969482422,
Namespace(accum_iter=1, adapter=0, adaptive_margin=0.0, bitfit=0, bs=32, cache_dir='/projectnb/textconv/cliao25/data', captioner='COCA', checkpoint='', d=512, data_dir='/scratch/cliao25', dataset='', ema=0.995, eval_only=0, ice=True, ice_k=5, ice_lambda=0.08, init_lam=0.0, iters_per_epoch=750, label_smoothing=0.0, layer_start_t=9, layer_start_v=9, lora=0, loss='ce', lr=2e-05, lr_decay=0.0, maple=0, margin=0.0, modelname='ViT-B-16', n_descriptors=-1, n_epochs=1, optimizer='sgd', pretrained='laion2b_s34b_b88k', prompt_lr_multi=10.0, rank=4, resblock_adapter=0, samples_per_class=1, save_model=0, seed=1, shallow_prompt_init='a photo of', shots=16, skip_ema_iters=0, ssf=0, subsample_classes='all', temp=60.0, text_prompt_depth=0, text_prompt_length=0, train_text_encoder=0, train_visual_encoder=0, use_all_logits=False, use_fixed_lambda=False, v=3, visual_prompt_depth=0, visual_prompt_length=0, wd=1e-05)
EVALUATING ON DATASET:  ImageNet
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/imagenet/shot_16-seed_1.pkl
ImageNet has 50000 test samples
loaded image features from cache/image_features.y_truth.ImageNetViT-B-16laion2b_s34b_b88k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  71.64999842643738
EVALUATING ON DATASET:  Caltech101
Reading split from /scratch/cliao25/caltech-101/split_zhou_Caltech101.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/caltech-101/shot_16-seed_1.pkl
Caltech101 has 2465 test samples
loaded image features from cache/image_features.y_truth.Caltech101ViT-B-16laion2b_s34b_b88k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  96.34888768196106
EVALUATING ON DATASET:  OxfordPets
Reading split from /scratch/cliao25/oxford_pets/split_zhou_OxfordPets.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/oxford_pets/shot_16-seed_1.pkl
OxfordPets has 3669 test samples
loaded image features from cache/image_features.y_truth.OxfordPetsViT-B-16laion2b_s34b_b88k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  91.22376441955566
EVALUATING ON DATASET:  StanfordCars
Reading split from /scratch/cliao25/stanford_cars/split_zhou_StanfordCars.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/stanford_cars/shot_16-seed_1.pkl
StanfordCars has 8041 test samples
loaded image features from cache/image_features.y_truth.StanfordCarsViT-B-16laion2b_s34b_b88k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  91.59308671951294
EVALUATING ON DATASET:  Flowers102
Reading split from /scratch/cliao25/oxford_flowers/split_zhou_OxfordFlowers.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/oxford_flowers/shot_16-seed_1.pkl
Flowers102 has 2463 test samples
loaded image features from cache/image_features.y_truth.Flowers102ViT-B-16laion2b_s34b_b88k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  73.48761558532715
EVALUATING ON DATASET:  Food101
Reading split from /scratch/cliao25/food-101/split_zhou_Food101.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/food-101/shot_16-seed_1.pkl
Food101 has 30300 test samples
loaded image features from cache/image_features.y_truth.Food101ViT-B-16laion2b_s34b_b88k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  85.1452112197876
EVALUATING ON DATASET:  FGVCAircraft
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/fgvc_aircraft/shot_16-seed_1.pkl
FGVCAircraft has 3333 test samples
loaded image features from cache/image_features.y_truth.FGVCAircraftViT-B-16laion2b_s34b_b88k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  30.603060126304626
EVALUATING ON DATASET:  SUN397
Reading split from /scratch/cliao25/sun397/split_zhou_SUN397.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/sun397/shot_16-seed_1.pkl
SUN397 has 19850 test samples
loaded image features from cache/image_features.y_truth.SUN397ViT-B-16laion2b_s34b_b88k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  71.89924120903015
EVALUATING ON DATASET:  DTD
Reading split from /scratch/cliao25/dtd/split_zhou_DescribableTextures.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/dtd/shot_16-seed_1.pkl
DTD has 1692 test samples
loaded image features from cache/image_features.y_truth.DTDViT-B-16laion2b_s34b_b88k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  53.84160876274109
EVALUATING ON DATASET:  EuroSAT
Reading split from /scratch/cliao25/eurosat/split_zhou_EuroSAT.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/eurosat/shot_16-seed_1.pkl
EuroSAT has 8100 test samples
loaded image features from cache/image_features.y_truth.EuroSATViT-B-16laion2b_s34b_b88k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  44.75308656692505
EVALUATING ON DATASET:  UCF101
Reading split from /scratch/cliao25/ucf101/split_zhou_UCF101.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/ucf101/shot_16-seed_1.pkl
UCF101 has 3783 test samples
loaded image features from cache/image_features.y_truth.UCF101ViT-B-16laion2b_s34b_b88k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  68.72851848602295
EVALUATING ON DATASET:  ImageNetV2
ImageNetV2 has 10000 test samples
loaded image features from cache/image_features.y_truth.ImageNetV2ViT-B-16laion2b_s34b_b88k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  63.37999701499939
EVALUATING ON DATASET:  ImageNetSketch
ImageNetSketch has 50889 test samples
loaded image features from cache/image_features.y_truth.ImageNetSketchViT-B-16laion2b_s34b_b88k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  57.59987235069275
EVALUATING ON DATASET:  ImageNetA
ImageNetA has 7500 test samples
loaded image features from cache/image_features.y_truth.ImageNetAViT-B-16laion2b_s34b_b88k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  41.21333360671997
EVALUATING ON DATASET:  ImageNetR
ImageNetR has 30000 test samples
loaded image features from cache/image_features.y_truth.ImageNetRViT-B-16laion2b_s34b_b88k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  82.02666640281677
Results:
,ImageNet,Caltech101,OxfordPets,StanfordCars,Flowers102,Food101,FGVCAircraft,SUN397,DTD,EuroSAT,UCF101,ImageNetV2,ImageNetSketch,ImageNetA,ImageNetR,
ViT-B-16 laion2b_s34b_b88k COCA ZS,71.64999842643738,96.34888768196106,91.22376441955566,91.59308671951294,73.48761558532715,85.1452112197876,30.603060126304626,71.89924120903015,53.84160876274109,44.75308656692505,68.72851848602295,63.37999701499939,57.59987235069275,41.21333360671997,82.02666640281677,
Namespace(accum_iter=1, adapter=0, adaptive_margin=0.0, bitfit=0, bs=32, cache_dir='/projectnb/textconv/cliao25/data', captioner='BLIP', checkpoint='', d=512, data_dir='/scratch/cliao25', dataset='', ema=0.995, eval_only=0, ice=True, ice_k=5, ice_lambda=0.08, init_lam=0.0, iters_per_epoch=750, label_smoothing=0.0, layer_start_t=9, layer_start_v=9, lora=0, loss='ce', lr=2e-05, lr_decay=0.0, maple=0, margin=0.0, modelname='ViT-B-16', n_descriptors=-1, n_epochs=1, optimizer='sgd', pretrained='laion2b_s34b_b88k', prompt_lr_multi=10.0, rank=4, resblock_adapter=0, samples_per_class=1, save_model=0, seed=1, shallow_prompt_init='a photo of', shots=16, skip_ema_iters=0, ssf=0, subsample_classes='all', temp=60.0, text_prompt_depth=0, text_prompt_length=0, train_text_encoder=0, train_visual_encoder=0, use_all_logits=False, use_fixed_lambda=False, v=3, visual_prompt_depth=0, visual_prompt_length=0, wd=1e-05)
EVALUATING ON DATASET:  ImageNet
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/imagenet/shot_16-seed_1.pkl
ImageNet has 50000 test samples
loaded image features from cache/image_features.y_truth.ImageNetViT-B-16laion2b_s34b_b88k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  70.66199779510498
EVALUATING ON DATASET:  Caltech101
Reading split from /scratch/cliao25/caltech-101/split_zhou_Caltech101.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/caltech-101/shot_16-seed_1.pkl
Caltech101 has 2465 test samples
loaded image features from cache/image_features.y_truth.Caltech101ViT-B-16laion2b_s34b_b88k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  96.55172228813171
EVALUATING ON DATASET:  OxfordPets
Reading split from /scratch/cliao25/oxford_pets/split_zhou_OxfordPets.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/oxford_pets/shot_16-seed_1.pkl
OxfordPets has 3669 test samples
loaded image features from cache/image_features.y_truth.OxfordPetsViT-B-16laion2b_s34b_b88k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  90.2698278427124
EVALUATING ON DATASET:  StanfordCars
Reading split from /scratch/cliao25/stanford_cars/split_zhou_StanfordCars.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/stanford_cars/shot_16-seed_1.pkl
StanfordCars has 8041 test samples
loaded image features from cache/image_features.y_truth.StanfordCarsViT-B-16laion2b_s34b_b88k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  90.38677215576172
EVALUATING ON DATASET:  Flowers102
Reading split from /scratch/cliao25/oxford_flowers/split_zhou_OxfordFlowers.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/oxford_flowers/shot_16-seed_1.pkl
Flowers102 has 2463 test samples
loaded image features from cache/image_features.y_truth.Flowers102ViT-B-16laion2b_s34b_b88k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  73.12220931053162
EVALUATING ON DATASET:  Food101
Reading split from /scratch/cliao25/food-101/split_zhou_Food101.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/food-101/shot_16-seed_1.pkl
Food101 has 30300 test samples
loaded image features from cache/image_features.y_truth.Food101ViT-B-16laion2b_s34b_b88k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  84.85808372497559
EVALUATING ON DATASET:  FGVCAircraft
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/fgvc_aircraft/shot_16-seed_1.pkl
FGVCAircraft has 3333 test samples
loaded image features from cache/image_features.y_truth.FGVCAircraftViT-B-16laion2b_s34b_b88k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  27.152714133262634
EVALUATING ON DATASET:  SUN397
Reading split from /scratch/cliao25/sun397/split_zhou_SUN397.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/sun397/shot_16-seed_1.pkl
SUN397 has 19850 test samples
loaded image features from cache/image_features.y_truth.SUN397ViT-B-16laion2b_s34b_b88k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  71.59697413444519
EVALUATING ON DATASET:  DTD
Reading split from /scratch/cliao25/dtd/split_zhou_DescribableTextures.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/dtd/shot_16-seed_1.pkl
DTD has 1692 test samples
loaded image features from cache/image_features.y_truth.DTDViT-B-16laion2b_s34b_b88k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  54.13711667060852
EVALUATING ON DATASET:  EuroSAT
Reading split from /scratch/cliao25/eurosat/split_zhou_EuroSAT.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/eurosat/shot_16-seed_1.pkl
EuroSAT has 8100 test samples
loaded image features from cache/image_features.y_truth.EuroSATViT-B-16laion2b_s34b_b88k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  46.975308656692505
EVALUATING ON DATASET:  UCF101
Reading split from /scratch/cliao25/ucf101/split_zhou_UCF101.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/ucf101/shot_16-seed_1.pkl
UCF101 has 3783 test samples
loaded image features from cache/image_features.y_truth.UCF101ViT-B-16laion2b_s34b_b88k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  68.91355514526367
EVALUATING ON DATASET:  ImageNetV2
ImageNetV2 has 10000 test samples
loaded image features from cache/image_features.y_truth.ImageNetV2ViT-B-16laion2b_s34b_b88k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  62.83000111579895
EVALUATING ON DATASET:  ImageNetSketch
ImageNetSketch has 50889 test samples
loaded image features from cache/image_features.y_truth.ImageNetSketchViT-B-16laion2b_s34b_b88k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  57.057517766952515
EVALUATING ON DATASET:  ImageNetA
ImageNetA has 7500 test samples
loaded image features from cache/image_features.y_truth.ImageNetAViT-B-16laion2b_s34b_b88k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  42.053332924842834
EVALUATING ON DATASET:  ImageNetR
ImageNetR has 30000 test samples
loaded image features from cache/image_features.y_truth.ImageNetRViT-B-16laion2b_s34b_b88k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  82.09666609764099
Results:
,ImageNet,Caltech101,OxfordPets,StanfordCars,Flowers102,Food101,FGVCAircraft,SUN397,DTD,EuroSAT,UCF101,ImageNetV2,ImageNetSketch,ImageNetA,ImageNetR,
ViT-B-16 laion2b_s34b_b88k BLIP ZS,70.66199779510498,96.55172228813171,90.2698278427124,90.38677215576172,73.12220931053162,84.85808372497559,27.152714133262634,71.59697413444519,54.13711667060852,46.975308656692505,68.91355514526367,62.83000111579895,57.057517766952515,42.053332924842834,82.09666609764099,
Namespace(accum_iter=1, adapter=0, adaptive_margin=0.0, bitfit=0, bs=32, cache_dir='/projectnb/textconv/cliao25/data', captioner='LLAVA', checkpoint='', d=512, data_dir='/scratch/cliao25', dataset='', ema=0.995, eval_only=0, ice=True, ice_k=5, ice_lambda=0.08, init_lam=0.0, iters_per_epoch=750, label_smoothing=0.0, layer_start_t=9, layer_start_v=9, lora=0, loss='ce', lr=2e-05, lr_decay=0.0, maple=0, margin=0.0, modelname='ViT-B-16', n_descriptors=-1, n_epochs=1, optimizer='sgd', pretrained='laion2b_s34b_b88k', prompt_lr_multi=10.0, rank=4, resblock_adapter=0, samples_per_class=1, save_model=0, seed=1, shallow_prompt_init='a photo of', shots=16, skip_ema_iters=0, ssf=0, subsample_classes='all', temp=60.0, text_prompt_depth=0, text_prompt_length=0, train_text_encoder=0, train_visual_encoder=0, use_all_logits=False, use_fixed_lambda=False, v=3, visual_prompt_depth=0, visual_prompt_length=0, wd=1e-05)
EVALUATING ON DATASET:  ImageNet
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/imagenet/shot_16-seed_1.pkl
ImageNet has 50000 test samples
loaded image features from cache/image_features.y_truth.ImageNetViT-B-16laion2b_s34b_b88k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  70.3440010547638
EVALUATING ON DATASET:  Caltech101
Reading split from /scratch/cliao25/caltech-101/split_zhou_Caltech101.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/caltech-101/shot_16-seed_1.pkl
Caltech101 has 2465 test samples
loaded image features from cache/image_features.y_truth.Caltech101ViT-B-16laion2b_s34b_b88k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  96.55172228813171
EVALUATING ON DATASET:  OxfordPets
Reading split from /scratch/cliao25/oxford_pets/split_zhou_OxfordPets.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/oxford_pets/shot_16-seed_1.pkl
OxfordPets has 3669 test samples
loaded image features from cache/image_features.y_truth.OxfordPetsViT-B-16laion2b_s34b_b88k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  90.29707908630371
EVALUATING ON DATASET:  StanfordCars
Reading split from /scratch/cliao25/stanford_cars/split_zhou_StanfordCars.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/stanford_cars/shot_16-seed_1.pkl
StanfordCars has 8041 test samples
loaded image features from cache/image_features.y_truth.StanfordCarsViT-B-16laion2b_s34b_b88k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  89.83957767486572
EVALUATING ON DATASET:  Flowers102
Reading split from /scratch/cliao25/oxford_flowers/split_zhou_OxfordFlowers.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/oxford_flowers/shot_16-seed_1.pkl
Flowers102 has 2463 test samples
loaded image features from cache/image_features.y_truth.Flowers102ViT-B-16laion2b_s34b_b88k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  70.40194869041443
EVALUATING ON DATASET:  Food101
Reading split from /scratch/cliao25/food-101/split_zhou_Food101.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/food-101/shot_16-seed_1.pkl
Food101 has 30300 test samples
loaded image features from cache/image_features.y_truth.Food101ViT-B-16laion2b_s34b_b88k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  84.04620289802551
EVALUATING ON DATASET:  FGVCAircraft
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/fgvc_aircraft/shot_16-seed_1.pkl
FGVCAircraft has 3333 test samples
loaded image features from cache/image_features.y_truth.FGVCAircraftViT-B-16laion2b_s34b_b88k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  26.762676239013672
EVALUATING ON DATASET:  SUN397
Reading split from /scratch/cliao25/sun397/split_zhou_SUN397.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/sun397/shot_16-seed_1.pkl
SUN397 has 19850 test samples
loaded image features from cache/image_features.y_truth.SUN397ViT-B-16laion2b_s34b_b88k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  71.58690094947815
EVALUATING ON DATASET:  DTD
Reading split from /scratch/cliao25/dtd/split_zhou_DescribableTextures.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/dtd/shot_16-seed_1.pkl
DTD has 1692 test samples
loaded image features from cache/image_features.y_truth.DTDViT-B-16laion2b_s34b_b88k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  53.309690952301025
EVALUATING ON DATASET:  EuroSAT
Reading split from /scratch/cliao25/eurosat/split_zhou_EuroSAT.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/eurosat/shot_16-seed_1.pkl
EuroSAT has 8100 test samples
loaded image features from cache/image_features.y_truth.EuroSATViT-B-16laion2b_s34b_b88k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  47.32098877429962
EVALUATING ON DATASET:  UCF101
Reading split from /scratch/cliao25/ucf101/split_zhou_UCF101.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/ucf101/shot_16-seed_1.pkl
UCF101 has 3783 test samples
loaded image features from cache/image_features.y_truth.UCF101ViT-B-16laion2b_s34b_b88k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  68.86069178581238
EVALUATING ON DATASET:  ImageNetV2
ImageNetV2 has 10000 test samples
loaded image features from cache/image_features.y_truth.ImageNetV2ViT-B-16laion2b_s34b_b88k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  62.09999918937683
EVALUATING ON DATASET:  ImageNetSketch
ImageNetSketch has 50889 test samples
loaded image features from cache/image_features.y_truth.ImageNetSketchViT-B-16laion2b_s34b_b88k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  55.92957139015198
EVALUATING ON DATASET:  ImageNetA
ImageNetA has 7500 test samples
loaded image features from cache/image_features.y_truth.ImageNetAViT-B-16laion2b_s34b_b88k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  40.14666676521301
EVALUATING ON DATASET:  ImageNetR
ImageNetR has 30000 test samples
loaded image features from cache/image_features.y_truth.ImageNetRViT-B-16laion2b_s34b_b88k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  80.94333410263062
Results:
,ImageNet,Caltech101,OxfordPets,StanfordCars,Flowers102,Food101,FGVCAircraft,SUN397,DTD,EuroSAT,UCF101,ImageNetV2,ImageNetSketch,ImageNetA,ImageNetR,
ViT-B-16 laion2b_s34b_b88k LLAVA ZS,70.3440010547638,96.55172228813171,90.29707908630371,89.83957767486572,70.40194869041443,84.04620289802551,26.762676239013672,71.58690094947815,53.309690952301025,47.32098877429962,68.86069178581238,62.09999918937683,55.92957139015198,40.14666676521301,80.94333410263062,
Namespace(accum_iter=1, adapter=0, adaptive_margin=0.0, bitfit=0, bs=32, cache_dir='/projectnb/textconv/cliao25/data', captioner='COCA', checkpoint='', d=512, data_dir='/scratch/cliao25', dataset='', ema=0.995, eval_only=0, ice=True, ice_k=5, ice_lambda=0.08, init_lam=0.0, iters_per_epoch=750, label_smoothing=0.0, layer_start_t=9, layer_start_v=9, lora=0, loss='ce', lr=2e-05, lr_decay=0.0, maple=0, margin=0.0, modelname='ViT-B-32', n_descriptors=-1, n_epochs=1, optimizer='sgd', pretrained='openai', prompt_lr_multi=10.0, rank=4, resblock_adapter=0, samples_per_class=1, save_model=0, seed=1, shallow_prompt_init='a photo of', shots=16, skip_ema_iters=0, ssf=0, subsample_classes='all', temp=60.0, text_prompt_depth=0, text_prompt_length=0, train_text_encoder=0, train_visual_encoder=0, use_all_logits=False, use_fixed_lambda=False, v=3, visual_prompt_depth=0, visual_prompt_length=0, wd=1e-05)
EVALUATING ON DATASET:  ImageNet
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/imagenet/shot_16-seed_1.pkl
ImageNet has 50000 test samples
loaded image features from cache/image_features.y_truth.ImageNetViT-B-32openai.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  66.45999550819397
EVALUATING ON DATASET:  Caltech101
Reading split from /scratch/cliao25/caltech-101/split_zhou_Caltech101.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/caltech-101/shot_16-seed_1.pkl
Caltech101 has 2465 test samples
loaded image features from cache/image_features.y_truth.Caltech101ViT-B-32openai.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  93.50912570953369
EVALUATING ON DATASET:  OxfordPets
Reading split from /scratch/cliao25/oxford_pets/split_zhou_OxfordPets.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/oxford_pets/shot_16-seed_1.pkl
OxfordPets has 3669 test samples
loaded image features from cache/image_features.y_truth.OxfordPetsViT-B-32openai.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  89.28863406181335
EVALUATING ON DATASET:  StanfordCars
Reading split from /scratch/cliao25/stanford_cars/split_zhou_StanfordCars.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/stanford_cars/shot_16-seed_1.pkl
StanfordCars has 8041 test samples
loaded image features from cache/image_features.y_truth.StanfordCarsViT-B-32openai.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  71.09812498092651
EVALUATING ON DATASET:  Flowers102
Reading split from /scratch/cliao25/oxford_flowers/split_zhou_OxfordFlowers.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/oxford_flowers/shot_16-seed_1.pkl
Flowers102 has 2463 test samples
loaded image features from cache/image_features.y_truth.Flowers102ViT-B-32openai.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  69.06211972236633
EVALUATING ON DATASET:  Food101
Reading split from /scratch/cliao25/food-101/split_zhou_Food101.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/food-101/shot_16-seed_1.pkl
Food101 has 30300 test samples
loaded image features from cache/image_features.y_truth.Food101ViT-B-32openai.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  83.35973620414734
EVALUATING ON DATASET:  FGVCAircraft
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/fgvc_aircraft/shot_16-seed_1.pkl
FGVCAircraft has 3333 test samples
loaded image features from cache/image_features.y_truth.FGVCAircraftViT-B-32openai.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  22.412240505218506
EVALUATING ON DATASET:  SUN397
Reading split from /scratch/cliao25/sun397/split_zhou_SUN397.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/sun397/shot_16-seed_1.pkl
SUN397 has 19850 test samples
loaded image features from cache/image_features.y_truth.SUN397ViT-B-32openai.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  65.15868902206421
EVALUATING ON DATASET:  DTD
Reading split from /scratch/cliao25/dtd/split_zhou_DescribableTextures.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/dtd/shot_16-seed_1.pkl
DTD has 1692 test samples
loaded image features from cache/image_features.y_truth.DTDViT-B-32openai.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  44.917258620262146
EVALUATING ON DATASET:  EuroSAT
Reading split from /scratch/cliao25/eurosat/split_zhou_EuroSAT.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/eurosat/shot_16-seed_1.pkl
EuroSAT has 8100 test samples
loaded image features from cache/image_features.y_truth.EuroSATViT-B-32openai.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  43.23456883430481
EVALUATING ON DATASET:  UCF101
Reading split from /scratch/cliao25/ucf101/split_zhou_UCF101.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/ucf101/shot_16-seed_1.pkl
UCF101 has 3783 test samples
loaded image features from cache/image_features.y_truth.UCF101ViT-B-32openai.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  65.39782881736755
EVALUATING ON DATASET:  ImageNetV2
ImageNetV2 has 10000 test samples
loaded image features from cache/image_features.y_truth.ImageNetV2ViT-B-32openai.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  58.6899995803833
EVALUATING ON DATASET:  ImageNetSketch
ImageNetSketch has 50889 test samples
loaded image features from cache/image_features.y_truth.ImageNetSketchViT-B-32openai.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  47.19683825969696
EVALUATING ON DATASET:  ImageNetA
ImageNetA has 7500 test samples
loaded image features from cache/image_features.y_truth.ImageNetAViT-B-32openai.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  34.53333377838135
EVALUATING ON DATASET:  ImageNetR
ImageNetR has 30000 test samples
loaded image features from cache/image_features.y_truth.ImageNetRViT-B-32openai.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  73.52333664894104
Results:
,ImageNet,Caltech101,OxfordPets,StanfordCars,Flowers102,Food101,FGVCAircraft,SUN397,DTD,EuroSAT,UCF101,ImageNetV2,ImageNetSketch,ImageNetA,ImageNetR,
ViT-B-32 openai COCA ZS,66.45999550819397,93.50912570953369,89.28863406181335,71.09812498092651,69.06211972236633,83.35973620414734,22.412240505218506,65.15868902206421,44.917258620262146,43.23456883430481,65.39782881736755,58.6899995803833,47.19683825969696,34.53333377838135,73.52333664894104,
Namespace(accum_iter=1, adapter=0, adaptive_margin=0.0, bitfit=0, bs=32, cache_dir='/projectnb/textconv/cliao25/data', captioner='BLIP', checkpoint='', d=512, data_dir='/scratch/cliao25', dataset='', ema=0.995, eval_only=0, ice=True, ice_k=5, ice_lambda=0.08, init_lam=0.0, iters_per_epoch=750, label_smoothing=0.0, layer_start_t=9, layer_start_v=9, lora=0, loss='ce', lr=2e-05, lr_decay=0.0, maple=0, margin=0.0, modelname='ViT-B-32', n_descriptors=-1, n_epochs=1, optimizer='sgd', pretrained='openai', prompt_lr_multi=10.0, rank=4, resblock_adapter=0, samples_per_class=1, save_model=0, seed=1, shallow_prompt_init='a photo of', shots=16, skip_ema_iters=0, ssf=0, subsample_classes='all', temp=60.0, text_prompt_depth=0, text_prompt_length=0, train_text_encoder=0, train_visual_encoder=0, use_all_logits=False, use_fixed_lambda=False, v=3, visual_prompt_depth=0, visual_prompt_length=0, wd=1e-05)
EVALUATING ON DATASET:  ImageNet
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/imagenet/shot_16-seed_1.pkl
ImageNet has 50000 test samples
loaded image features from cache/image_features.y_truth.ImageNetViT-B-32openai.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  64.91599678993225
EVALUATING ON DATASET:  Caltech101
Reading split from /scratch/cliao25/caltech-101/split_zhou_Caltech101.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/caltech-101/shot_16-seed_1.pkl
Caltech101 has 2465 test samples
loaded image features from cache/image_features.y_truth.Caltech101ViT-B-32openai.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  93.8336730003357
EVALUATING ON DATASET:  OxfordPets
Reading split from /scratch/cliao25/oxford_pets/split_zhou_OxfordPets.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/oxford_pets/shot_16-seed_1.pkl
OxfordPets has 3669 test samples
loaded image features from cache/image_features.y_truth.OxfordPetsViT-B-32openai.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  86.80838942527771
EVALUATING ON DATASET:  StanfordCars
Reading split from /scratch/cliao25/stanford_cars/split_zhou_StanfordCars.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/stanford_cars/shot_16-seed_1.pkl
StanfordCars has 8041 test samples
loaded image features from cache/image_features.y_truth.StanfordCarsViT-B-32openai.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  66.21067523956299
EVALUATING ON DATASET:  Flowers102
Reading split from /scratch/cliao25/oxford_flowers/split_zhou_OxfordFlowers.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/oxford_flowers/shot_16-seed_1.pkl
Flowers102 has 2463 test samples
loaded image features from cache/image_features.y_truth.Flowers102ViT-B-32openai.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  68.89971494674683
EVALUATING ON DATASET:  Food101
Reading split from /scratch/cliao25/food-101/split_zhou_Food101.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/food-101/shot_16-seed_1.pkl
Food101 has 30300 test samples
loaded image features from cache/image_features.y_truth.Food101ViT-B-32openai.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  82.29373097419739
EVALUATING ON DATASET:  FGVCAircraft
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/fgvc_aircraft/shot_16-seed_1.pkl
FGVCAircraft has 3333 test samples
loaded image features from cache/image_features.y_truth.FGVCAircraftViT-B-32openai.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  19.321931898593903
EVALUATING ON DATASET:  SUN397
Reading split from /scratch/cliao25/sun397/split_zhou_SUN397.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/sun397/shot_16-seed_1.pkl
SUN397 has 19850 test samples
loaded image features from cache/image_features.y_truth.SUN397ViT-B-32openai.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  65.48110842704773
EVALUATING ON DATASET:  DTD
Reading split from /scratch/cliao25/dtd/split_zhou_DescribableTextures.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/dtd/shot_16-seed_1.pkl
DTD has 1692 test samples
loaded image features from cache/image_features.y_truth.DTDViT-B-32openai.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  44.5035457611084
EVALUATING ON DATASET:  EuroSAT
Reading split from /scratch/cliao25/eurosat/split_zhou_EuroSAT.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/eurosat/shot_16-seed_1.pkl
EuroSAT has 8100 test samples
loaded image features from cache/image_features.y_truth.EuroSATViT-B-32openai.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  44.66666579246521
EVALUATING ON DATASET:  UCF101
Reading split from /scratch/cliao25/ucf101/split_zhou_UCF101.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/ucf101/shot_16-seed_1.pkl
UCF101 has 3783 test samples
loaded image features from cache/image_features.y_truth.UCF101ViT-B-32openai.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  65.84720611572266
EVALUATING ON DATASET:  ImageNetV2
ImageNetV2 has 10000 test samples
loaded image features from cache/image_features.y_truth.ImageNetV2ViT-B-32openai.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  57.56999850273132
EVALUATING ON DATASET:  ImageNetSketch
ImageNetSketch has 50889 test samples
loaded image features from cache/image_features.y_truth.ImageNetSketchViT-B-32openai.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  46.540507674217224
EVALUATING ON DATASET:  ImageNetA
ImageNetA has 7500 test samples
loaded image features from cache/image_features.y_truth.ImageNetAViT-B-32openai.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  35.8266681432724
EVALUATING ON DATASET:  ImageNetR
ImageNetR has 30000 test samples
loaded image features from cache/image_features.y_truth.ImageNetRViT-B-32openai.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  73.826664686203
Results:
,ImageNet,Caltech101,OxfordPets,StanfordCars,Flowers102,Food101,FGVCAircraft,SUN397,DTD,EuroSAT,UCF101,ImageNetV2,ImageNetSketch,ImageNetA,ImageNetR,
ViT-B-32 openai BLIP ZS,64.91599678993225,93.8336730003357,86.80838942527771,66.21067523956299,68.89971494674683,82.29373097419739,19.321931898593903,65.48110842704773,44.5035457611084,44.66666579246521,65.84720611572266,57.56999850273132,46.540507674217224,35.8266681432724,73.826664686203,
Namespace(accum_iter=1, adapter=0, adaptive_margin=0.0, bitfit=0, bs=32, cache_dir='/projectnb/textconv/cliao25/data', captioner='LLAVA', checkpoint='', d=512, data_dir='/scratch/cliao25', dataset='', ema=0.995, eval_only=0, ice=True, ice_k=5, ice_lambda=0.08, init_lam=0.0, iters_per_epoch=750, label_smoothing=0.0, layer_start_t=9, layer_start_v=9, lora=0, loss='ce', lr=2e-05, lr_decay=0.0, maple=0, margin=0.0, modelname='ViT-B-32', n_descriptors=-1, n_epochs=1, optimizer='sgd', pretrained='openai', prompt_lr_multi=10.0, rank=4, resblock_adapter=0, samples_per_class=1, save_model=0, seed=1, shallow_prompt_init='a photo of', shots=16, skip_ema_iters=0, ssf=0, subsample_classes='all', temp=60.0, text_prompt_depth=0, text_prompt_length=0, train_text_encoder=0, train_visual_encoder=0, use_all_logits=False, use_fixed_lambda=False, v=3, visual_prompt_depth=0, visual_prompt_length=0, wd=1e-05)
EVALUATING ON DATASET:  ImageNet
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/imagenet/shot_16-seed_1.pkl
ImageNet has 50000 test samples
loaded image features from cache/image_features.y_truth.ImageNetViT-B-32openai.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  63.55999708175659
EVALUATING ON DATASET:  Caltech101
Reading split from /scratch/cliao25/caltech-101/split_zhou_Caltech101.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/caltech-101/shot_16-seed_1.pkl
Caltech101 has 2465 test samples
loaded image features from cache/image_features.y_truth.Caltech101ViT-B-32openai.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  92.81947016716003
EVALUATING ON DATASET:  OxfordPets
Reading split from /scratch/cliao25/oxford_pets/split_zhou_OxfordPets.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/oxford_pets/shot_16-seed_1.pkl
OxfordPets has 3669 test samples
loaded image features from cache/image_features.y_truth.OxfordPetsViT-B-32openai.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  86.97192668914795
EVALUATING ON DATASET:  StanfordCars
Reading split from /scratch/cliao25/stanford_cars/split_zhou_StanfordCars.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/stanford_cars/shot_16-seed_1.pkl
StanfordCars has 8041 test samples
loaded image features from cache/image_features.y_truth.StanfordCarsViT-B-32openai.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  60.56460738182068
EVALUATING ON DATASET:  Flowers102
Reading split from /scratch/cliao25/oxford_flowers/split_zhou_OxfordFlowers.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/oxford_flowers/shot_16-seed_1.pkl
Flowers102 has 2463 test samples
loaded image features from cache/image_features.y_truth.Flowers102ViT-B-32openai.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  65.32683968544006
EVALUATING ON DATASET:  Food101
Reading split from /scratch/cliao25/food-101/split_zhou_Food101.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/food-101/shot_16-seed_1.pkl
Food101 has 30300 test samples
loaded image features from cache/image_features.y_truth.Food101ViT-B-32openai.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  80.97359538078308
EVALUATING ON DATASET:  FGVCAircraft
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/fgvc_aircraft/shot_16-seed_1.pkl
FGVCAircraft has 3333 test samples
loaded image features from cache/image_features.y_truth.FGVCAircraftViT-B-32openai.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  19.231922924518585
EVALUATING ON DATASET:  SUN397
Reading split from /scratch/cliao25/sun397/split_zhou_SUN397.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/sun397/shot_16-seed_1.pkl
SUN397 has 19850 test samples
loaded image features from cache/image_features.y_truth.SUN397ViT-B-32openai.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  63.803523778915405
EVALUATING ON DATASET:  DTD
Reading split from /scratch/cliao25/dtd/split_zhou_DescribableTextures.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/dtd/shot_16-seed_1.pkl
DTD has 1692 test samples
loaded image features from cache/image_features.y_truth.DTDViT-B-32openai.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  44.44444477558136
EVALUATING ON DATASET:  EuroSAT
Reading split from /scratch/cliao25/eurosat/split_zhou_EuroSAT.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/eurosat/shot_16-seed_1.pkl
EuroSAT has 8100 test samples
loaded image features from cache/image_features.y_truth.EuroSATViT-B-32openai.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  44.34567987918854
EVALUATING ON DATASET:  UCF101
Reading split from /scratch/cliao25/ucf101/split_zhou_UCF101.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/ucf101/shot_16-seed_1.pkl
UCF101 has 3783 test samples
loaded image features from cache/image_features.y_truth.UCF101ViT-B-32openai.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  64.28759694099426
EVALUATING ON DATASET:  ImageNetV2
ImageNetV2 has 10000 test samples
loaded image features from cache/image_features.y_truth.ImageNetV2ViT-B-32openai.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  56.01999759674072
EVALUATING ON DATASET:  ImageNetSketch
ImageNetSketch has 50889 test samples
loaded image features from cache/image_features.y_truth.ImageNetSketchViT-B-32openai.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  43.669554591178894
EVALUATING ON DATASET:  ImageNetA
ImageNetA has 7500 test samples
loaded image features from cache/image_features.y_truth.ImageNetAViT-B-32openai.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  32.9066663980484
EVALUATING ON DATASET:  ImageNetR
ImageNetR has 30000 test samples
loaded image features from cache/image_features.y_truth.ImageNetRViT-B-32openai.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  70.67333459854126
Results:
,ImageNet,Caltech101,OxfordPets,StanfordCars,Flowers102,Food101,FGVCAircraft,SUN397,DTD,EuroSAT,UCF101,ImageNetV2,ImageNetSketch,ImageNetA,ImageNetR,
ViT-B-32 openai LLAVA ZS,63.55999708175659,92.81947016716003,86.97192668914795,60.56460738182068,65.32683968544006,80.97359538078308,19.231922924518585,63.803523778915405,44.44444477558136,44.34567987918854,64.28759694099426,56.01999759674072,43.669554591178894,32.9066663980484,70.67333459854126,
Namespace(accum_iter=1, adapter=0, adaptive_margin=0.0, bitfit=0, bs=32, cache_dir='/projectnb/textconv/cliao25/data', captioner='COCA', checkpoint='', d=768, data_dir='/scratch/cliao25', dataset='', ema=0.995, eval_only=0, ice=True, ice_k=5, ice_lambda=0.08, init_lam=0.0, iters_per_epoch=750, label_smoothing=0.0, layer_start_t=9, layer_start_v=9, lora=0, loss='ce', lr=2e-05, lr_decay=0.0, maple=0, margin=0.0, modelname='ViT-L-14', n_descriptors=-1, n_epochs=1, optimizer='sgd', pretrained='laion2b_s32b_b82k', prompt_lr_multi=10.0, rank=4, resblock_adapter=0, samples_per_class=1, save_model=0, seed=1, shallow_prompt_init='a photo of', shots=16, skip_ema_iters=0, ssf=0, subsample_classes='all', temp=60.0, text_prompt_depth=0, text_prompt_length=0, train_text_encoder=0, train_visual_encoder=0, use_all_logits=False, use_fixed_lambda=False, v=3, visual_prompt_depth=0, visual_prompt_length=0, wd=1e-05)
EVALUATING ON DATASET:  ImageNet
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/imagenet/shot_16-seed_1.pkl
ImageNet has 50000 test samples
loaded image features from cache/image_features.y_truth.ImageNetViT-L-14laion2b_s32b_b82k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  74.57199692726135
EVALUATING ON DATASET:  Caltech101
Reading split from /scratch/cliao25/caltech-101/split_zhou_Caltech101.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/caltech-101/shot_16-seed_1.pkl
Caltech101 has 2465 test samples
loaded image features from cache/image_features.y_truth.Caltech101ViT-L-14laion2b_s32b_b82k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  96.91683650016785
EVALUATING ON DATASET:  OxfordPets
Reading split from /scratch/cliao25/oxford_pets/split_zhou_OxfordPets.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/oxford_pets/shot_16-seed_1.pkl
OxfordPets has 3669 test samples
loaded image features from cache/image_features.y_truth.OxfordPetsViT-L-14laion2b_s32b_b82k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  92.75006651878357
EVALUATING ON DATASET:  StanfordCars
Reading split from /scratch/cliao25/stanford_cars/split_zhou_StanfordCars.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/stanford_cars/shot_16-seed_1.pkl
StanfordCars has 8041 test samples
loaded image features from cache/image_features.y_truth.StanfordCarsViT-L-14laion2b_s32b_b82k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  92.37657189369202
EVALUATING ON DATASET:  Flowers102
Reading split from /scratch/cliao25/oxford_flowers/split_zhou_OxfordFlowers.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/oxford_flowers/shot_16-seed_1.pkl
Flowers102 has 2463 test samples
loaded image features from cache/image_features.y_truth.Flowers102ViT-L-14laion2b_s32b_b82k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  76.53268575668335
EVALUATING ON DATASET:  Food101
Reading split from /scratch/cliao25/food-101/split_zhou_Food101.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/food-101/shot_16-seed_1.pkl
Food101 has 30300 test samples
loaded image features from cache/image_features.y_truth.Food101ViT-L-14laion2b_s32b_b82k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  86.83828115463257
EVALUATING ON DATASET:  FGVCAircraft
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/fgvc_aircraft/shot_16-seed_1.pkl
FGVCAircraft has 3333 test samples
loaded image features from cache/image_features.y_truth.FGVCAircraftViT-L-14laion2b_s32b_b82k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  37.1437132358551
EVALUATING ON DATASET:  SUN397
Reading split from /scratch/cliao25/sun397/split_zhou_SUN397.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/sun397/shot_16-seed_1.pkl
SUN397 has 19850 test samples
loaded image features from cache/image_features.y_truth.SUN397ViT-L-14laion2b_s32b_b82k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  73.79344701766968
EVALUATING ON DATASET:  DTD
Reading split from /scratch/cliao25/dtd/split_zhou_DescribableTextures.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/dtd/shot_16-seed_1.pkl
DTD has 1692 test samples
loaded image features from cache/image_features.y_truth.DTDViT-L-14laion2b_s32b_b82k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  58.865249156951904
EVALUATING ON DATASET:  EuroSAT
Reading split from /scratch/cliao25/eurosat/split_zhou_EuroSAT.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/eurosat/shot_16-seed_1.pkl
EuroSAT has 8100 test samples
loaded image features from cache/image_features.y_truth.EuroSATViT-L-14laion2b_s32b_b82k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  52.79012322425842
EVALUATING ON DATASET:  UCF101
Reading split from /scratch/cliao25/ucf101/split_zhou_UCF101.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/ucf101/shot_16-seed_1.pkl
UCF101 has 3783 test samples
loaded image features from cache/image_features.y_truth.UCF101ViT-L-14laion2b_s32b_b82k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  73.85672330856323
EVALUATING ON DATASET:  ImageNetV2
ImageNetV2 has 10000 test samples
loaded image features from cache/image_features.y_truth.ImageNetV2ViT-L-14laion2b_s32b_b82k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  66.57999753952026
EVALUATING ON DATASET:  ImageNetSketch
ImageNetSketch has 50889 test samples
loaded image features from cache/image_features.y_truth.ImageNetSketchViT-L-14laion2b_s32b_b82k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  62.3160183429718
EVALUATING ON DATASET:  ImageNetA
ImageNetA has 7500 test samples
loaded image features from cache/image_features.y_truth.ImageNetAViT-L-14laion2b_s32b_b82k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  50.040000677108765
EVALUATING ON DATASET:  ImageNetR
ImageNetR has 30000 test samples
loaded image features from cache/image_features.y_truth.ImageNetRViT-L-14laion2b_s32b_b82k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  87.04333305358887
Results:
,ImageNet,Caltech101,OxfordPets,StanfordCars,Flowers102,Food101,FGVCAircraft,SUN397,DTD,EuroSAT,UCF101,ImageNetV2,ImageNetSketch,ImageNetA,ImageNetR,
ViT-L-14 laion2b_s32b_b82k COCA ZS,74.57199692726135,96.91683650016785,92.75006651878357,92.37657189369202,76.53268575668335,86.83828115463257,37.1437132358551,73.79344701766968,58.865249156951904,52.79012322425842,73.85672330856323,66.57999753952026,62.3160183429718,50.040000677108765,87.04333305358887,
Namespace(accum_iter=1, adapter=0, adaptive_margin=0.0, bitfit=0, bs=32, cache_dir='/projectnb/textconv/cliao25/data', captioner='BLIP', checkpoint='', d=768, data_dir='/scratch/cliao25', dataset='', ema=0.995, eval_only=0, ice=True, ice_k=5, ice_lambda=0.08, init_lam=0.0, iters_per_epoch=750, label_smoothing=0.0, layer_start_t=9, layer_start_v=9, lora=0, loss='ce', lr=2e-05, lr_decay=0.0, maple=0, margin=0.0, modelname='ViT-L-14', n_descriptors=-1, n_epochs=1, optimizer='sgd', pretrained='laion2b_s32b_b82k', prompt_lr_multi=10.0, rank=4, resblock_adapter=0, samples_per_class=1, save_model=0, seed=1, shallow_prompt_init='a photo of', shots=16, skip_ema_iters=0, ssf=0, subsample_classes='all', temp=60.0, text_prompt_depth=0, text_prompt_length=0, train_text_encoder=0, train_visual_encoder=0, use_all_logits=False, use_fixed_lambda=False, v=3, visual_prompt_depth=0, visual_prompt_length=0, wd=1e-05)
EVALUATING ON DATASET:  ImageNet
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/imagenet/shot_16-seed_1.pkl
ImageNet has 50000 test samples
loaded image features from cache/image_features.y_truth.ImageNetViT-L-14laion2b_s32b_b82k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  74.22999739646912
EVALUATING ON DATASET:  Caltech101
Reading split from /scratch/cliao25/caltech-101/split_zhou_Caltech101.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/caltech-101/shot_16-seed_1.pkl
Caltech101 has 2465 test samples
loaded image features from cache/image_features.y_truth.Caltech101ViT-L-14laion2b_s32b_b82k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  96.71399593353271
EVALUATING ON DATASET:  OxfordPets
Reading split from /scratch/cliao25/oxford_pets/split_zhou_OxfordPets.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/oxford_pets/shot_16-seed_1.pkl
OxfordPets has 3669 test samples
loaded image features from cache/image_features.y_truth.OxfordPetsViT-L-14laion2b_s32b_b82k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  92.695552110672
EVALUATING ON DATASET:  StanfordCars
Reading split from /scratch/cliao25/stanford_cars/split_zhou_StanfordCars.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/stanford_cars/shot_16-seed_1.pkl
StanfordCars has 8041 test samples
loaded image features from cache/image_features.y_truth.StanfordCarsViT-L-14laion2b_s32b_b82k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  91.77963137626648
EVALUATING ON DATASET:  Flowers102
Reading split from /scratch/cliao25/oxford_flowers/split_zhou_OxfordFlowers.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/oxford_flowers/shot_16-seed_1.pkl
Flowers102 has 2463 test samples
loaded image features from cache/image_features.y_truth.Flowers102ViT-L-14laion2b_s32b_b82k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  76.16727948188782
EVALUATING ON DATASET:  Food101
Reading split from /scratch/cliao25/food-101/split_zhou_Food101.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/food-101/shot_16-seed_1.pkl
Food101 has 30300 test samples
loaded image features from cache/image_features.y_truth.Food101ViT-L-14laion2b_s32b_b82k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  86.6468608379364
EVALUATING ON DATASET:  FGVCAircraft
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/fgvc_aircraft/shot_16-seed_1.pkl
FGVCAircraft has 3333 test samples
loaded image features from cache/image_features.y_truth.FGVCAircraftViT-L-14laion2b_s32b_b82k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  34.6834659576416
EVALUATING ON DATASET:  SUN397
Reading split from /scratch/cliao25/sun397/split_zhou_SUN397.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/sun397/shot_16-seed_1.pkl
SUN397 has 19850 test samples
loaded image features from cache/image_features.y_truth.SUN397ViT-L-14laion2b_s32b_b82k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  73.66246581077576
EVALUATING ON DATASET:  DTD
Reading split from /scratch/cliao25/dtd/split_zhou_DescribableTextures.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/dtd/shot_16-seed_1.pkl
DTD has 1692 test samples
loaded image features from cache/image_features.y_truth.DTDViT-L-14laion2b_s32b_b82k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  58.80614519119263
EVALUATING ON DATASET:  EuroSAT
Reading split from /scratch/cliao25/eurosat/split_zhou_EuroSAT.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/eurosat/shot_16-seed_1.pkl
EuroSAT has 8100 test samples
loaded image features from cache/image_features.y_truth.EuroSATViT-L-14laion2b_s32b_b82k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  51.851850748062134
EVALUATING ON DATASET:  UCF101
Reading split from /scratch/cliao25/ucf101/split_zhou_UCF101.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/ucf101/shot_16-seed_1.pkl
UCF101 has 3783 test samples
loaded image features from cache/image_features.y_truth.UCF101ViT-L-14laion2b_s32b_b82k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  73.96246194839478
EVALUATING ON DATASET:  ImageNetV2
ImageNetV2 has 10000 test samples
loaded image features from cache/image_features.y_truth.ImageNetV2ViT-L-14laion2b_s32b_b82k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  66.3100004196167
EVALUATING ON DATASET:  ImageNetSketch
ImageNetSketch has 50889 test samples
loaded image features from cache/image_features.y_truth.ImageNetSketchViT-L-14laion2b_s32b_b82k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  62.18829154968262
EVALUATING ON DATASET:  ImageNetA
ImageNetA has 7500 test samples
loaded image features from cache/image_features.y_truth.ImageNetAViT-L-14laion2b_s32b_b82k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  51.18666887283325
EVALUATING ON DATASET:  ImageNetR
ImageNetR has 30000 test samples
loaded image features from cache/image_features.y_truth.ImageNetRViT-L-14laion2b_s32b_b82k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  87.33000159263611
Results:
,ImageNet,Caltech101,OxfordPets,StanfordCars,Flowers102,Food101,FGVCAircraft,SUN397,DTD,EuroSAT,UCF101,ImageNetV2,ImageNetSketch,ImageNetA,ImageNetR,
ViT-L-14 laion2b_s32b_b82k BLIP ZS,74.22999739646912,96.71399593353271,92.695552110672,91.77963137626648,76.16727948188782,86.6468608379364,34.6834659576416,73.66246581077576,58.80614519119263,51.851850748062134,73.96246194839478,66.3100004196167,62.18829154968262,51.18666887283325,87.33000159263611,
Namespace(accum_iter=1, adapter=0, adaptive_margin=0.0, bitfit=0, bs=32, cache_dir='/projectnb/textconv/cliao25/data', captioner='LLAVA', checkpoint='', d=768, data_dir='/scratch/cliao25', dataset='', ema=0.995, eval_only=0, ice=True, ice_k=5, ice_lambda=0.08, init_lam=0.0, iters_per_epoch=750, label_smoothing=0.0, layer_start_t=9, layer_start_v=9, lora=0, loss='ce', lr=2e-05, lr_decay=0.0, maple=0, margin=0.0, modelname='ViT-L-14', n_descriptors=-1, n_epochs=1, optimizer='sgd', pretrained='laion2b_s32b_b82k', prompt_lr_multi=10.0, rank=4, resblock_adapter=0, samples_per_class=1, save_model=0, seed=1, shallow_prompt_init='a photo of', shots=16, skip_ema_iters=0, ssf=0, subsample_classes='all', temp=60.0, text_prompt_depth=0, text_prompt_length=0, train_text_encoder=0, train_visual_encoder=0, use_all_logits=False, use_fixed_lambda=False, v=3, visual_prompt_depth=0, visual_prompt_length=0, wd=1e-05)
EVALUATING ON DATASET:  ImageNet
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/imagenet/shot_16-seed_1.pkl
ImageNet has 50000 test samples
loaded image features from cache/image_features.y_truth.ImageNetViT-L-14laion2b_s32b_b82k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  73.76599907875061
EVALUATING ON DATASET:  Caltech101
Reading split from /scratch/cliao25/caltech-101/split_zhou_Caltech101.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/caltech-101/shot_16-seed_1.pkl
Caltech101 has 2465 test samples
loaded image features from cache/image_features.y_truth.Caltech101ViT-L-14laion2b_s32b_b82k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  96.99797034263611
EVALUATING ON DATASET:  OxfordPets
Reading split from /scratch/cliao25/oxford_pets/split_zhou_OxfordPets.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/oxford_pets/shot_16-seed_1.pkl
OxfordPets has 3669 test samples
loaded image features from cache/image_features.y_truth.OxfordPetsViT-L-14laion2b_s32b_b82k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  92.53202080726624
EVALUATING ON DATASET:  StanfordCars
Reading split from /scratch/cliao25/stanford_cars/split_zhou_StanfordCars.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/stanford_cars/shot_16-seed_1.pkl
StanfordCars has 8041 test samples
loaded image features from cache/image_features.y_truth.StanfordCarsViT-L-14laion2b_s32b_b82k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  91.59308671951294
EVALUATING ON DATASET:  Flowers102
Reading split from /scratch/cliao25/oxford_flowers/split_zhou_OxfordFlowers.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/oxford_flowers/shot_16-seed_1.pkl
Flowers102 has 2463 test samples
loaded image features from cache/image_features.y_truth.Flowers102ViT-L-14laion2b_s32b_b82k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  75.11165142059326
EVALUATING ON DATASET:  Food101
Reading split from /scratch/cliao25/food-101/split_zhou_Food101.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/food-101/shot_16-seed_1.pkl
Food101 has 30300 test samples
loaded image features from cache/image_features.y_truth.Food101ViT-L-14laion2b_s32b_b82k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  86.26072406768799
EVALUATING ON DATASET:  FGVCAircraft
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/fgvc_aircraft/shot_16-seed_1.pkl
FGVCAircraft has 3333 test samples
loaded image features from cache/image_features.y_truth.FGVCAircraftViT-L-14laion2b_s32b_b82k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  34.65346395969391
EVALUATING ON DATASET:  SUN397
Reading split from /scratch/cliao25/sun397/split_zhou_SUN397.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/sun397/shot_16-seed_1.pkl
SUN397 has 19850 test samples
loaded image features from cache/image_features.y_truth.SUN397ViT-L-14laion2b_s32b_b82k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  73.25944304466248
EVALUATING ON DATASET:  DTD
Reading split from /scratch/cliao25/dtd/split_zhou_DescribableTextures.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/dtd/shot_16-seed_1.pkl
DTD has 1692 test samples
loaded image features from cache/image_features.y_truth.DTDViT-L-14laion2b_s32b_b82k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  58.56974124908447
EVALUATING ON DATASET:  EuroSAT
Reading split from /scratch/cliao25/eurosat/split_zhou_EuroSAT.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/eurosat/shot_16-seed_1.pkl
EuroSAT has 8100 test samples
loaded image features from cache/image_features.y_truth.EuroSATViT-L-14laion2b_s32b_b82k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  53.71605157852173
EVALUATING ON DATASET:  UCF101
Reading split from /scratch/cliao25/ucf101/split_zhou_UCF101.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/ucf101/shot_16-seed_1.pkl
UCF101 has 3783 test samples
loaded image features from cache/image_features.y_truth.UCF101ViT-L-14laion2b_s32b_b82k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  73.38091135025024
EVALUATING ON DATASET:  ImageNetV2
ImageNetV2 has 10000 test samples
loaded image features from cache/image_features.y_truth.ImageNetV2ViT-L-14laion2b_s32b_b82k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  65.95999598503113
EVALUATING ON DATASET:  ImageNetSketch
ImageNetSketch has 50889 test samples
loaded image features from cache/image_features.y_truth.ImageNetSketchViT-L-14laion2b_s32b_b82k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  61.451393365859985
EVALUATING ON DATASET:  ImageNetA
ImageNetA has 7500 test samples
loaded image features from cache/image_features.y_truth.ImageNetAViT-L-14laion2b_s32b_b82k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  49.799999594688416
EVALUATING ON DATASET:  ImageNetR
ImageNetR has 30000 test samples
loaded image features from cache/image_features.y_truth.ImageNetRViT-L-14laion2b_s32b_b82k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  86.71666979789734
Results:
,ImageNet,Caltech101,OxfordPets,StanfordCars,Flowers102,Food101,FGVCAircraft,SUN397,DTD,EuroSAT,UCF101,ImageNetV2,ImageNetSketch,ImageNetA,ImageNetR,
ViT-L-14 laion2b_s32b_b82k LLAVA ZS,73.76599907875061,96.99797034263611,92.53202080726624,91.59308671951294,75.11165142059326,86.26072406768799,34.65346395969391,73.25944304466248,58.56974124908447,53.71605157852173,73.38091135025024,65.95999598503113,61.451393365859985,49.799999594688416,86.71666979789734,
Namespace(accum_iter=1, adapter=0, adaptive_margin=0.0, bitfit=0, bs=32, cache_dir='/projectnb/textconv/cliao25/data', captioner='COCA', checkpoint='', d=768, data_dir='/scratch/cliao25', dataset='', ema=0.995, eval_only=0, ice=True, ice_k=5, ice_lambda=0.08, init_lam=0.0, iters_per_epoch=750, label_smoothing=0.0, layer_start_t=9, layer_start_v=9, lora=0, loss='ce', lr=2e-05, lr_decay=0.0, maple=0, margin=0.0, modelname='ViT-L-14', n_descriptors=-1, n_epochs=1, optimizer='sgd', pretrained='openai', prompt_lr_multi=10.0, rank=4, resblock_adapter=0, samples_per_class=1, save_model=0, seed=1, shallow_prompt_init='a photo of', shots=16, skip_ema_iters=0, ssf=0, subsample_classes='all', temp=60.0, text_prompt_depth=0, text_prompt_length=0, train_text_encoder=0, train_visual_encoder=0, use_all_logits=False, use_fixed_lambda=False, v=3, visual_prompt_depth=0, visual_prompt_length=0, wd=1e-05)
EVALUATING ON DATASET:  ImageNet
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/imagenet/shot_16-seed_1.pkl
ImageNet has 50000 test samples
loaded image features from cache/image_features.y_truth.ImageNetViT-L-14openai.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  75.40799975395203
EVALUATING ON DATASET:  Caltech101
Reading split from /scratch/cliao25/caltech-101/split_zhou_Caltech101.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/caltech-101/shot_16-seed_1.pkl
Caltech101 has 2465 test samples
loaded image features from cache/image_features.y_truth.Caltech101ViT-L-14openai.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  95.25355100631714
EVALUATING ON DATASET:  OxfordPets
Reading split from /scratch/cliao25/oxford_pets/split_zhou_OxfordPets.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/oxford_pets/shot_16-seed_1.pkl
OxfordPets has 3669 test samples
loaded image features from cache/image_features.y_truth.OxfordPetsViT-L-14openai.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  94.08558011054993
EVALUATING ON DATASET:  StanfordCars
Reading split from /scratch/cliao25/stanford_cars/split_zhou_StanfordCars.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/stanford_cars/shot_16-seed_1.pkl
StanfordCars has 8041 test samples
loaded image features from cache/image_features.y_truth.StanfordCarsViT-L-14openai.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  82.05447196960449
EVALUATING ON DATASET:  Flowers102
Reading split from /scratch/cliao25/oxford_flowers/split_zhou_OxfordFlowers.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/oxford_flowers/shot_16-seed_1.pkl
Flowers102 has 2463 test samples
loaded image features from cache/image_features.y_truth.Flowers102ViT-L-14openai.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  79.94316220283508
EVALUATING ON DATASET:  Food101
Reading split from /scratch/cliao25/food-101/split_zhou_Food101.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/food-101/shot_16-seed_1.pkl
Food101 has 30300 test samples
loaded image features from cache/image_features.y_truth.Food101ViT-L-14openai.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  90.97359776496887
EVALUATING ON DATASET:  FGVCAircraft
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/fgvc_aircraft/shot_16-seed_1.pkl
FGVCAircraft has 3333 test samples
loaded image features from cache/image_features.y_truth.FGVCAircraftViT-L-14openai.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  36.96369528770447
EVALUATING ON DATASET:  SUN397
Reading split from /scratch/cliao25/sun397/split_zhou_SUN397.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/sun397/shot_16-seed_1.pkl
SUN397 has 19850 test samples
loaded image features from cache/image_features.y_truth.SUN397ViT-L-14openai.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  70.2216625213623
EVALUATING ON DATASET:  DTD
Reading split from /scratch/cliao25/dtd/split_zhou_DescribableTextures.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/dtd/shot_16-seed_1.pkl
DTD has 1692 test samples
loaded image features from cache/image_features.y_truth.DTDViT-L-14openai.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  54.60993051528931
EVALUATING ON DATASET:  EuroSAT
Reading split from /scratch/cliao25/eurosat/split_zhou_EuroSAT.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/eurosat/shot_16-seed_1.pkl
EuroSAT has 8100 test samples
loaded image features from cache/image_features.y_truth.EuroSATViT-L-14openai.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  57.51851797103882
EVALUATING ON DATASET:  UCF101
Reading split from /scratch/cliao25/ucf101/split_zhou_UCF101.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/ucf101/shot_16-seed_1.pkl
UCF101 has 3783 test samples
loaded image features from cache/image_features.y_truth.UCF101ViT-L-14openai.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  75.70710778236389
EVALUATING ON DATASET:  ImageNetV2
ImageNetV2 has 10000 test samples
loaded image features from cache/image_features.y_truth.ImageNetV2ViT-L-14openai.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  68.86999607086182
EVALUATING ON DATASET:  ImageNetSketch
ImageNetSketch has 50889 test samples
loaded image features from cache/image_features.y_truth.ImageNetSketchViT-L-14openai.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  60.669296979904175
EVALUATING ON DATASET:  ImageNetA
ImageNetA has 7500 test samples
loaded image features from cache/image_features.y_truth.ImageNetAViT-L-14openai.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  68.57333183288574
EVALUATING ON DATASET:  ImageNetR
ImageNetR has 30000 test samples
loaded image features from cache/image_features.y_truth.ImageNetRViT-L-14openai.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  87.59000301361084
Results:
,ImageNet,Caltech101,OxfordPets,StanfordCars,Flowers102,Food101,FGVCAircraft,SUN397,DTD,EuroSAT,UCF101,ImageNetV2,ImageNetSketch,ImageNetA,ImageNetR,
ViT-L-14 openai COCA ZS,75.40799975395203,95.25355100631714,94.08558011054993,82.05447196960449,79.94316220283508,90.97359776496887,36.96369528770447,70.2216625213623,54.60993051528931,57.51851797103882,75.70710778236389,68.86999607086182,60.669296979904175,68.57333183288574,87.59000301361084,
Namespace(accum_iter=1, adapter=0, adaptive_margin=0.0, bitfit=0, bs=32, cache_dir='/projectnb/textconv/cliao25/data', captioner='BLIP', checkpoint='', d=768, data_dir='/scratch/cliao25', dataset='', ema=0.995, eval_only=0, ice=True, ice_k=5, ice_lambda=0.08, init_lam=0.0, iters_per_epoch=750, label_smoothing=0.0, layer_start_t=9, layer_start_v=9, lora=0, loss='ce', lr=2e-05, lr_decay=0.0, maple=0, margin=0.0, modelname='ViT-L-14', n_descriptors=-1, n_epochs=1, optimizer='sgd', pretrained='openai', prompt_lr_multi=10.0, rank=4, resblock_adapter=0, samples_per_class=1, save_model=0, seed=1, shallow_prompt_init='a photo of', shots=16, skip_ema_iters=0, ssf=0, subsample_classes='all', temp=60.0, text_prompt_depth=0, text_prompt_length=0, train_text_encoder=0, train_visual_encoder=0, use_all_logits=False, use_fixed_lambda=False, v=3, visual_prompt_depth=0, visual_prompt_length=0, wd=1e-05)
EVALUATING ON DATASET:  ImageNet
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/imagenet/shot_16-seed_1.pkl
ImageNet has 50000 test samples
loaded image features from cache/image_features.y_truth.ImageNetViT-L-14openai.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  74.82799887657166
EVALUATING ON DATASET:  Caltech101
Reading split from /scratch/cliao25/caltech-101/split_zhou_Caltech101.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/caltech-101/shot_16-seed_1.pkl
Caltech101 has 2465 test samples
loaded image features from cache/image_features.y_truth.Caltech101ViT-L-14openai.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  95.45639157295227
EVALUATING ON DATASET:  OxfordPets
Reading split from /scratch/cliao25/oxford_pets/split_zhou_OxfordPets.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/oxford_pets/shot_16-seed_1.pkl
OxfordPets has 3669 test samples
loaded image features from cache/image_features.y_truth.OxfordPetsViT-L-14openai.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  93.07712912559509
EVALUATING ON DATASET:  StanfordCars
Reading split from /scratch/cliao25/stanford_cars/split_zhou_StanfordCars.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/stanford_cars/shot_16-seed_1.pkl
StanfordCars has 8041 test samples
loaded image features from cache/image_features.y_truth.StanfordCarsViT-L-14openai.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  78.59719395637512
EVALUATING ON DATASET:  Flowers102
Reading split from /scratch/cliao25/oxford_flowers/split_zhou_OxfordFlowers.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/oxford_flowers/shot_16-seed_1.pkl
Flowers102 has 2463 test samples
loaded image features from cache/image_features.y_truth.Flowers102ViT-L-14openai.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  79.37474846839905
EVALUATING ON DATASET:  Food101
Reading split from /scratch/cliao25/food-101/split_zhou_Food101.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/food-101/shot_16-seed_1.pkl
Food101 has 30300 test samples
loaded image features from cache/image_features.y_truth.Food101ViT-L-14openai.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  90.4422402381897
EVALUATING ON DATASET:  FGVCAircraft
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/fgvc_aircraft/shot_16-seed_1.pkl
FGVCAircraft has 3333 test samples
loaded image features from cache/image_features.y_truth.FGVCAircraftViT-L-14openai.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  32.55325257778168
EVALUATING ON DATASET:  SUN397
Reading split from /scratch/cliao25/sun397/split_zhou_SUN397.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/sun397/shot_16-seed_1.pkl
SUN397 has 19850 test samples
loaded image features from cache/image_features.y_truth.SUN397ViT-L-14openai.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  70.3476071357727
EVALUATING ON DATASET:  DTD
Reading split from /scratch/cliao25/dtd/split_zhou_DescribableTextures.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/dtd/shot_16-seed_1.pkl
DTD has 1692 test samples
loaded image features from cache/image_features.y_truth.DTDViT-L-14openai.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  54.728132486343384
EVALUATING ON DATASET:  EuroSAT
Reading split from /scratch/cliao25/eurosat/split_zhou_EuroSAT.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/eurosat/shot_16-seed_1.pkl
EuroSAT has 8100 test samples
loaded image features from cache/image_features.y_truth.EuroSATViT-L-14openai.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  56.34567737579346
EVALUATING ON DATASET:  UCF101
Reading split from /scratch/cliao25/ucf101/split_zhou_UCF101.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/ucf101/shot_16-seed_1.pkl
UCF101 has 3783 test samples
loaded image features from cache/image_features.y_truth.UCF101ViT-L-14openai.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  75.38989782333374
EVALUATING ON DATASET:  ImageNetV2
ImageNetV2 has 10000 test samples
loaded image features from cache/image_features.y_truth.ImageNetV2ViT-L-14openai.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  68.77999901771545
EVALUATING ON DATASET:  ImageNetSketch
ImageNetSketch has 50889 test samples
loaded image features from cache/image_features.y_truth.ImageNetSketchViT-L-14openai.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  60.02082824707031
EVALUATING ON DATASET:  ImageNetA
ImageNetA has 7500 test samples
loaded image features from cache/image_features.y_truth.ImageNetAViT-L-14openai.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  69.6399986743927
EVALUATING ON DATASET:  ImageNetR
ImageNetR has 30000 test samples
loaded image features from cache/image_features.y_truth.ImageNetRViT-L-14openai.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  88.00333142280579
Results:
,ImageNet,Caltech101,OxfordPets,StanfordCars,Flowers102,Food101,FGVCAircraft,SUN397,DTD,EuroSAT,UCF101,ImageNetV2,ImageNetSketch,ImageNetA,ImageNetR,
ViT-L-14 openai BLIP ZS,74.82799887657166,95.45639157295227,93.07712912559509,78.59719395637512,79.37474846839905,90.4422402381897,32.55325257778168,70.3476071357727,54.728132486343384,56.34567737579346,75.38989782333374,68.77999901771545,60.02082824707031,69.6399986743927,88.00333142280579,
Namespace(accum_iter=1, adapter=0, adaptive_margin=0.0, bitfit=0, bs=32, cache_dir='/projectnb/textconv/cliao25/data', captioner='LLAVA', checkpoint='', d=768, data_dir='/scratch/cliao25', dataset='', ema=0.995, eval_only=0, ice=True, ice_k=5, ice_lambda=0.08, init_lam=0.0, iters_per_epoch=750, label_smoothing=0.0, layer_start_t=9, layer_start_v=9, lora=0, loss='ce', lr=2e-05, lr_decay=0.0, maple=0, margin=0.0, modelname='ViT-L-14', n_descriptors=-1, n_epochs=1, optimizer='sgd', pretrained='openai', prompt_lr_multi=10.0, rank=4, resblock_adapter=0, samples_per_class=1, save_model=0, seed=1, shallow_prompt_init='a photo of', shots=16, skip_ema_iters=0, ssf=0, subsample_classes='all', temp=60.0, text_prompt_depth=0, text_prompt_length=0, train_text_encoder=0, train_visual_encoder=0, use_all_logits=False, use_fixed_lambda=False, v=3, visual_prompt_depth=0, visual_prompt_length=0, wd=1e-05)
EVALUATING ON DATASET:  ImageNet
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/imagenet/shot_16-seed_1.pkl
ImageNet has 50000 test samples
loaded image features from cache/image_features.y_truth.ImageNetViT-L-14openai.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  74.12999868392944
EVALUATING ON DATASET:  Caltech101
Reading split from /scratch/cliao25/caltech-101/split_zhou_Caltech101.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/caltech-101/shot_16-seed_1.pkl
Caltech101 has 2465 test samples
loaded image features from cache/image_features.y_truth.Caltech101ViT-L-14openai.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  95.050710439682
EVALUATING ON DATASET:  OxfordPets
Reading split from /scratch/cliao25/oxford_pets/split_zhou_OxfordPets.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/oxford_pets/shot_16-seed_1.pkl
OxfordPets has 3669 test samples
loaded image features from cache/image_features.y_truth.OxfordPetsViT-L-14openai.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  92.96810626983643
EVALUATING ON DATASET:  StanfordCars
Reading split from /scratch/cliao25/stanford_cars/split_zhou_StanfordCars.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/stanford_cars/shot_16-seed_1.pkl
StanfordCars has 8041 test samples
loaded image features from cache/image_features.y_truth.StanfordCarsViT-L-14openai.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  76.0477602481842
EVALUATING ON DATASET:  Flowers102
Reading split from /scratch/cliao25/oxford_flowers/split_zhou_OxfordFlowers.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/oxford_flowers/shot_16-seed_1.pkl
Flowers102 has 2463 test samples
loaded image features from cache/image_features.y_truth.Flowers102ViT-L-14openai.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  78.23792099952698
EVALUATING ON DATASET:  Food101
Reading split from /scratch/cliao25/food-101/split_zhou_Food101.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/food-101/shot_16-seed_1.pkl
Food101 has 30300 test samples
loaded image features from cache/image_features.y_truth.Food101ViT-L-14openai.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  90.56435823440552
EVALUATING ON DATASET:  FGVCAircraft
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/fgvc_aircraft/shot_16-seed_1.pkl
FGVCAircraft has 3333 test samples
loaded image features from cache/image_features.y_truth.FGVCAircraftViT-L-14openai.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  32.34323263168335
EVALUATING ON DATASET:  SUN397
Reading split from /scratch/cliao25/sun397/split_zhou_SUN397.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/sun397/shot_16-seed_1.pkl
SUN397 has 19850 test samples
loaded image features from cache/image_features.y_truth.SUN397ViT-L-14openai.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  69.03778314590454
EVALUATING ON DATASET:  DTD
Reading split from /scratch/cliao25/dtd/split_zhou_DescribableTextures.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/dtd/shot_16-seed_1.pkl
DTD has 1692 test samples
loaded image features from cache/image_features.y_truth.DTDViT-L-14openai.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  53.07328701019287
EVALUATING ON DATASET:  EuroSAT
Reading split from /scratch/cliao25/eurosat/split_zhou_EuroSAT.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/eurosat/shot_16-seed_1.pkl
EuroSAT has 8100 test samples
loaded image features from cache/image_features.y_truth.EuroSATViT-L-14openai.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  57.38271474838257
EVALUATING ON DATASET:  UCF101
Reading split from /scratch/cliao25/ucf101/split_zhou_UCF101.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/ucf101/shot_16-seed_1.pkl
UCF101 has 3783 test samples
loaded image features from cache/image_features.y_truth.UCF101ViT-L-14openai.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  74.57044124603271
EVALUATING ON DATASET:  ImageNetV2
ImageNetV2 has 10000 test samples
loaded image features from cache/image_features.y_truth.ImageNetV2ViT-L-14openai.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  68.29000115394592
EVALUATING ON DATASET:  ImageNetSketch
ImageNetSketch has 50889 test samples
loaded image features from cache/image_features.y_truth.ImageNetSketchViT-L-14openai.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  58.448779582977295
EVALUATING ON DATASET:  ImageNetA
ImageNetA has 7500 test samples
loaded image features from cache/image_features.y_truth.ImageNetAViT-L-14openai.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  68.97333264350891
EVALUATING ON DATASET:  ImageNetR
ImageNetR has 30000 test samples
loaded image features from cache/image_features.y_truth.ImageNetRViT-L-14openai.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  86.47666573524475
Results:
,ImageNet,Caltech101,OxfordPets,StanfordCars,Flowers102,Food101,FGVCAircraft,SUN397,DTD,EuroSAT,UCF101,ImageNetV2,ImageNetSketch,ImageNetA,ImageNetR,
ViT-L-14 openai LLAVA ZS,74.12999868392944,95.050710439682,92.96810626983643,76.0477602481842,78.23792099952698,90.56435823440552,32.34323263168335,69.03778314590454,53.07328701019287,57.38271474838257,74.57044124603271,68.29000115394592,58.448779582977295,68.97333264350891,86.47666573524475,
Namespace(accum_iter=1, adapter=0, adaptive_margin=0.0, bitfit=0, bs=32, cache_dir='/projectnb/textconv/cliao25/data', captioner='COCA', checkpoint='', d=1024, data_dir='/scratch/cliao25', dataset='', ema=0.995, eval_only=0, ice=True, ice_k=5, ice_lambda=0.08, init_lam=0.0, iters_per_epoch=750, label_smoothing=0.0, layer_start_t=9, layer_start_v=9, lora=0, loss='ce', lr=2e-05, lr_decay=0.0, maple=0, margin=0.0, modelname='ViT-H-14', n_descriptors=-1, n_epochs=1, optimizer='sgd', pretrained='laion2b_s32b_b79k', prompt_lr_multi=10.0, rank=4, resblock_adapter=0, samples_per_class=1, save_model=0, seed=1, shallow_prompt_init='a photo of', shots=16, skip_ema_iters=0, ssf=0, subsample_classes='all', temp=60.0, text_prompt_depth=0, text_prompt_length=0, train_text_encoder=0, train_visual_encoder=0, use_all_logits=False, use_fixed_lambda=False, v=3, visual_prompt_depth=0, visual_prompt_length=0, wd=1e-05)
EVALUATING ON DATASET:  ImageNet
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/imagenet/shot_16-seed_1.pkl
ImageNet has 50000 test samples
loaded image features from cache/image_features.y_truth.ImageNetViT-H-14laion2b_s32b_b79k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  77.29799747467041
EVALUATING ON DATASET:  Caltech101
Reading split from /scratch/cliao25/caltech-101/split_zhou_Caltech101.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/caltech-101/shot_16-seed_1.pkl
Caltech101 has 2465 test samples
loaded image features from cache/image_features.y_truth.Caltech101ViT-H-14laion2b_s32b_b79k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  97.48478531837463
EVALUATING ON DATASET:  OxfordPets
Reading split from /scratch/cliao25/oxford_pets/split_zhou_OxfordPets.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/oxford_pets/shot_16-seed_1.pkl
OxfordPets has 3669 test samples
loaded image features from cache/image_features.y_truth.OxfordPetsViT-H-14laion2b_s32b_b79k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  94.35813426971436
EVALUATING ON DATASET:  StanfordCars
Reading split from /scratch/cliao25/stanford_cars/split_zhou_StanfordCars.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/stanford_cars/shot_16-seed_1.pkl
StanfordCars has 8041 test samples
loaded image features from cache/image_features.y_truth.StanfordCarsViT-H-14laion2b_s32b_b79k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  93.29685568809509
EVALUATING ON DATASET:  Flowers102
Reading split from /scratch/cliao25/oxford_flowers/split_zhou_OxfordFlowers.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/oxford_flowers/shot_16-seed_1.pkl
Flowers102 has 2463 test samples
loaded image features from cache/image_features.y_truth.Flowers102ViT-H-14laion2b_s32b_b79k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  80.75518012046814
EVALUATING ON DATASET:  Food101
Reading split from /scratch/cliao25/food-101/split_zhou_Food101.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/food-101/shot_16-seed_1.pkl
Food101 has 30300 test samples
loaded image features from cache/image_features.y_truth.Food101ViT-H-14laion2b_s32b_b79k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  90.52475094795227
EVALUATING ON DATASET:  FGVCAircraft
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/fgvc_aircraft/shot_16-seed_1.pkl
FGVCAircraft has 3333 test samples
loaded image features from cache/image_features.y_truth.FGVCAircraftViT-H-14laion2b_s32b_b79k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  43.71436834335327
EVALUATING ON DATASET:  SUN397
Reading split from /scratch/cliao25/sun397/split_zhou_SUN397.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/sun397/shot_16-seed_1.pkl
SUN397 has 19850 test samples
loaded image features from cache/image_features.y_truth.SUN397ViT-H-14laion2b_s32b_b79k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  75.627201795578
EVALUATING ON DATASET:  DTD
Reading split from /scratch/cliao25/dtd/split_zhou_DescribableTextures.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/dtd/shot_16-seed_1.pkl
DTD has 1692 test samples
loaded image features from cache/image_features.y_truth.DTDViT-H-14laion2b_s32b_b79k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  65.18912315368652
EVALUATING ON DATASET:  EuroSAT
Reading split from /scratch/cliao25/eurosat/split_zhou_EuroSAT.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/eurosat/shot_16-seed_1.pkl
EuroSAT has 8100 test samples
loaded image features from cache/image_features.y_truth.EuroSATViT-H-14laion2b_s32b_b79k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  69.85185146331787
EVALUATING ON DATASET:  UCF101
Reading split from /scratch/cliao25/ucf101/split_zhou_UCF101.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/ucf101/shot_16-seed_1.pkl
UCF101 has 3783 test samples
loaded image features from cache/image_features.y_truth.UCF101ViT-H-14laion2b_s32b_b79k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  78.53555083274841
EVALUATING ON DATASET:  ImageNetV2
ImageNetV2 has 10000 test samples
loaded image features from cache/image_features.y_truth.ImageNetV2ViT-H-14laion2b_s32b_b79k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  70.73999643325806
EVALUATING ON DATASET:  ImageNetSketch
ImageNetSketch has 50889 test samples
loaded image features from cache/image_features.y_truth.ImageNetSketchViT-H-14laion2b_s32b_b79k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  65.96120595932007
EVALUATING ON DATASET:  ImageNetA
ImageNetA has 7500 test samples
loaded image features from cache/image_features.y_truth.ImageNetAViT-H-14laion2b_s32b_b79k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  59.42666530609131
EVALUATING ON DATASET:  ImageNetR
ImageNetR has 30000 test samples
loaded image features from cache/image_features.y_truth.ImageNetRViT-H-14laion2b_s32b_b79k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  88.58333230018616
Results:
,ImageNet,Caltech101,OxfordPets,StanfordCars,Flowers102,Food101,FGVCAircraft,SUN397,DTD,EuroSAT,UCF101,ImageNetV2,ImageNetSketch,ImageNetA,ImageNetR,
ViT-H-14 laion2b_s32b_b79k COCA ZS,77.29799747467041,97.48478531837463,94.35813426971436,93.29685568809509,80.75518012046814,90.52475094795227,43.71436834335327,75.627201795578,65.18912315368652,69.85185146331787,78.53555083274841,70.73999643325806,65.96120595932007,59.42666530609131,88.58333230018616,
Namespace(accum_iter=1, adapter=0, adaptive_margin=0.0, bitfit=0, bs=32, cache_dir='/projectnb/textconv/cliao25/data', captioner='BLIP', checkpoint='', d=1024, data_dir='/scratch/cliao25', dataset='', ema=0.995, eval_only=0, ice=True, ice_k=5, ice_lambda=0.08, init_lam=0.0, iters_per_epoch=750, label_smoothing=0.0, layer_start_t=9, layer_start_v=9, lora=0, loss='ce', lr=2e-05, lr_decay=0.0, maple=0, margin=0.0, modelname='ViT-H-14', n_descriptors=-1, n_epochs=1, optimizer='sgd', pretrained='laion2b_s32b_b79k', prompt_lr_multi=10.0, rank=4, resblock_adapter=0, samples_per_class=1, save_model=0, seed=1, shallow_prompt_init='a photo of', shots=16, skip_ema_iters=0, ssf=0, subsample_classes='all', temp=60.0, text_prompt_depth=0, text_prompt_length=0, train_text_encoder=0, train_visual_encoder=0, use_all_logits=False, use_fixed_lambda=False, v=3, visual_prompt_depth=0, visual_prompt_length=0, wd=1e-05)
EVALUATING ON DATASET:  ImageNet
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/imagenet/shot_16-seed_1.pkl
ImageNet has 50000 test samples
loaded image features from cache/image_features.y_truth.ImageNetViT-H-14laion2b_s32b_b79k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  77.27599740028381
EVALUATING ON DATASET:  Caltech101
Reading split from /scratch/cliao25/caltech-101/split_zhou_Caltech101.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/caltech-101/shot_16-seed_1.pkl
Caltech101 has 2465 test samples
loaded image features from cache/image_features.y_truth.Caltech101ViT-H-14laion2b_s32b_b79k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  97.64705896377563
EVALUATING ON DATASET:  OxfordPets
Reading split from /scratch/cliao25/oxford_pets/split_zhou_OxfordPets.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/oxford_pets/shot_16-seed_1.pkl
OxfordPets has 3669 test samples
loaded image features from cache/image_features.y_truth.OxfordPetsViT-H-14laion2b_s32b_b79k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  94.38538551330566
EVALUATING ON DATASET:  StanfordCars
Reading split from /scratch/cliao25/stanford_cars/split_zhou_StanfordCars.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/stanford_cars/shot_16-seed_1.pkl
StanfordCars has 8041 test samples
loaded image features from cache/image_features.y_truth.StanfordCarsViT-H-14laion2b_s32b_b79k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  92.87402629852295
EVALUATING ON DATASET:  Flowers102
Reading split from /scratch/cliao25/oxford_flowers/split_zhou_OxfordFlowers.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/oxford_flowers/shot_16-seed_1.pkl
Flowers102 has 2463 test samples
loaded image features from cache/image_features.y_truth.Flowers102ViT-H-14laion2b_s32b_b79k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  80.55217266082764
EVALUATING ON DATASET:  Food101
Reading split from /scratch/cliao25/food-101/split_zhou_Food101.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/food-101/shot_16-seed_1.pkl
Food101 has 30300 test samples
loaded image features from cache/image_features.y_truth.Food101ViT-H-14laion2b_s32b_b79k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  90.47854542732239
EVALUATING ON DATASET:  FGVCAircraft
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/fgvc_aircraft/shot_16-seed_1.pkl
FGVCAircraft has 3333 test samples
loaded image features from cache/image_features.y_truth.FGVCAircraftViT-H-14laion2b_s32b_b79k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  42.904287576675415
EVALUATING ON DATASET:  SUN397
Reading split from /scratch/cliao25/sun397/split_zhou_SUN397.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/sun397/shot_16-seed_1.pkl
SUN397 has 19850 test samples
loaded image features from cache/image_features.y_truth.SUN397ViT-H-14laion2b_s32b_b79k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  75.45087933540344
EVALUATING ON DATASET:  DTD
Reading split from /scratch/cliao25/dtd/split_zhou_DescribableTextures.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/dtd/shot_16-seed_1.pkl
DTD has 1692 test samples
loaded image features from cache/image_features.y_truth.DTDViT-H-14laion2b_s32b_b79k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  64.89361524581909
EVALUATING ON DATASET:  EuroSAT
Reading split from /scratch/cliao25/eurosat/split_zhou_EuroSAT.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/eurosat/shot_16-seed_1.pkl
EuroSAT has 8100 test samples
loaded image features from cache/image_features.y_truth.EuroSATViT-H-14laion2b_s32b_b79k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  65.51851630210876
EVALUATING ON DATASET:  UCF101
Reading split from /scratch/cliao25/ucf101/split_zhou_UCF101.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/ucf101/shot_16-seed_1.pkl
UCF101 has 3783 test samples
loaded image features from cache/image_features.y_truth.UCF101ViT-H-14laion2b_s32b_b79k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  79.06423211097717
EVALUATING ON DATASET:  ImageNetV2
ImageNetV2 has 10000 test samples
loaded image features from cache/image_features.y_truth.ImageNetV2ViT-H-14laion2b_s32b_b79k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  70.60999870300293
EVALUATING ON DATASET:  ImageNetSketch
ImageNetSketch has 50889 test samples
loaded image features from cache/image_features.y_truth.ImageNetSketchViT-H-14laion2b_s32b_b79k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  65.73325991630554
EVALUATING ON DATASET:  ImageNetA
ImageNetA has 7500 test samples
loaded image features from cache/image_features.y_truth.ImageNetAViT-H-14laion2b_s32b_b79k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  61.01333498954773
EVALUATING ON DATASET:  ImageNetR
ImageNetR has 30000 test samples
loaded image features from cache/image_features.y_truth.ImageNetRViT-H-14laion2b_s32b_b79k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  88.93333673477173
Results:
,ImageNet,Caltech101,OxfordPets,StanfordCars,Flowers102,Food101,FGVCAircraft,SUN397,DTD,EuroSAT,UCF101,ImageNetV2,ImageNetSketch,ImageNetA,ImageNetR,
ViT-H-14 laion2b_s32b_b79k BLIP ZS,77.27599740028381,97.64705896377563,94.38538551330566,92.87402629852295,80.55217266082764,90.47854542732239,42.904287576675415,75.45087933540344,64.89361524581909,65.51851630210876,79.06423211097717,70.60999870300293,65.73325991630554,61.01333498954773,88.93333673477173,
Namespace(accum_iter=1, adapter=0, adaptive_margin=0.0, bitfit=0, bs=32, cache_dir='/projectnb/textconv/cliao25/data', captioner='LLAVA', checkpoint='', d=1024, data_dir='/scratch/cliao25', dataset='', ema=0.995, eval_only=0, ice=True, ice_k=5, ice_lambda=0.08, init_lam=0.0, iters_per_epoch=750, label_smoothing=0.0, layer_start_t=9, layer_start_v=9, lora=0, loss='ce', lr=2e-05, lr_decay=0.0, maple=0, margin=0.0, modelname='ViT-H-14', n_descriptors=-1, n_epochs=1, optimizer='sgd', pretrained='laion2b_s32b_b79k', prompt_lr_multi=10.0, rank=4, resblock_adapter=0, samples_per_class=1, save_model=0, seed=1, shallow_prompt_init='a photo of', shots=16, skip_ema_iters=0, ssf=0, subsample_classes='all', temp=60.0, text_prompt_depth=0, text_prompt_length=0, train_text_encoder=0, train_visual_encoder=0, use_all_logits=False, use_fixed_lambda=False, v=3, visual_prompt_depth=0, visual_prompt_length=0, wd=1e-05)
EVALUATING ON DATASET:  ImageNet
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/imagenet/shot_16-seed_1.pkl
ImageNet has 50000 test samples
loaded image features from cache/image_features.y_truth.ImageNetViT-H-14laion2b_s32b_b79k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  76.93399786949158
EVALUATING ON DATASET:  Caltech101
Reading split from /scratch/cliao25/caltech-101/split_zhou_Caltech101.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/caltech-101/shot_16-seed_1.pkl
Caltech101 has 2465 test samples
loaded image features from cache/image_features.y_truth.Caltech101ViT-H-14laion2b_s32b_b79k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  97.84989953041077
EVALUATING ON DATASET:  OxfordPets
Reading split from /scratch/cliao25/oxford_pets/split_zhou_OxfordPets.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/oxford_pets/shot_16-seed_1.pkl
OxfordPets has 3669 test samples
loaded image features from cache/image_features.y_truth.OxfordPetsViT-H-14laion2b_s32b_b79k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  94.43989992141724
EVALUATING ON DATASET:  StanfordCars
Reading split from /scratch/cliao25/stanford_cars/split_zhou_StanfordCars.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/stanford_cars/shot_16-seed_1.pkl
StanfordCars has 8041 test samples
loaded image features from cache/image_features.y_truth.StanfordCarsViT-H-14laion2b_s32b_b79k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  92.79940724372864
EVALUATING ON DATASET:  Flowers102
Reading split from /scratch/cliao25/oxford_flowers/split_zhou_OxfordFlowers.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/oxford_flowers/shot_16-seed_1.pkl
Flowers102 has 2463 test samples
loaded image features from cache/image_features.y_truth.Flowers102ViT-H-14laion2b_s32b_b79k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  80.38976788520813
EVALUATING ON DATASET:  Food101
Reading split from /scratch/cliao25/food-101/split_zhou_Food101.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/food-101/shot_16-seed_1.pkl
Food101 has 30300 test samples
loaded image features from cache/image_features.y_truth.Food101ViT-H-14laion2b_s32b_b79k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  90.4851496219635
EVALUATING ON DATASET:  FGVCAircraft
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/fgvc_aircraft/shot_16-seed_1.pkl
FGVCAircraft has 3333 test samples
loaded image features from cache/image_features.y_truth.FGVCAircraftViT-H-14laion2b_s32b_b79k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  42.544251680374146
EVALUATING ON DATASET:  SUN397
Reading split from /scratch/cliao25/sun397/split_zhou_SUN397.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/sun397/shot_16-seed_1.pkl
SUN397 has 19850 test samples
loaded image features from cache/image_features.y_truth.SUN397ViT-H-14laion2b_s32b_b79k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  75.627201795578
EVALUATING ON DATASET:  DTD
Reading split from /scratch/cliao25/dtd/split_zhou_DescribableTextures.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/dtd/shot_16-seed_1.pkl
DTD has 1692 test samples
loaded image features from cache/image_features.y_truth.DTDViT-H-14laion2b_s32b_b79k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  64.77541327476501
EVALUATING ON DATASET:  EuroSAT
Reading split from /scratch/cliao25/eurosat/split_zhou_EuroSAT.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/eurosat/shot_16-seed_1.pkl
EuroSAT has 8100 test samples
loaded image features from cache/image_features.y_truth.EuroSATViT-H-14laion2b_s32b_b79k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  70.19752860069275
EVALUATING ON DATASET:  UCF101
Reading split from /scratch/cliao25/ucf101/split_zhou_UCF101.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/ucf101/shot_16-seed_1.pkl
UCF101 has 3783 test samples
loaded image features from cache/image_features.y_truth.UCF101ViT-H-14laion2b_s32b_b79k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  78.24477553367615
EVALUATING ON DATASET:  ImageNetV2
ImageNetV2 has 10000 test samples
loaded image features from cache/image_features.y_truth.ImageNetV2ViT-H-14laion2b_s32b_b79k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  70.4099953174591
EVALUATING ON DATASET:  ImageNetSketch
ImageNetSketch has 50889 test samples
loaded image features from cache/image_features.y_truth.ImageNetSketchViT-H-14laion2b_s32b_b79k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  65.50334692001343
EVALUATING ON DATASET:  ImageNetA
ImageNetA has 7500 test samples
loaded image features from cache/image_features.y_truth.ImageNetAViT-H-14laion2b_s32b_b79k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  60.11999845504761
EVALUATING ON DATASET:  ImageNetR
ImageNetR has 30000 test samples
loaded image features from cache/image_features.y_truth.ImageNetRViT-H-14laion2b_s32b_b79k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  88.46333622932434
Results:
,ImageNet,Caltech101,OxfordPets,StanfordCars,Flowers102,Food101,FGVCAircraft,SUN397,DTD,EuroSAT,UCF101,ImageNetV2,ImageNetSketch,ImageNetA,ImageNetR,
ViT-H-14 laion2b_s32b_b79k LLAVA ZS,76.93399786949158,97.84989953041077,94.43989992141724,92.79940724372864,80.38976788520813,90.4851496219635,42.544251680374146,75.627201795578,64.77541327476501,70.19752860069275,78.24477553367615,70.4099953174591,65.50334692001343,60.11999845504761,88.46333622932434,
Namespace(accum_iter=1, adapter=0, adaptive_margin=0.0, bitfit=0, bs=32, cache_dir='/projectnb/textconv/cliao25/data', captioner='COCA', checkpoint='', d=1024, data_dir='/scratch/cliao25', dataset='', ema=0.995, eval_only=0, ice=True, ice_k=5, ice_lambda=0.08, init_lam=0.0, iters_per_epoch=750, label_smoothing=0.0, layer_start_t=9, layer_start_v=9, lora=0, loss='ce', lr=2e-05, lr_decay=0.0, maple=0, margin=0.0, modelname='ViT-g-14', n_descriptors=-1, n_epochs=1, optimizer='sgd', pretrained='laion2b_s34b_b88k', prompt_lr_multi=10.0, rank=4, resblock_adapter=0, samples_per_class=1, save_model=0, seed=1, shallow_prompt_init='a photo of', shots=16, skip_ema_iters=0, ssf=0, subsample_classes='all', temp=60.0, text_prompt_depth=0, text_prompt_length=0, train_text_encoder=0, train_visual_encoder=0, use_all_logits=False, use_fixed_lambda=False, v=3, visual_prompt_depth=0, visual_prompt_length=0, wd=1e-05)
EVALUATING ON DATASET:  ImageNet
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/imagenet/shot_16-seed_1.pkl
ImageNet has 50000 test samples
loaded image features from cache/image_features.y_truth.ImageNetViT-g-14laion2b_s34b_b88k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  77.99999713897705
EVALUATING ON DATASET:  Caltech101
Reading split from /scratch/cliao25/caltech-101/split_zhou_Caltech101.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/caltech-101/shot_16-seed_1.pkl
Caltech101 has 2465 test samples
loaded image features from cache/image_features.y_truth.Caltech101ViT-g-14laion2b_s34b_b88k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  97.20081090927124
EVALUATING ON DATASET:  OxfordPets
Reading split from /scratch/cliao25/oxford_pets/split_zhou_OxfordPets.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/oxford_pets/shot_16-seed_1.pkl
OxfordPets has 3669 test samples
loaded image features from cache/image_features.y_truth.OxfordPetsViT-g-14laion2b_s34b_b88k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  93.32242608070374
EVALUATING ON DATASET:  StanfordCars
Reading split from /scratch/cliao25/stanford_cars/split_zhou_StanfordCars.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/stanford_cars/shot_16-seed_1.pkl
StanfordCars has 8041 test samples
loaded image features from cache/image_features.y_truth.StanfordCarsViT-g-14laion2b_s34b_b88k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  93.70725154876709
EVALUATING ON DATASET:  Flowers102
Reading split from /scratch/cliao25/oxford_flowers/split_zhou_OxfordFlowers.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/oxford_flowers/shot_16-seed_1.pkl
Flowers102 has 2463 test samples
loaded image features from cache/image_features.y_truth.Flowers102ViT-g-14laion2b_s34b_b88k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  81.93260431289673
EVALUATING ON DATASET:  Food101
Reading split from /scratch/cliao25/food-101/split_zhou_Food101.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/food-101/shot_16-seed_1.pkl
Food101 has 30300 test samples
loaded image features from cache/image_features.y_truth.Food101ViT-g-14laion2b_s34b_b88k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  90.25742411613464
EVALUATING ON DATASET:  FGVCAircraft
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/fgvc_aircraft/shot_16-seed_1.pkl
FGVCAircraft has 3333 test samples
loaded image features from cache/image_features.y_truth.FGVCAircraftViT-g-14laion2b_s34b_b88k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  45.93459069728851
EVALUATING ON DATASET:  SUN397
Reading split from /scratch/cliao25/sun397/split_zhou_SUN397.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/sun397/shot_16-seed_1.pkl
SUN397 has 19850 test samples
loaded image features from cache/image_features.y_truth.SUN397ViT-g-14laion2b_s34b_b88k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  74.96221661567688
EVALUATING ON DATASET:  DTD
Reading split from /scratch/cliao25/dtd/split_zhou_DescribableTextures.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/dtd/shot_16-seed_1.pkl
DTD has 1692 test samples
loaded image features from cache/image_features.y_truth.DTDViT-g-14laion2b_s34b_b88k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  65.95744490623474
EVALUATING ON DATASET:  EuroSAT
Reading split from /scratch/cliao25/eurosat/split_zhou_EuroSAT.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/eurosat/shot_16-seed_1.pkl
EuroSAT has 8100 test samples
loaded image features from cache/image_features.y_truth.EuroSATViT-g-14laion2b_s34b_b88k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  60.20987629890442
EVALUATING ON DATASET:  UCF101
Reading split from /scratch/cliao25/ucf101/split_zhou_UCF101.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/ucf101/shot_16-seed_1.pkl
UCF101 has 3783 test samples
loaded image features from cache/image_features.y_truth.UCF101ViT-g-14laion2b_s34b_b88k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  80.22732734680176
EVALUATING ON DATASET:  ImageNetV2
ImageNetV2 has 10000 test samples
loaded image features from cache/image_features.y_truth.ImageNetV2ViT-g-14laion2b_s34b_b88k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  70.76999545097351
EVALUATING ON DATASET:  ImageNetSketch
ImageNetSketch has 50889 test samples
loaded image features from cache/image_features.y_truth.ImageNetSketchViT-g-14laion2b_s34b_b88k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  66.73740744590759
EVALUATING ON DATASET:  ImageNetA
ImageNetA has 7500 test samples
loaded image features from cache/image_features.y_truth.ImageNetAViT-g-14laion2b_s34b_b88k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  60.53333282470703
EVALUATING ON DATASET:  ImageNetR
ImageNetR has 30000 test samples
loaded image features from cache/image_features.y_truth.ImageNetRViT-g-14laion2b_s34b_b88k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  89.64666724205017
Results:
,ImageNet,Caltech101,OxfordPets,StanfordCars,Flowers102,Food101,FGVCAircraft,SUN397,DTD,EuroSAT,UCF101,ImageNetV2,ImageNetSketch,ImageNetA,ImageNetR,
ViT-g-14 laion2b_s34b_b88k COCA ZS,77.99999713897705,97.20081090927124,93.32242608070374,93.70725154876709,81.93260431289673,90.25742411613464,45.93459069728851,74.96221661567688,65.95744490623474,60.20987629890442,80.22732734680176,70.76999545097351,66.73740744590759,60.53333282470703,89.64666724205017,
Namespace(accum_iter=1, adapter=0, adaptive_margin=0.0, bitfit=0, bs=32, cache_dir='/projectnb/textconv/cliao25/data', captioner='BLIP', checkpoint='', d=1024, data_dir='/scratch/cliao25', dataset='', ema=0.995, eval_only=0, ice=True, ice_k=5, ice_lambda=0.08, init_lam=0.0, iters_per_epoch=750, label_smoothing=0.0, layer_start_t=9, layer_start_v=9, lora=0, loss='ce', lr=2e-05, lr_decay=0.0, maple=0, margin=0.0, modelname='ViT-g-14', n_descriptors=-1, n_epochs=1, optimizer='sgd', pretrained='laion2b_s34b_b88k', prompt_lr_multi=10.0, rank=4, resblock_adapter=0, samples_per_class=1, save_model=0, seed=1, shallow_prompt_init='a photo of', shots=16, skip_ema_iters=0, ssf=0, subsample_classes='all', temp=60.0, text_prompt_depth=0, text_prompt_length=0, train_text_encoder=0, train_visual_encoder=0, use_all_logits=False, use_fixed_lambda=False, v=3, visual_prompt_depth=0, visual_prompt_length=0, wd=1e-05)
EVALUATING ON DATASET:  ImageNet
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/imagenet/shot_16-seed_1.pkl
ImageNet has 50000 test samples
loaded image features from cache/image_features.y_truth.ImageNetViT-g-14laion2b_s34b_b88k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  78.03999781608582
EVALUATING ON DATASET:  Caltech101
Reading split from /scratch/cliao25/caltech-101/split_zhou_Caltech101.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/caltech-101/shot_16-seed_1.pkl
Caltech101 has 2465 test samples
loaded image features from cache/image_features.y_truth.Caltech101ViT-g-14laion2b_s34b_b88k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  97.36308455467224
EVALUATING ON DATASET:  OxfordPets
Reading split from /scratch/cliao25/oxford_pets/split_zhou_OxfordPets.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/oxford_pets/shot_16-seed_1.pkl
OxfordPets has 3669 test samples
loaded image features from cache/image_features.y_truth.OxfordPetsViT-g-14laion2b_s34b_b88k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  93.45870614051819
EVALUATING ON DATASET:  StanfordCars
Reading split from /scratch/cliao25/stanford_cars/split_zhou_StanfordCars.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/stanford_cars/shot_16-seed_1.pkl
StanfordCars has 8041 test samples
loaded image features from cache/image_features.y_truth.StanfordCarsViT-g-14laion2b_s34b_b88k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  93.42122077941895
EVALUATING ON DATASET:  Flowers102
Reading split from /scratch/cliao25/oxford_flowers/split_zhou_OxfordFlowers.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/oxford_flowers/shot_16-seed_1.pkl
Flowers102 has 2463 test samples
loaded image features from cache/image_features.y_truth.Flowers102ViT-g-14laion2b_s34b_b88k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  82.01380372047424
EVALUATING ON DATASET:  Food101
Reading split from /scratch/cliao25/food-101/split_zhou_Food101.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/food-101/shot_16-seed_1.pkl
Food101 has 30300 test samples
loaded image features from cache/image_features.y_truth.Food101ViT-g-14laion2b_s34b_b88k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  90.26402235031128
EVALUATING ON DATASET:  FGVCAircraft
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/fgvc_aircraft/shot_16-seed_1.pkl
FGVCAircraft has 3333 test samples
loaded image features from cache/image_features.y_truth.FGVCAircraftViT-g-14laion2b_s34b_b88k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  44.55445408821106
EVALUATING ON DATASET:  SUN397
Reading split from /scratch/cliao25/sun397/split_zhou_SUN397.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/sun397/shot_16-seed_1.pkl
SUN397 has 19850 test samples
loaded image features from cache/image_features.y_truth.SUN397ViT-g-14laion2b_s34b_b88k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  74.79093074798584
EVALUATING ON DATASET:  DTD
Reading split from /scratch/cliao25/dtd/split_zhou_DescribableTextures.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/dtd/shot_16-seed_1.pkl
DTD has 1692 test samples
loaded image features from cache/image_features.y_truth.DTDViT-g-14laion2b_s34b_b88k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  66.19385480880737
EVALUATING ON DATASET:  EuroSAT
Reading split from /scratch/cliao25/eurosat/split_zhou_EuroSAT.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/eurosat/shot_16-seed_1.pkl
EuroSAT has 8100 test samples
loaded image features from cache/image_features.y_truth.EuroSATViT-g-14laion2b_s34b_b88k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  59.58024859428406
EVALUATING ON DATASET:  UCF101
Reading split from /scratch/cliao25/ucf101/split_zhou_UCF101.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/ucf101/shot_16-seed_1.pkl
UCF101 has 3783 test samples
loaded image features from cache/image_features.y_truth.UCF101ViT-g-14laion2b_s34b_b88k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  80.25376200675964
EVALUATING ON DATASET:  ImageNetV2
ImageNetV2 has 10000 test samples
loaded image features from cache/image_features.y_truth.ImageNetV2ViT-g-14laion2b_s34b_b88k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  70.77999711036682
EVALUATING ON DATASET:  ImageNetSketch
ImageNetSketch has 50889 test samples
loaded image features from cache/image_features.y_truth.ImageNetSketchViT-g-14laion2b_s34b_b88k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  66.85727834701538
EVALUATING ON DATASET:  ImageNetA
ImageNetA has 7500 test samples
loaded image features from cache/image_features.y_truth.ImageNetAViT-g-14laion2b_s34b_b88k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  61.86666488647461
EVALUATING ON DATASET:  ImageNetR
ImageNetR has 30000 test samples
loaded image features from cache/image_features.y_truth.ImageNetRViT-g-14laion2b_s34b_b88k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  90.04999995231628
Results:
,ImageNet,Caltech101,OxfordPets,StanfordCars,Flowers102,Food101,FGVCAircraft,SUN397,DTD,EuroSAT,UCF101,ImageNetV2,ImageNetSketch,ImageNetA,ImageNetR,
ViT-g-14 laion2b_s34b_b88k BLIP ZS,78.03999781608582,97.36308455467224,93.45870614051819,93.42122077941895,82.01380372047424,90.26402235031128,44.55445408821106,74.79093074798584,66.19385480880737,59.58024859428406,80.25376200675964,70.77999711036682,66.85727834701538,61.86666488647461,90.04999995231628,
Namespace(accum_iter=1, adapter=0, adaptive_margin=0.0, bitfit=0, bs=32, cache_dir='/projectnb/textconv/cliao25/data', captioner='LLAVA', checkpoint='', d=1024, data_dir='/scratch/cliao25', dataset='', ema=0.995, eval_only=0, ice=True, ice_k=5, ice_lambda=0.08, init_lam=0.0, iters_per_epoch=750, label_smoothing=0.0, layer_start_t=9, layer_start_v=9, lora=0, loss='ce', lr=2e-05, lr_decay=0.0, maple=0, margin=0.0, modelname='ViT-g-14', n_descriptors=-1, n_epochs=1, optimizer='sgd', pretrained='laion2b_s34b_b88k', prompt_lr_multi=10.0, rank=4, resblock_adapter=0, samples_per_class=1, save_model=0, seed=1, shallow_prompt_init='a photo of', shots=16, skip_ema_iters=0, ssf=0, subsample_classes='all', temp=60.0, text_prompt_depth=0, text_prompt_length=0, train_text_encoder=0, train_visual_encoder=0, use_all_logits=False, use_fixed_lambda=False, v=3, visual_prompt_depth=0, visual_prompt_length=0, wd=1e-05)
EVALUATING ON DATASET:  ImageNet
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/imagenet/shot_16-seed_1.pkl
ImageNet has 50000 test samples
loaded image features from cache/image_features.y_truth.ImageNetViT-g-14laion2b_s34b_b88k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  77.84799933433533
EVALUATING ON DATASET:  Caltech101
Reading split from /scratch/cliao25/caltech-101/split_zhou_Caltech101.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/caltech-101/shot_16-seed_1.pkl
Caltech101 has 2465 test samples
loaded image features from cache/image_features.y_truth.Caltech101ViT-g-14laion2b_s34b_b88k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  97.48478531837463
EVALUATING ON DATASET:  OxfordPets
Reading split from /scratch/cliao25/oxford_pets/split_zhou_OxfordPets.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/oxford_pets/shot_16-seed_1.pkl
OxfordPets has 3669 test samples
loaded image features from cache/image_features.y_truth.OxfordPetsViT-g-14laion2b_s34b_b88k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  93.37694048881531
EVALUATING ON DATASET:  StanfordCars
Reading split from /scratch/cliao25/stanford_cars/split_zhou_StanfordCars.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/stanford_cars/shot_16-seed_1.pkl
StanfordCars has 8041 test samples
loaded image features from cache/image_features.y_truth.StanfordCarsViT-g-14laion2b_s34b_b88k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  93.52071285247803
EVALUATING ON DATASET:  Flowers102
Reading split from /scratch/cliao25/oxford_flowers/split_zhou_OxfordFlowers.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/oxford_flowers/shot_16-seed_1.pkl
Flowers102 has 2463 test samples
loaded image features from cache/image_features.y_truth.Flowers102ViT-g-14laion2b_s34b_b88k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  81.28299117088318
EVALUATING ON DATASET:  Food101
Reading split from /scratch/cliao25/food-101/split_zhou_Food101.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/food-101/shot_16-seed_1.pkl
Food101 has 30300 test samples
loaded image features from cache/image_features.y_truth.Food101ViT-g-14laion2b_s34b_b88k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  90.19801616668701
EVALUATING ON DATASET:  FGVCAircraft
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/fgvc_aircraft/shot_16-seed_1.pkl
FGVCAircraft has 3333 test samples
loaded image features from cache/image_features.y_truth.FGVCAircraftViT-g-14laion2b_s34b_b88k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  44.55445408821106
EVALUATING ON DATASET:  SUN397
Reading split from /scratch/cliao25/sun397/split_zhou_SUN397.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/sun397/shot_16-seed_1.pkl
SUN397 has 19850 test samples
loaded image features from cache/image_features.y_truth.SUN397ViT-g-14laion2b_s34b_b88k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  74.685138463974
EVALUATING ON DATASET:  DTD
Reading split from /scratch/cliao25/dtd/split_zhou_DescribableTextures.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/dtd/shot_16-seed_1.pkl
DTD has 1692 test samples
loaded image features from cache/image_features.y_truth.DTDViT-g-14laion2b_s34b_b88k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  66.31205677986145
EVALUATING ON DATASET:  EuroSAT
Reading split from /scratch/cliao25/eurosat/split_zhou_EuroSAT.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/eurosat/shot_16-seed_1.pkl
EuroSAT has 8100 test samples
loaded image features from cache/image_features.y_truth.EuroSATViT-g-14laion2b_s34b_b88k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  60.92592477798462
EVALUATING ON DATASET:  UCF101
Reading split from /scratch/cliao25/ucf101/split_zhou_UCF101.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/ucf101/shot_16-seed_1.pkl
UCF101 has 3783 test samples
loaded image features from cache/image_features.y_truth.UCF101ViT-g-14laion2b_s34b_b88k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  79.56647872924805
EVALUATING ON DATASET:  ImageNetV2
ImageNetV2 has 10000 test samples
loaded image features from cache/image_features.y_truth.ImageNetV2ViT-g-14laion2b_s34b_b88k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  70.66999673843384
EVALUATING ON DATASET:  ImageNetSketch
ImageNetSketch has 50889 test samples
loaded image features from cache/image_features.y_truth.ImageNetSketchViT-g-14laion2b_s34b_b88k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  66.55662059783936
EVALUATING ON DATASET:  ImageNetA
ImageNetA has 7500 test samples
loaded image features from cache/image_features.y_truth.ImageNetAViT-g-14laion2b_s34b_b88k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  60.866665840148926
EVALUATING ON DATASET:  ImageNetR
ImageNetR has 30000 test samples
loaded image features from cache/image_features.y_truth.ImageNetRViT-g-14laion2b_s34b_b88k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  89.70333337783813
Results:
,ImageNet,Caltech101,OxfordPets,StanfordCars,Flowers102,Food101,FGVCAircraft,SUN397,DTD,EuroSAT,UCF101,ImageNetV2,ImageNetSketch,ImageNetA,ImageNetR,
ViT-g-14 laion2b_s34b_b88k LLAVA ZS,77.84799933433533,97.48478531837463,93.37694048881531,93.52071285247803,81.28299117088318,90.19801616668701,44.55445408821106,74.685138463974,66.31205677986145,60.92592477798462,79.56647872924805,70.66999673843384,66.55662059783936,60.866665840148926,89.70333337783813,
Namespace(accum_iter=1, adapter=0, adaptive_margin=0.0, bitfit=0, bs=32, cache_dir='/projectnb/textconv/cliao25/data', captioner='COCA', checkpoint='', d=768, data_dir='/scratch/cliao25', dataset='', ema=0.995, eval_only=0, ice=True, ice_k=5, ice_lambda=0.08, init_lam=0.0, iters_per_epoch=750, label_smoothing=0.0, layer_start_t=9, layer_start_v=9, lora=0, loss='ce', lr=2e-05, lr_decay=0.0, maple=0, margin=0.0, modelname='ViT-L-14', n_descriptors=-1, n_epochs=1, optimizer='sgd', pretrained='datacomp_xl_s13b_b90k', prompt_lr_multi=10.0, rank=4, resblock_adapter=0, samples_per_class=1, save_model=0, seed=1, shallow_prompt_init='a photo of', shots=16, skip_ema_iters=0, ssf=0, subsample_classes='all', temp=60.0, text_prompt_depth=0, text_prompt_length=0, train_text_encoder=0, train_visual_encoder=0, use_all_logits=False, use_fixed_lambda=False, v=3, visual_prompt_depth=0, visual_prompt_length=0, wd=1e-05)
EVALUATING ON DATASET:  ImageNet
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/imagenet/shot_16-seed_1.pkl
ImageNet has 50000 test samples
loaded image features from cache/image_features.y_truth.ImageNetViT-L-14datacomp_xl_s13b_b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  79.19600009918213
EVALUATING ON DATASET:  Caltech101
Reading split from /scratch/cliao25/caltech-101/split_zhou_Caltech101.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/caltech-101/shot_16-seed_1.pkl
Caltech101 has 2465 test samples
loaded image features from cache/image_features.y_truth.Caltech101ViT-L-14datacomp_xl_s13b_b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  97.4442183971405
EVALUATING ON DATASET:  OxfordPets
Reading split from /scratch/cliao25/oxford_pets/split_zhou_OxfordPets.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/oxford_pets/shot_16-seed_1.pkl
OxfordPets has 3669 test samples
loaded image features from cache/image_features.y_truth.OxfordPetsViT-L-14datacomp_xl_s13b_b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  95.23030519485474
EVALUATING ON DATASET:  StanfordCars
Reading split from /scratch/cliao25/stanford_cars/split_zhou_StanfordCars.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/stanford_cars/shot_16-seed_1.pkl
StanfordCars has 8041 test samples
loaded image features from cache/image_features.y_truth.StanfordCarsViT-L-14datacomp_xl_s13b_b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  93.8191831111908
EVALUATING ON DATASET:  Flowers102
Reading split from /scratch/cliao25/oxford_flowers/split_zhou_OxfordFlowers.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/oxford_flowers/shot_16-seed_1.pkl
Flowers102 has 2463 test samples
loaded image features from cache/image_features.y_truth.Flowers102ViT-L-14datacomp_xl_s13b_b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  83.84084701538086
EVALUATING ON DATASET:  Food101
Reading split from /scratch/cliao25/food-101/split_zhou_Food101.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/food-101/shot_16-seed_1.pkl
Food101 has 30300 test samples
loaded image features from cache/image_features.y_truth.Food101ViT-L-14datacomp_xl_s13b_b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  92.27392673492432
EVALUATING ON DATASET:  FGVCAircraft
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/fgvc_aircraft/shot_16-seed_1.pkl
FGVCAircraft has 3333 test samples
loaded image features from cache/image_features.y_truth.FGVCAircraftViT-L-14datacomp_xl_s13b_b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  49.32492971420288
EVALUATING ON DATASET:  SUN397
Reading split from /scratch/cliao25/sun397/split_zhou_SUN397.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/sun397/shot_16-seed_1.pkl
SUN397 has 19850 test samples
loaded image features from cache/image_features.y_truth.SUN397ViT-L-14datacomp_xl_s13b_b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  75.03274083137512
EVALUATING ON DATASET:  DTD
Reading split from /scratch/cliao25/dtd/split_zhou_DescribableTextures.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/dtd/shot_16-seed_1.pkl
DTD has 1692 test samples
loaded image features from cache/image_features.y_truth.DTDViT-L-14datacomp_xl_s13b_b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  64.83451724052429
EVALUATING ON DATASET:  EuroSAT
Reading split from /scratch/cliao25/eurosat/split_zhou_EuroSAT.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/eurosat/shot_16-seed_1.pkl
EuroSAT has 8100 test samples
loaded image features from cache/image_features.y_truth.EuroSATViT-L-14datacomp_xl_s13b_b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  66.66666865348816
EVALUATING ON DATASET:  UCF101
Reading split from /scratch/cliao25/ucf101/split_zhou_UCF101.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/ucf101/shot_16-seed_1.pkl
UCF101 has 3783 test samples
loaded image features from cache/image_features.y_truth.UCF101ViT-L-14datacomp_xl_s13b_b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  76.20935440063477
EVALUATING ON DATASET:  ImageNetV2
ImageNetV2 has 10000 test samples
loaded image features from cache/image_features.y_truth.ImageNetV2ViT-L-14datacomp_xl_s13b_b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  72.13000059127808
EVALUATING ON DATASET:  ImageNetSketch
ImageNetSketch has 50889 test samples
loaded image features from cache/image_features.y_truth.ImageNetSketchViT-L-14datacomp_xl_s13b_b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  67.52539873123169
EVALUATING ON DATASET:  ImageNetA
ImageNetA has 7500 test samples
loaded image features from cache/image_features.y_truth.ImageNetAViT-L-14datacomp_xl_s13b_b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  69.13333535194397
EVALUATING ON DATASET:  ImageNetR
ImageNetR has 30000 test samples
loaded image features from cache/image_features.y_truth.ImageNetRViT-L-14datacomp_xl_s13b_b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  90.74000120162964
Results:
,ImageNet,Caltech101,OxfordPets,StanfordCars,Flowers102,Food101,FGVCAircraft,SUN397,DTD,EuroSAT,UCF101,ImageNetV2,ImageNetSketch,ImageNetA,ImageNetR,
ViT-L-14 datacomp_xl_s13b_b90k COCA ZS,79.19600009918213,97.4442183971405,95.23030519485474,93.8191831111908,83.84084701538086,92.27392673492432,49.32492971420288,75.03274083137512,64.83451724052429,66.66666865348816,76.20935440063477,72.13000059127808,67.52539873123169,69.13333535194397,90.74000120162964,
Namespace(accum_iter=1, adapter=0, adaptive_margin=0.0, bitfit=0, bs=32, cache_dir='/projectnb/textconv/cliao25/data', captioner='BLIP', checkpoint='', d=768, data_dir='/scratch/cliao25', dataset='', ema=0.995, eval_only=0, ice=True, ice_k=5, ice_lambda=0.08, init_lam=0.0, iters_per_epoch=750, label_smoothing=0.0, layer_start_t=9, layer_start_v=9, lora=0, loss='ce', lr=2e-05, lr_decay=0.0, maple=0, margin=0.0, modelname='ViT-L-14', n_descriptors=-1, n_epochs=1, optimizer='sgd', pretrained='datacomp_xl_s13b_b90k', prompt_lr_multi=10.0, rank=4, resblock_adapter=0, samples_per_class=1, save_model=0, seed=1, shallow_prompt_init='a photo of', shots=16, skip_ema_iters=0, ssf=0, subsample_classes='all', temp=60.0, text_prompt_depth=0, text_prompt_length=0, train_text_encoder=0, train_visual_encoder=0, use_all_logits=False, use_fixed_lambda=False, v=3, visual_prompt_depth=0, visual_prompt_length=0, wd=1e-05)
EVALUATING ON DATASET:  ImageNet
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/imagenet/shot_16-seed_1.pkl
ImageNet has 50000 test samples
loaded image features from cache/image_features.y_truth.ImageNetViT-L-14datacomp_xl_s13b_b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  79.10400032997131
EVALUATING ON DATASET:  Caltech101
Reading split from /scratch/cliao25/caltech-101/split_zhou_Caltech101.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/caltech-101/shot_16-seed_1.pkl
Caltech101 has 2465 test samples
loaded image features from cache/image_features.y_truth.Caltech101ViT-L-14datacomp_xl_s13b_b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  97.36308455467224
EVALUATING ON DATASET:  OxfordPets
Reading split from /scratch/cliao25/oxford_pets/split_zhou_OxfordPets.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/oxford_pets/shot_16-seed_1.pkl
OxfordPets has 3669 test samples
loaded image features from cache/image_features.y_truth.OxfordPetsViT-L-14datacomp_xl_s13b_b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  95.23030519485474
EVALUATING ON DATASET:  StanfordCars
Reading split from /scratch/cliao25/stanford_cars/split_zhou_StanfordCars.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/stanford_cars/shot_16-seed_1.pkl
StanfordCars has 8041 test samples
loaded image features from cache/image_features.y_truth.StanfordCarsViT-L-14datacomp_xl_s13b_b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  93.42122077941895
EVALUATING ON DATASET:  Flowers102
Reading split from /scratch/cliao25/oxford_flowers/split_zhou_OxfordFlowers.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/oxford_flowers/shot_16-seed_1.pkl
Flowers102 has 2463 test samples
loaded image features from cache/image_features.y_truth.Flowers102ViT-L-14datacomp_xl_s13b_b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  84.28745865821838
EVALUATING ON DATASET:  Food101
Reading split from /scratch/cliao25/food-101/split_zhou_Food101.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/food-101/shot_16-seed_1.pkl
Food101 has 30300 test samples
loaded image features from cache/image_features.y_truth.Food101ViT-L-14datacomp_xl_s13b_b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  92.35643148422241
EVALUATING ON DATASET:  FGVCAircraft
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/fgvc_aircraft/shot_16-seed_1.pkl
FGVCAircraft has 3333 test samples
loaded image features from cache/image_features.y_truth.FGVCAircraftViT-L-14datacomp_xl_s13b_b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  47.074705362319946
EVALUATING ON DATASET:  SUN397
Reading split from /scratch/cliao25/sun397/split_zhou_SUN397.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/sun397/shot_16-seed_1.pkl
SUN397 has 19850 test samples
loaded image features from cache/image_features.y_truth.SUN397ViT-L-14datacomp_xl_s13b_b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  75.00755190849304
EVALUATING ON DATASET:  DTD
Reading split from /scratch/cliao25/dtd/split_zhou_DescribableTextures.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/dtd/shot_16-seed_1.pkl
DTD has 1692 test samples
loaded image features from cache/image_features.y_truth.DTDViT-L-14datacomp_xl_s13b_b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  65.2482271194458
EVALUATING ON DATASET:  EuroSAT
Reading split from /scratch/cliao25/eurosat/split_zhou_EuroSAT.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/eurosat/shot_16-seed_1.pkl
EuroSAT has 8100 test samples
loaded image features from cache/image_features.y_truth.EuroSATViT-L-14datacomp_xl_s13b_b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  65.20987749099731
EVALUATING ON DATASET:  UCF101
Reading split from /scratch/cliao25/ucf101/split_zhou_UCF101.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/ucf101/shot_16-seed_1.pkl
UCF101 has 3783 test samples
loaded image features from cache/image_features.y_truth.UCF101ViT-L-14datacomp_xl_s13b_b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  76.156485080719
EVALUATING ON DATASET:  ImageNetV2
ImageNetV2 has 10000 test samples
loaded image features from cache/image_features.y_truth.ImageNetV2ViT-L-14datacomp_xl_s13b_b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  72.21999764442444
EVALUATING ON DATASET:  ImageNetSketch
ImageNetSketch has 50889 test samples
loaded image features from cache/image_features.y_truth.ImageNetSketchViT-L-14datacomp_xl_s13b_b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  67.46054887771606
EVALUATING ON DATASET:  ImageNetA
ImageNetA has 7500 test samples
loaded image features from cache/image_features.y_truth.ImageNetAViT-L-14datacomp_xl_s13b_b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  70.21333575248718
EVALUATING ON DATASET:  ImageNetR
ImageNetR has 30000 test samples
loaded image features from cache/image_features.y_truth.ImageNetRViT-L-14datacomp_xl_s13b_b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  91.11000299453735
Results:
,ImageNet,Caltech101,OxfordPets,StanfordCars,Flowers102,Food101,FGVCAircraft,SUN397,DTD,EuroSAT,UCF101,ImageNetV2,ImageNetSketch,ImageNetA,ImageNetR,
ViT-L-14 datacomp_xl_s13b_b90k BLIP ZS,79.10400032997131,97.36308455467224,95.23030519485474,93.42122077941895,84.28745865821838,92.35643148422241,47.074705362319946,75.00755190849304,65.2482271194458,65.20987749099731,76.156485080719,72.21999764442444,67.46054887771606,70.21333575248718,91.11000299453735,
Namespace(accum_iter=1, adapter=0, adaptive_margin=0.0, bitfit=0, bs=32, cache_dir='/projectnb/textconv/cliao25/data', captioner='LLAVA', checkpoint='', d=768, data_dir='/scratch/cliao25', dataset='', ema=0.995, eval_only=0, ice=True, ice_k=5, ice_lambda=0.08, init_lam=0.0, iters_per_epoch=750, label_smoothing=0.0, layer_start_t=9, layer_start_v=9, lora=0, loss='ce', lr=2e-05, lr_decay=0.0, maple=0, margin=0.0, modelname='ViT-L-14', n_descriptors=-1, n_epochs=1, optimizer='sgd', pretrained='datacomp_xl_s13b_b90k', prompt_lr_multi=10.0, rank=4, resblock_adapter=0, samples_per_class=1, save_model=0, seed=1, shallow_prompt_init='a photo of', shots=16, skip_ema_iters=0, ssf=0, subsample_classes='all', temp=60.0, text_prompt_depth=0, text_prompt_length=0, train_text_encoder=0, train_visual_encoder=0, use_all_logits=False, use_fixed_lambda=False, v=3, visual_prompt_depth=0, visual_prompt_length=0, wd=1e-05)
EVALUATING ON DATASET:  ImageNet
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/imagenet/shot_16-seed_1.pkl
ImageNet has 50000 test samples
loaded image features from cache/image_features.y_truth.ImageNetViT-L-14datacomp_xl_s13b_b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  79.00199890136719
EVALUATING ON DATASET:  Caltech101
Reading split from /scratch/cliao25/caltech-101/split_zhou_Caltech101.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/caltech-101/shot_16-seed_1.pkl
Caltech101 has 2465 test samples
loaded image features from cache/image_features.y_truth.Caltech101ViT-L-14datacomp_xl_s13b_b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  97.68762588500977
EVALUATING ON DATASET:  OxfordPets
Reading split from /scratch/cliao25/oxford_pets/split_zhou_OxfordPets.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/oxford_pets/shot_16-seed_1.pkl
OxfordPets has 3669 test samples
loaded image features from cache/image_features.y_truth.OxfordPetsViT-L-14datacomp_xl_s13b_b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  95.25756239891052
EVALUATING ON DATASET:  StanfordCars
Reading split from /scratch/cliao25/stanford_cars/split_zhou_StanfordCars.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/stanford_cars/shot_16-seed_1.pkl
StanfordCars has 8041 test samples
loaded image features from cache/image_features.y_truth.StanfordCarsViT-L-14datacomp_xl_s13b_b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  93.28442215919495
EVALUATING ON DATASET:  Flowers102
Reading split from /scratch/cliao25/oxford_flowers/split_zhou_OxfordFlowers.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/oxford_flowers/shot_16-seed_1.pkl
Flowers102 has 2463 test samples
loaded image features from cache/image_features.y_truth.Flowers102ViT-L-14datacomp_xl_s13b_b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  83.47544074058533
EVALUATING ON DATASET:  Food101
Reading split from /scratch/cliao25/food-101/split_zhou_Food101.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/food-101/shot_16-seed_1.pkl
Food101 has 30300 test samples
loaded image features from cache/image_features.y_truth.Food101ViT-L-14datacomp_xl_s13b_b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  92.30033159255981
EVALUATING ON DATASET:  FGVCAircraft
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/fgvc_aircraft/shot_16-seed_1.pkl
FGVCAircraft has 3333 test samples
loaded image features from cache/image_features.y_truth.FGVCAircraftViT-L-14datacomp_xl_s13b_b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  47.10470736026764
EVALUATING ON DATASET:  SUN397
Reading split from /scratch/cliao25/sun397/split_zhou_SUN397.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/sun397/shot_16-seed_1.pkl
SUN397 has 19850 test samples
loaded image features from cache/image_features.y_truth.SUN397ViT-L-14datacomp_xl_s13b_b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  74.79093074798584
EVALUATING ON DATASET:  DTD
Reading split from /scratch/cliao25/dtd/split_zhou_DescribableTextures.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/dtd/shot_16-seed_1.pkl
DTD has 1692 test samples
loaded image features from cache/image_features.y_truth.DTDViT-L-14datacomp_xl_s13b_b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  64.77541327476501
EVALUATING ON DATASET:  EuroSAT
Reading split from /scratch/cliao25/eurosat/split_zhou_EuroSAT.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/eurosat/shot_16-seed_1.pkl
EuroSAT has 8100 test samples
loaded image features from cache/image_features.y_truth.EuroSATViT-L-14datacomp_xl_s13b_b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  67.39506125450134
EVALUATING ON DATASET:  UCF101
Reading split from /scratch/cliao25/ucf101/split_zhou_UCF101.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/ucf101/shot_16-seed_1.pkl
UCF101 has 3783 test samples
loaded image features from cache/image_features.y_truth.UCF101ViT-L-14datacomp_xl_s13b_b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  75.17842650413513
EVALUATING ON DATASET:  ImageNetV2
ImageNetV2 has 10000 test samples
loaded image features from cache/image_features.y_truth.ImageNetV2ViT-L-14datacomp_xl_s13b_b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  72.079998254776
EVALUATING ON DATASET:  ImageNetSketch
ImageNetSketch has 50889 test samples
loaded image features from cache/image_features.y_truth.ImageNetSketchViT-L-14datacomp_xl_s13b_b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  67.25225448608398
EVALUATING ON DATASET:  ImageNetA
ImageNetA has 7500 test samples
loaded image features from cache/image_features.y_truth.ImageNetAViT-L-14datacomp_xl_s13b_b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  69.80000138282776
EVALUATING ON DATASET:  ImageNetR
ImageNetR has 30000 test samples
loaded image features from cache/image_features.y_truth.ImageNetRViT-L-14datacomp_xl_s13b_b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  90.7633364200592
Results:
,ImageNet,Caltech101,OxfordPets,StanfordCars,Flowers102,Food101,FGVCAircraft,SUN397,DTD,EuroSAT,UCF101,ImageNetV2,ImageNetSketch,ImageNetA,ImageNetR,
ViT-L-14 datacomp_xl_s13b_b90k LLAVA ZS,79.00199890136719,97.68762588500977,95.25756239891052,93.28442215919495,83.47544074058533,92.30033159255981,47.10470736026764,74.79093074798584,64.77541327476501,67.39506125450134,75.17842650413513,72.079998254776,67.25225448608398,69.80000138282776,90.7633364200592,
Namespace(accum_iter=1, adapter=0, adaptive_margin=0.0, bitfit=0, bs=32, cache_dir='/projectnb/textconv/cliao25/data', captioner='COCA', checkpoint='', d=768, data_dir='/scratch/cliao25', dataset='', ema=0.995, eval_only=0, ice=True, ice_k=5, ice_lambda=0.08, init_lam=0.0, iters_per_epoch=750, label_smoothing=0.0, layer_start_t=9, layer_start_v=9, lora=0, loss='ce', lr=2e-05, lr_decay=0.0, maple=0, margin=0.0, modelname='ViT-L-14-CLIPA', n_descriptors=-1, n_epochs=1, optimizer='sgd', pretrained='datacomp1b', prompt_lr_multi=10.0, rank=4, resblock_adapter=0, samples_per_class=1, save_model=0, seed=1, shallow_prompt_init='a photo of', shots=16, skip_ema_iters=0, ssf=0, subsample_classes='all', temp=60.0, text_prompt_depth=0, text_prompt_length=0, train_text_encoder=0, train_visual_encoder=0, use_all_logits=False, use_fixed_lambda=False, v=3, visual_prompt_depth=0, visual_prompt_length=0, wd=1e-05)
EVALUATING ON DATASET:  ImageNet
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/imagenet/shot_16-seed_1.pkl
ImageNet has 50000 test samples
loaded image features from cache/image_features.y_truth.ImageNetViT-L-14-CLIPAdatacomp1b.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  78.25599908828735
EVALUATING ON DATASET:  Caltech101
Reading split from /scratch/cliao25/caltech-101/split_zhou_Caltech101.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/caltech-101/shot_16-seed_1.pkl
Caltech101 has 2465 test samples
loaded image features from cache/image_features.y_truth.Caltech101ViT-L-14-CLIPAdatacomp1b.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  97.40365147590637
EVALUATING ON DATASET:  OxfordPets
Reading split from /scratch/cliao25/oxford_pets/split_zhou_OxfordPets.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/oxford_pets/shot_16-seed_1.pkl
OxfordPets has 3669 test samples
loaded image features from cache/image_features.y_truth.OxfordPetsViT-L-14-CLIPAdatacomp1b.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  93.40419173240662
EVALUATING ON DATASET:  StanfordCars
Reading split from /scratch/cliao25/stanford_cars/split_zhou_StanfordCars.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/stanford_cars/shot_16-seed_1.pkl
StanfordCars has 8041 test samples
loaded image features from cache/image_features.y_truth.StanfordCarsViT-L-14-CLIPAdatacomp1b.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  92.42631793022156
EVALUATING ON DATASET:  Flowers102
Reading split from /scratch/cliao25/oxford_flowers/split_zhou_OxfordFlowers.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/oxford_flowers/shot_16-seed_1.pkl
Flowers102 has 2463 test samples
loaded image features from cache/image_features.y_truth.Flowers102ViT-L-14-CLIPAdatacomp1b.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  80.30856847763062
EVALUATING ON DATASET:  Food101
Reading split from /scratch/cliao25/food-101/split_zhou_Food101.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/food-101/shot_16-seed_1.pkl
Food101 has 30300 test samples
loaded image features from cache/image_features.y_truth.Food101ViT-L-14-CLIPAdatacomp1b.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  91.90759062767029
EVALUATING ON DATASET:  FGVCAircraft
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/fgvc_aircraft/shot_16-seed_1.pkl
FGVCAircraft has 3333 test samples
loaded image features from cache/image_features.y_truth.FGVCAircraftViT-L-14-CLIPAdatacomp1b.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  43.504348397254944
EVALUATING ON DATASET:  SUN397
Reading split from /scratch/cliao25/sun397/split_zhou_SUN397.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/sun397/shot_16-seed_1.pkl
SUN397 has 19850 test samples
loaded image features from cache/image_features.y_truth.SUN397ViT-L-14-CLIPAdatacomp1b.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  73.15365076065063
EVALUATING ON DATASET:  DTD
Reading split from /scratch/cliao25/dtd/split_zhou_DescribableTextures.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/dtd/shot_16-seed_1.pkl
DTD has 1692 test samples
loaded image features from cache/image_features.y_truth.DTDViT-L-14-CLIPAdatacomp1b.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  61.17021441459656
EVALUATING ON DATASET:  EuroSAT
Reading split from /scratch/cliao25/eurosat/split_zhou_EuroSAT.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/eurosat/shot_16-seed_1.pkl
EuroSAT has 8100 test samples
loaded image features from cache/image_features.y_truth.EuroSATViT-L-14-CLIPAdatacomp1b.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  58.12345743179321
EVALUATING ON DATASET:  UCF101
Reading split from /scratch/cliao25/ucf101/split_zhou_UCF101.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/ucf101/shot_16-seed_1.pkl
UCF101 has 3783 test samples
loaded image features from cache/image_features.y_truth.UCF101ViT-L-14-CLIPAdatacomp1b.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  77.10810899734497
EVALUATING ON DATASET:  ImageNetV2
ImageNetV2 has 10000 test samples
loaded image features from cache/image_features.y_truth.ImageNetV2ViT-L-14-CLIPAdatacomp1b.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  71.42999768257141
EVALUATING ON DATASET:  ImageNetSketch
ImageNetSketch has 50889 test samples
loaded image features from cache/image_features.y_truth.ImageNetSketchViT-L-14-CLIPAdatacomp1b.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  66.40924215316772
EVALUATING ON DATASET:  ImageNetA
ImageNetA has 7500 test samples
loaded image features from cache/image_features.y_truth.ImageNetAViT-L-14-CLIPAdatacomp1b.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  72.29333519935608
EVALUATING ON DATASET:  ImageNetR
ImageNetR has 30000 test samples
loaded image features from cache/image_features.y_truth.ImageNetRViT-L-14-CLIPAdatacomp1b.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  91.42333269119263
Results:
,ImageNet,Caltech101,OxfordPets,StanfordCars,Flowers102,Food101,FGVCAircraft,SUN397,DTD,EuroSAT,UCF101,ImageNetV2,ImageNetSketch,ImageNetA,ImageNetR,
ViT-L-14-CLIPA datacomp1b COCA ZS,78.25599908828735,97.40365147590637,93.40419173240662,92.42631793022156,80.30856847763062,91.90759062767029,43.504348397254944,73.15365076065063,61.17021441459656,58.12345743179321,77.10810899734497,71.42999768257141,66.40924215316772,72.29333519935608,91.42333269119263,
Namespace(accum_iter=1, adapter=0, adaptive_margin=0.0, bitfit=0, bs=32, cache_dir='/projectnb/textconv/cliao25/data', captioner='BLIP', checkpoint='', d=768, data_dir='/scratch/cliao25', dataset='', ema=0.995, eval_only=0, ice=True, ice_k=5, ice_lambda=0.08, init_lam=0.0, iters_per_epoch=750, label_smoothing=0.0, layer_start_t=9, layer_start_v=9, lora=0, loss='ce', lr=2e-05, lr_decay=0.0, maple=0, margin=0.0, modelname='ViT-L-14-CLIPA', n_descriptors=-1, n_epochs=1, optimizer='sgd', pretrained='datacomp1b', prompt_lr_multi=10.0, rank=4, resblock_adapter=0, samples_per_class=1, save_model=0, seed=1, shallow_prompt_init='a photo of', shots=16, skip_ema_iters=0, ssf=0, subsample_classes='all', temp=60.0, text_prompt_depth=0, text_prompt_length=0, train_text_encoder=0, train_visual_encoder=0, use_all_logits=False, use_fixed_lambda=False, v=3, visual_prompt_depth=0, visual_prompt_length=0, wd=1e-05)
EVALUATING ON DATASET:  ImageNet
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/imagenet/shot_16-seed_1.pkl
ImageNet has 50000 test samples
loaded image features from cache/image_features.y_truth.ImageNetViT-L-14-CLIPAdatacomp1b.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  77.6919960975647
EVALUATING ON DATASET:  Caltech101
Reading split from /scratch/cliao25/caltech-101/split_zhou_Caltech101.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/caltech-101/shot_16-seed_1.pkl
Caltech101 has 2465 test samples
loaded image features from cache/image_features.y_truth.Caltech101ViT-L-14-CLIPAdatacomp1b.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  97.4442183971405
EVALUATING ON DATASET:  OxfordPets
Reading split from /scratch/cliao25/oxford_pets/split_zhou_OxfordPets.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/oxford_pets/shot_16-seed_1.pkl
OxfordPets has 3669 test samples
loaded image features from cache/image_features.y_truth.OxfordPetsViT-L-14-CLIPAdatacomp1b.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  93.32242608070374
EVALUATING ON DATASET:  StanfordCars
Reading split from /scratch/cliao25/stanford_cars/split_zhou_StanfordCars.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/stanford_cars/shot_16-seed_1.pkl
StanfordCars has 8041 test samples
loaded image features from cache/image_features.y_truth.StanfordCarsViT-L-14-CLIPAdatacomp1b.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  92.22733974456787
EVALUATING ON DATASET:  Flowers102
Reading split from /scratch/cliao25/oxford_flowers/split_zhou_OxfordFlowers.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/oxford_flowers/shot_16-seed_1.pkl
Flowers102 has 2463 test samples
loaded image features from cache/image_features.y_truth.Flowers102ViT-L-14-CLIPAdatacomp1b.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  79.74015474319458
EVALUATING ON DATASET:  Food101
Reading split from /scratch/cliao25/food-101/split_zhou_Food101.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/food-101/shot_16-seed_1.pkl
Food101 has 30300 test samples
loaded image features from cache/image_features.y_truth.Food101ViT-L-14-CLIPAdatacomp1b.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  91.89438819885254
EVALUATING ON DATASET:  FGVCAircraft
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/fgvc_aircraft/shot_16-seed_1.pkl
FGVCAircraft has 3333 test samples
loaded image features from cache/image_features.y_truth.FGVCAircraftViT-L-14-CLIPAdatacomp1b.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  42.424240708351135
EVALUATING ON DATASET:  SUN397
Reading split from /scratch/cliao25/sun397/split_zhou_SUN397.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/sun397/shot_16-seed_1.pkl
SUN397 has 19850 test samples
loaded image features from cache/image_features.y_truth.SUN397ViT-L-14-CLIPAdatacomp1b.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  72.58941531181335
EVALUATING ON DATASET:  DTD
Reading split from /scratch/cliao25/dtd/split_zhou_DescribableTextures.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/dtd/shot_16-seed_1.pkl
DTD has 1692 test samples
loaded image features from cache/image_features.y_truth.DTDViT-L-14-CLIPAdatacomp1b.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  60.81560254096985
EVALUATING ON DATASET:  EuroSAT
Reading split from /scratch/cliao25/eurosat/split_zhou_EuroSAT.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/eurosat/shot_16-seed_1.pkl
EuroSAT has 8100 test samples
loaded image features from cache/image_features.y_truth.EuroSATViT-L-14-CLIPAdatacomp1b.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  56.654322147369385
EVALUATING ON DATASET:  UCF101
Reading split from /scratch/cliao25/ucf101/split_zhou_UCF101.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/ucf101/shot_16-seed_1.pkl
UCF101 has 3783 test samples
loaded image features from cache/image_features.y_truth.UCF101ViT-L-14-CLIPAdatacomp1b.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  77.34602093696594
EVALUATING ON DATASET:  ImageNetV2
ImageNetV2 has 10000 test samples
loaded image features from cache/image_features.y_truth.ImageNetV2ViT-L-14-CLIPAdatacomp1b.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  71.11999988555908
EVALUATING ON DATASET:  ImageNetSketch
ImageNetSketch has 50889 test samples
loaded image features from cache/image_features.y_truth.ImageNetSketchViT-L-14-CLIPAdatacomp1b.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  66.16753935813904
EVALUATING ON DATASET:  ImageNetA
ImageNetA has 7500 test samples
loaded image features from cache/image_features.y_truth.ImageNetAViT-L-14-CLIPAdatacomp1b.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  72.680002450943
EVALUATING ON DATASET:  ImageNetR
ImageNetR has 30000 test samples
loaded image features from cache/image_features.y_truth.ImageNetRViT-L-14-CLIPAdatacomp1b.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  91.54999852180481
Results:
,ImageNet,Caltech101,OxfordPets,StanfordCars,Flowers102,Food101,FGVCAircraft,SUN397,DTD,EuroSAT,UCF101,ImageNetV2,ImageNetSketch,ImageNetA,ImageNetR,
ViT-L-14-CLIPA datacomp1b BLIP ZS,77.6919960975647,97.4442183971405,93.32242608070374,92.22733974456787,79.74015474319458,91.89438819885254,42.424240708351135,72.58941531181335,60.81560254096985,56.654322147369385,77.34602093696594,71.11999988555908,66.16753935813904,72.680002450943,91.54999852180481,
Namespace(accum_iter=1, adapter=0, adaptive_margin=0.0, bitfit=0, bs=32, cache_dir='/projectnb/textconv/cliao25/data', captioner='LLAVA', checkpoint='', d=768, data_dir='/scratch/cliao25', dataset='', ema=0.995, eval_only=0, ice=True, ice_k=5, ice_lambda=0.08, init_lam=0.0, iters_per_epoch=750, label_smoothing=0.0, layer_start_t=9, layer_start_v=9, lora=0, loss='ce', lr=2e-05, lr_decay=0.0, maple=0, margin=0.0, modelname='ViT-L-14-CLIPA', n_descriptors=-1, n_epochs=1, optimizer='sgd', pretrained='datacomp1b', prompt_lr_multi=10.0, rank=4, resblock_adapter=0, samples_per_class=1, save_model=0, seed=1, shallow_prompt_init='a photo of', shots=16, skip_ema_iters=0, ssf=0, subsample_classes='all', temp=60.0, text_prompt_depth=0, text_prompt_length=0, train_text_encoder=0, train_visual_encoder=0, use_all_logits=False, use_fixed_lambda=False, v=3, visual_prompt_depth=0, visual_prompt_length=0, wd=1e-05)
EVALUATING ON DATASET:  ImageNet
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/imagenet/shot_16-seed_1.pkl
ImageNet has 50000 test samples
loaded image features from cache/image_features.y_truth.ImageNetViT-L-14-CLIPAdatacomp1b.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  78.05999517440796
EVALUATING ON DATASET:  Caltech101
Reading split from /scratch/cliao25/caltech-101/split_zhou_Caltech101.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/caltech-101/shot_16-seed_1.pkl
Caltech101 has 2465 test samples
loaded image features from cache/image_features.y_truth.Caltech101ViT-L-14-CLIPAdatacomp1b.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  97.68762588500977
EVALUATING ON DATASET:  OxfordPets
Reading split from /scratch/cliao25/oxford_pets/split_zhou_OxfordPets.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/oxford_pets/shot_16-seed_1.pkl
OxfordPets has 3669 test samples
loaded image features from cache/image_features.y_truth.OxfordPetsViT-L-14-CLIPAdatacomp1b.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  93.24066042900085
EVALUATING ON DATASET:  StanfordCars
Reading split from /scratch/cliao25/stanford_cars/split_zhou_StanfordCars.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/stanford_cars/shot_16-seed_1.pkl
StanfordCars has 8041 test samples
loaded image features from cache/image_features.y_truth.StanfordCarsViT-L-14-CLIPAdatacomp1b.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  92.53824353218079
EVALUATING ON DATASET:  Flowers102
Reading split from /scratch/cliao25/oxford_flowers/split_zhou_OxfordFlowers.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/oxford_flowers/shot_16-seed_1.pkl
Flowers102 has 2463 test samples
loaded image features from cache/image_features.y_truth.Flowers102ViT-L-14-CLIPAdatacomp1b.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  79.82136011123657
EVALUATING ON DATASET:  Food101
Reading split from /scratch/cliao25/food-101/split_zhou_Food101.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/food-101/shot_16-seed_1.pkl
Food101 has 30300 test samples
loaded image features from cache/image_features.y_truth.Food101ViT-L-14-CLIPAdatacomp1b.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  91.89438819885254
EVALUATING ON DATASET:  FGVCAircraft
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/fgvc_aircraft/shot_16-seed_1.pkl
FGVCAircraft has 3333 test samples
loaded image features from cache/image_features.y_truth.FGVCAircraftViT-L-14-CLIPAdatacomp1b.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  42.27422475814819
EVALUATING ON DATASET:  SUN397
Reading split from /scratch/cliao25/sun397/split_zhou_SUN397.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/sun397/shot_16-seed_1.pkl
SUN397 has 19850 test samples
loaded image features from cache/image_features.y_truth.SUN397ViT-L-14-CLIPAdatacomp1b.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  73.32493662834167
EVALUATING ON DATASET:  DTD
Reading split from /scratch/cliao25/dtd/split_zhou_DescribableTextures.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/dtd/shot_16-seed_1.pkl
DTD has 1692 test samples
loaded image features from cache/image_features.y_truth.DTDViT-L-14-CLIPAdatacomp1b.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  60.81560254096985
EVALUATING ON DATASET:  EuroSAT
Reading split from /scratch/cliao25/eurosat/split_zhou_EuroSAT.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/eurosat/shot_16-seed_1.pkl
EuroSAT has 8100 test samples
loaded image features from cache/image_features.y_truth.EuroSATViT-L-14-CLIPAdatacomp1b.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  58.14814567565918
EVALUATING ON DATASET:  UCF101
Reading split from /scratch/cliao25/ucf101/split_zhou_UCF101.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/ucf101/shot_16-seed_1.pkl
UCF101 has 3783 test samples
loaded image features from cache/image_features.y_truth.UCF101ViT-L-14-CLIPAdatacomp1b.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  76.63229703903198
EVALUATING ON DATASET:  ImageNetV2
ImageNetV2 has 10000 test samples
loaded image features from cache/image_features.y_truth.ImageNetV2ViT-L-14-CLIPAdatacomp1b.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  71.5499997138977
EVALUATING ON DATASET:  ImageNetSketch
ImageNetSketch has 50889 test samples
loaded image features from cache/image_features.y_truth.ImageNetSketchViT-L-14-CLIPAdatacomp1b.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  66.15771651268005
EVALUATING ON DATASET:  ImageNetA
ImageNetA has 7500 test samples
loaded image features from cache/image_features.y_truth.ImageNetAViT-L-14-CLIPAdatacomp1b.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  72.57333397865295
EVALUATING ON DATASET:  ImageNetR
ImageNetR has 30000 test samples
loaded image features from cache/image_features.y_truth.ImageNetRViT-L-14-CLIPAdatacomp1b.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  91.37666821479797
Results:
,ImageNet,Caltech101,OxfordPets,StanfordCars,Flowers102,Food101,FGVCAircraft,SUN397,DTD,EuroSAT,UCF101,ImageNetV2,ImageNetSketch,ImageNetA,ImageNetR,
ViT-L-14-CLIPA datacomp1b LLAVA ZS,78.05999517440796,97.68762588500977,93.24066042900085,92.53824353218079,79.82136011123657,91.89438819885254,42.27422475814819,73.32493662834167,60.81560254096985,58.14814567565918,76.63229703903198,71.5499997138977,66.15771651268005,72.57333397865295,91.37666821479797,
Namespace(accum_iter=1, adapter=0, adaptive_margin=0.0, bitfit=0, bs=32, cache_dir='/projectnb/textconv/cliao25/data', captioner='COCA', checkpoint='', d=1024, data_dir='/scratch/cliao25', dataset='', ema=0.995, eval_only=0, ice=True, ice_k=5, ice_lambda=0.08, init_lam=0.0, iters_per_epoch=750, label_smoothing=0.0, layer_start_t=9, layer_start_v=9, lora=0, loss='ce', lr=2e-05, lr_decay=0.0, maple=0, margin=0.0, modelname='ViT-H-14-CLIPA', n_descriptors=-1, n_epochs=1, optimizer='sgd', pretrained='datacomp1b', prompt_lr_multi=10.0, rank=4, resblock_adapter=0, samples_per_class=1, save_model=0, seed=1, shallow_prompt_init='a photo of', shots=16, skip_ema_iters=0, ssf=0, subsample_classes='all', temp=60.0, text_prompt_depth=0, text_prompt_length=0, train_text_encoder=0, train_visual_encoder=0, use_all_logits=False, use_fixed_lambda=False, v=3, visual_prompt_depth=0, visual_prompt_length=0, wd=1e-05)
EVALUATING ON DATASET:  ImageNet
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/imagenet/shot_16-seed_1.pkl
ImageNet has 50000 test samples
loaded image features from cache/image_features.y_truth.ImageNetViT-H-14-CLIPAdatacomp1b.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  79.86199855804443
EVALUATING ON DATASET:  Caltech101
Reading split from /scratch/cliao25/caltech-101/split_zhou_Caltech101.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/caltech-101/shot_16-seed_1.pkl
Caltech101 has 2465 test samples
loaded image features from cache/image_features.y_truth.Caltech101ViT-H-14-CLIPAdatacomp1b.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  97.56592512130737
EVALUATING ON DATASET:  OxfordPets
Reading split from /scratch/cliao25/oxford_pets/split_zhou_OxfordPets.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/oxford_pets/shot_16-seed_1.pkl
OxfordPets has 3669 test samples
loaded image features from cache/image_features.y_truth.OxfordPetsViT-H-14-CLIPAdatacomp1b.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  95.63913345336914
EVALUATING ON DATASET:  StanfordCars
Reading split from /scratch/cliao25/stanford_cars/split_zhou_StanfordCars.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/stanford_cars/shot_16-seed_1.pkl
StanfordCars has 8041 test samples
loaded image features from cache/image_features.y_truth.StanfordCarsViT-H-14-CLIPAdatacomp1b.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  94.17983293533325
EVALUATING ON DATASET:  Flowers102
Reading split from /scratch/cliao25/oxford_flowers/split_zhou_OxfordFlowers.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/oxford_flowers/shot_16-seed_1.pkl
Flowers102 has 2463 test samples
loaded image features from cache/image_features.y_truth.Flowers102ViT-H-14-CLIPAdatacomp1b.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  84.4092607498169
EVALUATING ON DATASET:  Food101
Reading split from /scratch/cliao25/food-101/split_zhou_Food101.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/food-101/shot_16-seed_1.pkl
Food101 has 30300 test samples
loaded image features from cache/image_features.y_truth.Food101ViT-H-14-CLIPAdatacomp1b.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  93.00990104675293
EVALUATING ON DATASET:  FGVCAircraft
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/fgvc_aircraft/shot_16-seed_1.pkl
FGVCAircraft has 3333 test samples
loaded image features from cache/image_features.y_truth.FGVCAircraftViT-H-14-CLIPAdatacomp1b.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  47.37473428249359
EVALUATING ON DATASET:  SUN397
Reading split from /scratch/cliao25/sun397/split_zhou_SUN397.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/sun397/shot_16-seed_1.pkl
SUN397 has 19850 test samples
loaded image features from cache/image_features.y_truth.SUN397ViT-H-14-CLIPAdatacomp1b.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  74.20654892921448
EVALUATING ON DATASET:  DTD
Reading split from /scratch/cliao25/dtd/split_zhou_DescribableTextures.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/dtd/shot_16-seed_1.pkl
DTD has 1692 test samples
loaded image features from cache/image_features.y_truth.DTDViT-H-14-CLIPAdatacomp1b.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  65.89834690093994
EVALUATING ON DATASET:  EuroSAT
Reading split from /scratch/cliao25/eurosat/split_zhou_EuroSAT.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/eurosat/shot_16-seed_1.pkl
EuroSAT has 8100 test samples
loaded image features from cache/image_features.y_truth.EuroSATViT-H-14-CLIPAdatacomp1b.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  60.09876728057861
EVALUATING ON DATASET:  UCF101
Reading split from /scratch/cliao25/ucf101/split_zhou_UCF101.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/ucf101/shot_16-seed_1.pkl
UCF101 has 3783 test samples
loaded image features from cache/image_features.y_truth.UCF101ViT-H-14-CLIPAdatacomp1b.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  79.67221140861511
EVALUATING ON DATASET:  ImageNetV2
ImageNetV2 has 10000 test samples
loaded image features from cache/image_features.y_truth.ImageNetV2ViT-H-14-CLIPAdatacomp1b.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  73.46999645233154
EVALUATING ON DATASET:  ImageNetSketch
ImageNetSketch has 50889 test samples
loaded image features from cache/image_features.y_truth.ImageNetSketchViT-H-14-CLIPAdatacomp1b.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  69.2998468875885
EVALUATING ON DATASET:  ImageNetA
ImageNetA has 7500 test samples
loaded image features from cache/image_features.y_truth.ImageNetAViT-H-14-CLIPAdatacomp1b.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  76.26667022705078
EVALUATING ON DATASET:  ImageNetR
ImageNetR has 30000 test samples
loaded image features from cache/image_features.y_truth.ImageNetRViT-H-14-CLIPAdatacomp1b.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  92.1833336353302
Results:
,ImageNet,Caltech101,OxfordPets,StanfordCars,Flowers102,Food101,FGVCAircraft,SUN397,DTD,EuroSAT,UCF101,ImageNetV2,ImageNetSketch,ImageNetA,ImageNetR,
ViT-H-14-CLIPA datacomp1b COCA ZS,79.86199855804443,97.56592512130737,95.63913345336914,94.17983293533325,84.4092607498169,93.00990104675293,47.37473428249359,74.20654892921448,65.89834690093994,60.09876728057861,79.67221140861511,73.46999645233154,69.2998468875885,76.26667022705078,92.1833336353302,
Namespace(accum_iter=1, adapter=0, adaptive_margin=0.0, bitfit=0, bs=32, cache_dir='/projectnb/textconv/cliao25/data', captioner='BLIP', checkpoint='', d=1024, data_dir='/scratch/cliao25', dataset='', ema=0.995, eval_only=0, ice=True, ice_k=5, ice_lambda=0.08, init_lam=0.0, iters_per_epoch=750, label_smoothing=0.0, layer_start_t=9, layer_start_v=9, lora=0, loss='ce', lr=2e-05, lr_decay=0.0, maple=0, margin=0.0, modelname='ViT-H-14-CLIPA', n_descriptors=-1, n_epochs=1, optimizer='sgd', pretrained='datacomp1b', prompt_lr_multi=10.0, rank=4, resblock_adapter=0, samples_per_class=1, save_model=0, seed=1, shallow_prompt_init='a photo of', shots=16, skip_ema_iters=0, ssf=0, subsample_classes='all', temp=60.0, text_prompt_depth=0, text_prompt_length=0, train_text_encoder=0, train_visual_encoder=0, use_all_logits=False, use_fixed_lambda=False, v=3, visual_prompt_depth=0, visual_prompt_length=0, wd=1e-05)
EVALUATING ON DATASET:  ImageNet
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/imagenet/shot_16-seed_1.pkl
ImageNet has 50000 test samples
loaded image features from cache/image_features.y_truth.ImageNetViT-H-14-CLIPAdatacomp1b.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  79.67000007629395
EVALUATING ON DATASET:  Caltech101
Reading split from /scratch/cliao25/caltech-101/split_zhou_Caltech101.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/caltech-101/shot_16-seed_1.pkl
Caltech101 has 2465 test samples
loaded image features from cache/image_features.y_truth.Caltech101ViT-H-14-CLIPAdatacomp1b.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  97.52535820007324
EVALUATING ON DATASET:  OxfordPets
Reading split from /scratch/cliao25/oxford_pets/split_zhou_OxfordPets.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/oxford_pets/shot_16-seed_1.pkl
OxfordPets has 3669 test samples
loaded image features from cache/image_features.y_truth.OxfordPetsViT-H-14-CLIPAdatacomp1b.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  95.31207084655762
EVALUATING ON DATASET:  StanfordCars
Reading split from /scratch/cliao25/stanford_cars/split_zhou_StanfordCars.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/stanford_cars/shot_16-seed_1.pkl
StanfordCars has 8041 test samples
loaded image features from cache/image_features.y_truth.StanfordCarsViT-H-14-CLIPAdatacomp1b.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  94.01816129684448
EVALUATING ON DATASET:  Flowers102
Reading split from /scratch/cliao25/oxford_flowers/split_zhou_OxfordFlowers.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/oxford_flowers/shot_16-seed_1.pkl
Flowers102 has 2463 test samples
loaded image features from cache/image_features.y_truth.Flowers102ViT-H-14-CLIPAdatacomp1b.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  84.1656506061554
EVALUATING ON DATASET:  Food101
Reading split from /scratch/cliao25/food-101/split_zhou_Food101.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/food-101/shot_16-seed_1.pkl
Food101 has 30300 test samples
loaded image features from cache/image_features.y_truth.Food101ViT-H-14-CLIPAdatacomp1b.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  93.01980137825012
EVALUATING ON DATASET:  FGVCAircraft
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/fgvc_aircraft/shot_16-seed_1.pkl
FGVCAircraft has 3333 test samples
loaded image features from cache/image_features.y_truth.FGVCAircraftViT-H-14-CLIPAdatacomp1b.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  46.62466049194336
EVALUATING ON DATASET:  SUN397
Reading split from /scratch/cliao25/sun397/split_zhou_SUN397.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/sun397/shot_16-seed_1.pkl
SUN397 has 19850 test samples
loaded image features from cache/image_features.y_truth.SUN397ViT-H-14-CLIPAdatacomp1b.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  73.97480607032776
EVALUATING ON DATASET:  DTD
Reading split from /scratch/cliao25/dtd/split_zhou_DescribableTextures.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/dtd/shot_16-seed_1.pkl
DTD has 1692 test samples
loaded image features from cache/image_features.y_truth.DTDViT-H-14-CLIPAdatacomp1b.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  65.78013896942139
EVALUATING ON DATASET:  EuroSAT
Reading split from /scratch/cliao25/eurosat/split_zhou_EuroSAT.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/eurosat/shot_16-seed_1.pkl
EuroSAT has 8100 test samples
loaded image features from cache/image_features.y_truth.EuroSATViT-H-14-CLIPAdatacomp1b.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  60.02469062805176
EVALUATING ON DATASET:  UCF101
Reading split from /scratch/cliao25/ucf101/split_zhou_UCF101.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/ucf101/shot_16-seed_1.pkl
UCF101 has 3783 test samples
loaded image features from cache/image_features.y_truth.UCF101ViT-H-14-CLIPAdatacomp1b.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  79.83081936836243
EVALUATING ON DATASET:  ImageNetV2
ImageNetV2 has 10000 test samples
loaded image features from cache/image_features.y_truth.ImageNetV2ViT-H-14-CLIPAdatacomp1b.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  73.50999712944031
EVALUATING ON DATASET:  ImageNetSketch
ImageNetSketch has 50889 test samples
loaded image features from cache/image_features.y_truth.ImageNetSketchViT-H-14-CLIPAdatacomp1b.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  69.30770874023438
EVALUATING ON DATASET:  ImageNetA
ImageNetA has 7500 test samples
loaded image features from cache/image_features.y_truth.ImageNetAViT-H-14-CLIPAdatacomp1b.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  77.18666791915894
EVALUATING ON DATASET:  ImageNetR
ImageNetR has 30000 test samples
loaded image features from cache/image_features.y_truth.ImageNetRViT-H-14-CLIPAdatacomp1b.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  92.42666959762573
Results:
,ImageNet,Caltech101,OxfordPets,StanfordCars,Flowers102,Food101,FGVCAircraft,SUN397,DTD,EuroSAT,UCF101,ImageNetV2,ImageNetSketch,ImageNetA,ImageNetR,
ViT-H-14-CLIPA datacomp1b BLIP ZS,79.67000007629395,97.52535820007324,95.31207084655762,94.01816129684448,84.1656506061554,93.01980137825012,46.62466049194336,73.97480607032776,65.78013896942139,60.02469062805176,79.83081936836243,73.50999712944031,69.30770874023438,77.18666791915894,92.42666959762573,
Namespace(accum_iter=1, adapter=0, adaptive_margin=0.0, bitfit=0, bs=32, cache_dir='/projectnb/textconv/cliao25/data', captioner='LLAVA', checkpoint='', d=1024, data_dir='/scratch/cliao25', dataset='', ema=0.995, eval_only=0, ice=True, ice_k=5, ice_lambda=0.08, init_lam=0.0, iters_per_epoch=750, label_smoothing=0.0, layer_start_t=9, layer_start_v=9, lora=0, loss='ce', lr=2e-05, lr_decay=0.0, maple=0, margin=0.0, modelname='ViT-H-14-CLIPA', n_descriptors=-1, n_epochs=1, optimizer='sgd', pretrained='datacomp1b', prompt_lr_multi=10.0, rank=4, resblock_adapter=0, samples_per_class=1, save_model=0, seed=1, shallow_prompt_init='a photo of', shots=16, skip_ema_iters=0, ssf=0, subsample_classes='all', temp=60.0, text_prompt_depth=0, text_prompt_length=0, train_text_encoder=0, train_visual_encoder=0, use_all_logits=False, use_fixed_lambda=False, v=3, visual_prompt_depth=0, visual_prompt_length=0, wd=1e-05)
EVALUATING ON DATASET:  ImageNet
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/imagenet/shot_16-seed_1.pkl
ImageNet has 50000 test samples
loaded image features from cache/image_features.y_truth.ImageNetViT-H-14-CLIPAdatacomp1b.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  79.67399954795837
EVALUATING ON DATASET:  Caltech101
Reading split from /scratch/cliao25/caltech-101/split_zhou_Caltech101.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/caltech-101/shot_16-seed_1.pkl
Caltech101 has 2465 test samples
loaded image features from cache/image_features.y_truth.Caltech101ViT-H-14-CLIPAdatacomp1b.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  97.7281928062439
EVALUATING ON DATASET:  OxfordPets
Reading split from /scratch/cliao25/oxford_pets/split_zhou_OxfordPets.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/oxford_pets/shot_16-seed_1.pkl
OxfordPets has 3669 test samples
loaded image features from cache/image_features.y_truth.OxfordPetsViT-H-14-CLIPAdatacomp1b.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  95.3938364982605
EVALUATING ON DATASET:  StanfordCars
Reading split from /scratch/cliao25/stanford_cars/split_zhou_StanfordCars.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/stanford_cars/shot_16-seed_1.pkl
StanfordCars has 8041 test samples
loaded image features from cache/image_features.y_truth.StanfordCarsViT-H-14-CLIPAdatacomp1b.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  94.0927803516388
EVALUATING ON DATASET:  Flowers102
Reading split from /scratch/cliao25/oxford_flowers/split_zhou_OxfordFlowers.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/oxford_flowers/shot_16-seed_1.pkl
Flowers102 has 2463 test samples
loaded image features from cache/image_features.y_truth.Flowers102ViT-H-14-CLIPAdatacomp1b.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  83.84084701538086
EVALUATING ON DATASET:  Food101
Reading split from /scratch/cliao25/food-101/split_zhou_Food101.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/food-101/shot_16-seed_1.pkl
Food101 has 30300 test samples
loaded image features from cache/image_features.y_truth.Food101ViT-H-14-CLIPAdatacomp1b.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  93.02310347557068
EVALUATING ON DATASET:  FGVCAircraft
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/fgvc_aircraft/shot_16-seed_1.pkl
FGVCAircraft has 3333 test samples
loaded image features from cache/image_features.y_truth.FGVCAircraftViT-H-14-CLIPAdatacomp1b.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  46.2346225976944
EVALUATING ON DATASET:  SUN397
Reading split from /scratch/cliao25/sun397/split_zhou_SUN397.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/sun397/shot_16-seed_1.pkl
SUN397 has 19850 test samples
loaded image features from cache/image_features.y_truth.SUN397ViT-H-14-CLIPAdatacomp1b.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  74.53904151916504
EVALUATING ON DATASET:  DTD
Reading split from /scratch/cliao25/dtd/split_zhou_DescribableTextures.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/dtd/shot_16-seed_1.pkl
DTD has 1692 test samples
loaded image features from cache/image_features.y_truth.DTDViT-H-14-CLIPAdatacomp1b.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  65.30733108520508
EVALUATING ON DATASET:  EuroSAT
Reading split from /scratch/cliao25/eurosat/split_zhou_EuroSAT.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/eurosat/shot_16-seed_1.pkl
EuroSAT has 8100 test samples
loaded image features from cache/image_features.y_truth.EuroSATViT-H-14-CLIPAdatacomp1b.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  61.19753122329712
EVALUATING ON DATASET:  UCF101
Reading split from /scratch/cliao25/ucf101/split_zhou_UCF101.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/ucf101/shot_16-seed_1.pkl
UCF101 has 3783 test samples
loaded image features from cache/image_features.y_truth.UCF101ViT-H-14-CLIPAdatacomp1b.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  79.698646068573
EVALUATING ON DATASET:  ImageNetV2
ImageNetV2 has 10000 test samples
loaded image features from cache/image_features.y_truth.ImageNetV2ViT-H-14-CLIPAdatacomp1b.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  73.40999841690063
EVALUATING ON DATASET:  ImageNetSketch
ImageNetSketch has 50889 test samples
loaded image features from cache/image_features.y_truth.ImageNetSketchViT-H-14-CLIPAdatacomp1b.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  69.103342294693
EVALUATING ON DATASET:  ImageNetA
ImageNetA has 7500 test samples
loaded image features from cache/image_features.y_truth.ImageNetAViT-H-14-CLIPAdatacomp1b.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  76.98667049407959
EVALUATING ON DATASET:  ImageNetR
ImageNetR has 30000 test samples
loaded image features from cache/image_features.y_truth.ImageNetRViT-H-14-CLIPAdatacomp1b.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  92.28000044822693
Results:
,ImageNet,Caltech101,OxfordPets,StanfordCars,Flowers102,Food101,FGVCAircraft,SUN397,DTD,EuroSAT,UCF101,ImageNetV2,ImageNetSketch,ImageNetA,ImageNetR,
ViT-H-14-CLIPA datacomp1b LLAVA ZS,79.67399954795837,97.7281928062439,95.3938364982605,94.0927803516388,83.84084701538086,93.02310347557068,46.2346225976944,74.53904151916504,65.30733108520508,61.19753122329712,79.698646068573,73.40999841690063,69.103342294693,76.98667049407959,92.28000044822693,
