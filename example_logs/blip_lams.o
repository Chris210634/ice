start
Namespace(accum_iter=1, adapter=0, adaptive_margin=0.0, bitfit=0, bs=32, cache_dir='/projectnb/textconv/cliao25/data', captioner='BLIP', checkpoint='', d=768, data_dir='/scratch/cliao25', dataset='', ema=0.995, eval_only=0, ice=True, ice_k=5, ice_lambda=0.0, init_lam=0.0, iters_per_epoch=750, label_smoothing=0.0, layer_start_t=9, layer_start_v=9, lora=0, loss='ce', lr=2e-05, lr_decay=0.0, maple=0, margin=0.0, modelname='coca_ViT-L-14', n_descriptors=-1, n_epochs=1, optimizer='sgd', pretrained='laion2B-s13B-b90k', prompt_lr_multi=10.0, rank=4, resblock_adapter=0, samples_per_class=1, save_model=0, seed=1, shallow_prompt_init='a photo of', shots=16, skip_ema_iters=0, ssf=0, subsample_classes='all', temp=60.0, text_prompt_depth=0, text_prompt_length=0, train_text_encoder=0, train_visual_encoder=0, use_all_logits=False, use_fixed_lambda=False, v=3, visual_prompt_depth=0, visual_prompt_length=0, wd=1e-05)
EVALUATING ON DATASET:  ImageNet
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/imagenet/shot_16-seed_1.pkl
ImageNet has 50000 test samples
loaded image features from cache/image_features.y_truth.ImageNetcoca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  75.02999901771545
EVALUATING ON DATASET:  Caltech101
Reading split from /scratch/cliao25/caltech-101/split_zhou_Caltech101.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/caltech-101/shot_16-seed_1.pkl
Caltech101 has 2465 test samples
loaded image features from cache/image_features.y_truth.Caltech101coca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  97.32251763343811
EVALUATING ON DATASET:  OxfordPets
Reading split from /scratch/cliao25/oxford_pets/split_zhou_OxfordPets.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/oxford_pets/shot_16-seed_1.pkl
OxfordPets has 3669 test samples
loaded image features from cache/image_features.y_truth.OxfordPetscoca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  94.08558011054993
EVALUATING ON DATASET:  StanfordCars
Reading split from /scratch/cliao25/stanford_cars/split_zhou_StanfordCars.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/stanford_cars/shot_16-seed_1.pkl
StanfordCars has 8041 test samples
loaded image features from cache/image_features.y_truth.StanfordCarscoca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  92.63773560523987
EVALUATING ON DATASET:  Flowers102
Reading split from /scratch/cliao25/oxford_flowers/split_zhou_OxfordFlowers.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/oxford_flowers/shot_16-seed_1.pkl
Flowers102 has 2463 test samples
loaded image features from cache/image_features.y_truth.Flowers102coca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  77.01989412307739
EVALUATING ON DATASET:  Food101
Reading split from /scratch/cliao25/food-101/split_zhou_Food101.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/food-101/shot_16-seed_1.pkl
Food101 has 30300 test samples
loaded image features from cache/image_features.y_truth.Food101coca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  87.43894100189209
EVALUATING ON DATASET:  FGVCAircraft
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/fgvc_aircraft/shot_16-seed_1.pkl
FGVCAircraft has 3333 test samples
loaded image features from cache/image_features.y_truth.FGVCAircraftcoca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  36.36363446712494
EVALUATING ON DATASET:  SUN397
Reading split from /scratch/cliao25/sun397/split_zhou_SUN397.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/sun397/shot_16-seed_1.pkl
SUN397 has 19850 test samples
loaded image features from cache/image_features.y_truth.SUN397coca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  73.82367253303528
EVALUATING ON DATASET:  DTD
Reading split from /scratch/cliao25/dtd/split_zhou_DescribableTextures.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/dtd/shot_16-seed_1.pkl
DTD has 1692 test samples
loaded image features from cache/image_features.y_truth.DTDcoca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  57.97872543334961
EVALUATING ON DATASET:  EuroSAT
Reading split from /scratch/cliao25/eurosat/split_zhou_EuroSAT.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/eurosat/shot_16-seed_1.pkl
EuroSAT has 8100 test samples
loaded image features from cache/image_features.y_truth.EuroSATcoca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  57.43209719657898
EVALUATING ON DATASET:  UCF101
Reading split from /scratch/cliao25/ucf101/split_zhou_UCF101.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/ucf101/shot_16-seed_1.pkl
UCF101 has 3783 test samples
loaded image features from cache/image_features.y_truth.UCF101coca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  74.12106394767761
EVALUATING ON DATASET:  ImageNetV2
ImageNetV2 has 10000 test samples
loaded image features from cache/image_features.y_truth.ImageNetV2coca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  67.36999750137329
EVALUATING ON DATASET:  ImageNetSketch
ImageNetSketch has 50889 test samples
loaded image features from cache/image_features.y_truth.ImageNetSketchcoca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  63.538289070129395
EVALUATING ON DATASET:  ImageNetA
ImageNetA has 7500 test samples
loaded image features from cache/image_features.y_truth.ImageNetAcoca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  53.33333611488342
EVALUATING ON DATASET:  ImageNetR
ImageNetR has 30000 test samples
loaded image features from cache/image_features.y_truth.ImageNetRcoca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  86.90666556358337
Results:
,ImageNet,Caltech101,OxfordPets,StanfordCars,Flowers102,Food101,FGVCAircraft,SUN397,DTD,EuroSAT,UCF101,ImageNetV2,ImageNetSketch,ImageNetA,ImageNetR,
coca_ViT-L-14 laion2B-s13B-b90k BLIP ZS,75.02999901771545,97.32251763343811,94.08558011054993,92.63773560523987,77.01989412307739,87.43894100189209,36.36363446712494,73.82367253303528,57.97872543334961,57.43209719657898,74.12106394767761,67.36999750137329,63.538289070129395,53.33333611488342,86.90666556358337,
Namespace(accum_iter=1, adapter=0, adaptive_margin=0.0, bitfit=0, bs=32, cache_dir='/projectnb/textconv/cliao25/data', captioner='BLIP', checkpoint='', d=768, data_dir='/scratch/cliao25', dataset='', ema=0.995, eval_only=0, ice=True, ice_k=5, ice_lambda=0.1, init_lam=0.0, iters_per_epoch=750, label_smoothing=0.0, layer_start_t=9, layer_start_v=9, lora=0, loss='ce', lr=2e-05, lr_decay=0.0, maple=0, margin=0.0, modelname='coca_ViT-L-14', n_descriptors=-1, n_epochs=1, optimizer='sgd', pretrained='laion2B-s13B-b90k', prompt_lr_multi=10.0, rank=4, resblock_adapter=0, samples_per_class=1, save_model=0, seed=1, shallow_prompt_init='a photo of', shots=16, skip_ema_iters=0, ssf=0, subsample_classes='all', temp=60.0, text_prompt_depth=0, text_prompt_length=0, train_text_encoder=0, train_visual_encoder=0, use_all_logits=False, use_fixed_lambda=False, v=3, visual_prompt_depth=0, visual_prompt_length=0, wd=1e-05)
EVALUATING ON DATASET:  ImageNet
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/imagenet/shot_16-seed_1.pkl
ImageNet has 50000 test samples
loaded image features from cache/image_features.y_truth.ImageNetcoca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  75.44999718666077
EVALUATING ON DATASET:  Caltech101
Reading split from /scratch/cliao25/caltech-101/split_zhou_Caltech101.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/caltech-101/shot_16-seed_1.pkl
Caltech101 has 2465 test samples
loaded image features from cache/image_features.y_truth.Caltech101coca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  97.32251763343811
EVALUATING ON DATASET:  OxfordPets
Reading split from /scratch/cliao25/oxford_pets/split_zhou_OxfordPets.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/oxford_pets/shot_16-seed_1.pkl
OxfordPets has 3669 test samples
loaded image features from cache/image_features.y_truth.OxfordPetscoca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  94.00381445884705
EVALUATING ON DATASET:  StanfordCars
Reading split from /scratch/cliao25/stanford_cars/split_zhou_StanfordCars.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/stanford_cars/shot_16-seed_1.pkl
StanfordCars has 8041 test samples
loaded image features from cache/image_features.y_truth.StanfordCarscoca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  92.8864598274231
EVALUATING ON DATASET:  Flowers102
Reading split from /scratch/cliao25/oxford_flowers/split_zhou_OxfordFlowers.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/oxford_flowers/shot_16-seed_1.pkl
Flowers102 has 2463 test samples
loaded image features from cache/image_features.y_truth.Flowers102coca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  77.10109949111938
EVALUATING ON DATASET:  Food101
Reading split from /scratch/cliao25/food-101/split_zhou_Food101.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/food-101/shot_16-seed_1.pkl
Food101 has 30300 test samples
loaded image features from cache/image_features.y_truth.Food101coca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  88.02640438079834
EVALUATING ON DATASET:  FGVCAircraft
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/fgvc_aircraft/shot_16-seed_1.pkl
FGVCAircraft has 3333 test samples
loaded image features from cache/image_features.y_truth.FGVCAircraftcoca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  37.08370625972748
EVALUATING ON DATASET:  SUN397
Reading split from /scratch/cliao25/sun397/split_zhou_SUN397.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/sun397/shot_16-seed_1.pkl
SUN397 has 19850 test samples
loaded image features from cache/image_features.y_truth.SUN397coca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  74.12593960762024
EVALUATING ON DATASET:  DTD
Reading split from /scratch/cliao25/dtd/split_zhou_DescribableTextures.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/dtd/shot_16-seed_1.pkl
DTD has 1692 test samples
loaded image features from cache/image_features.y_truth.DTDcoca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  60.04728078842163
EVALUATING ON DATASET:  EuroSAT
Reading split from /scratch/cliao25/eurosat/split_zhou_EuroSAT.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/eurosat/shot_16-seed_1.pkl
EuroSAT has 8100 test samples
loaded image features from cache/image_features.y_truth.EuroSATcoca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  59.49382781982422
EVALUATING ON DATASET:  UCF101
Reading split from /scratch/cliao25/ucf101/split_zhou_UCF101.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/ucf101/shot_16-seed_1.pkl
UCF101 has 3783 test samples
loaded image features from cache/image_features.y_truth.UCF101coca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  75.81284642219543
EVALUATING ON DATASET:  ImageNetV2
ImageNetV2 has 10000 test samples
loaded image features from cache/image_features.y_truth.ImageNetV2coca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  67.98999905586243
EVALUATING ON DATASET:  ImageNetSketch
ImageNetSketch has 50889 test samples
loaded image features from cache/image_features.y_truth.ImageNetSketchcoca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  64.2103374004364
EVALUATING ON DATASET:  ImageNetA
ImageNetA has 7500 test samples
loaded image features from cache/image_features.y_truth.ImageNetAcoca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  56.55999779701233
EVALUATING ON DATASET:  ImageNetR
ImageNetR has 30000 test samples
loaded image features from cache/image_features.y_truth.ImageNetRcoca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  88.22667002677917
Results:
,ImageNet,Caltech101,OxfordPets,StanfordCars,Flowers102,Food101,FGVCAircraft,SUN397,DTD,EuroSAT,UCF101,ImageNetV2,ImageNetSketch,ImageNetA,ImageNetR,
coca_ViT-L-14 laion2B-s13B-b90k BLIP ZS,75.44999718666077,97.32251763343811,94.00381445884705,92.8864598274231,77.10109949111938,88.02640438079834,37.08370625972748,74.12593960762024,60.04728078842163,59.49382781982422,75.81284642219543,67.98999905586243,64.2103374004364,56.55999779701233,88.22667002677917,
Namespace(accum_iter=1, adapter=0, adaptive_margin=0.0, bitfit=0, bs=32, cache_dir='/projectnb/textconv/cliao25/data', captioner='BLIP', checkpoint='', d=768, data_dir='/scratch/cliao25', dataset='', ema=0.995, eval_only=0, ice=True, ice_k=5, ice_lambda=0.2, init_lam=0.0, iters_per_epoch=750, label_smoothing=0.0, layer_start_t=9, layer_start_v=9, lora=0, loss='ce', lr=2e-05, lr_decay=0.0, maple=0, margin=0.0, modelname='coca_ViT-L-14', n_descriptors=-1, n_epochs=1, optimizer='sgd', pretrained='laion2B-s13B-b90k', prompt_lr_multi=10.0, rank=4, resblock_adapter=0, samples_per_class=1, save_model=0, seed=1, shallow_prompt_init='a photo of', shots=16, skip_ema_iters=0, ssf=0, subsample_classes='all', temp=60.0, text_prompt_depth=0, text_prompt_length=0, train_text_encoder=0, train_visual_encoder=0, use_all_logits=False, use_fixed_lambda=False, v=3, visual_prompt_depth=0, visual_prompt_length=0, wd=1e-05)
EVALUATING ON DATASET:  ImageNet
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/imagenet/shot_16-seed_1.pkl
ImageNet has 50000 test samples
loaded image features from cache/image_features.y_truth.ImageNetcoca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  74.78199601173401
EVALUATING ON DATASET:  Caltech101
Reading split from /scratch/cliao25/caltech-101/split_zhou_Caltech101.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/caltech-101/shot_16-seed_1.pkl
Caltech101 has 2465 test samples
loaded image features from cache/image_features.y_truth.Caltech101coca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  97.32251763343811
EVALUATING ON DATASET:  OxfordPets
Reading split from /scratch/cliao25/oxford_pets/split_zhou_OxfordPets.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/oxford_pets/shot_16-seed_1.pkl
OxfordPets has 3669 test samples
loaded image features from cache/image_features.y_truth.OxfordPetscoca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  93.45870614051819
EVALUATING ON DATASET:  StanfordCars
Reading split from /scratch/cliao25/stanford_cars/split_zhou_StanfordCars.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/stanford_cars/shot_16-seed_1.pkl
StanfordCars has 8041 test samples
loaded image features from cache/image_features.y_truth.StanfordCarscoca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  92.35169887542725
EVALUATING ON DATASET:  Flowers102
Reading split from /scratch/cliao25/oxford_flowers/split_zhou_OxfordFlowers.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/oxford_flowers/shot_16-seed_1.pkl
Flowers102 has 2463 test samples
loaded image features from cache/image_features.y_truth.Flowers102coca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  75.80186724662781
EVALUATING ON DATASET:  Food101
Reading split from /scratch/cliao25/food-101/split_zhou_Food101.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/food-101/shot_16-seed_1.pkl
Food101 has 30300 test samples
loaded image features from cache/image_features.y_truth.Food101coca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  87.57755756378174
EVALUATING ON DATASET:  FGVCAircraft
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/fgvc_aircraft/shot_16-seed_1.pkl
FGVCAircraft has 3333 test samples
loaded image features from cache/image_features.y_truth.FGVCAircraftcoca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  36.72367036342621
EVALUATING ON DATASET:  SUN397
Reading split from /scratch/cliao25/sun397/split_zhou_SUN397.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/sun397/shot_16-seed_1.pkl
SUN397 has 19850 test samples
loaded image features from cache/image_features.y_truth.SUN397coca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  73.40050339698792
EVALUATING ON DATASET:  DTD
Reading split from /scratch/cliao25/dtd/split_zhou_DescribableTextures.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/dtd/shot_16-seed_1.pkl
DTD has 1692 test samples
loaded image features from cache/image_features.y_truth.DTDcoca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  60.75649857521057
EVALUATING ON DATASET:  EuroSAT
Reading split from /scratch/cliao25/eurosat/split_zhou_EuroSAT.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/eurosat/shot_16-seed_1.pkl
EuroSAT has 8100 test samples
loaded image features from cache/image_features.y_truth.EuroSATcoca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  58.82716178894043
EVALUATING ON DATASET:  UCF101
Reading split from /scratch/cliao25/ucf101/split_zhou_UCF101.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/ucf101/shot_16-seed_1.pkl
UCF101 has 3783 test samples
loaded image features from cache/image_features.y_truth.UCF101coca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  76.23578906059265
EVALUATING ON DATASET:  ImageNetV2
ImageNetV2 has 10000 test samples
loaded image features from cache/image_features.y_truth.ImageNetV2coca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  67.57999658584595
EVALUATING ON DATASET:  ImageNetSketch
ImageNetSketch has 50889 test samples
loaded image features from cache/image_features.y_truth.ImageNetSketchcoca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  63.87627720832825
EVALUATING ON DATASET:  ImageNetA
ImageNetA has 7500 test samples
loaded image features from cache/image_features.y_truth.ImageNetAcoca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  57.74666666984558
EVALUATING ON DATASET:  ImageNetR
ImageNetR has 30000 test samples
loaded image features from cache/image_features.y_truth.ImageNetRcoca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  88.60000371932983
Results:
,ImageNet,Caltech101,OxfordPets,StanfordCars,Flowers102,Food101,FGVCAircraft,SUN397,DTD,EuroSAT,UCF101,ImageNetV2,ImageNetSketch,ImageNetA,ImageNetR,
coca_ViT-L-14 laion2B-s13B-b90k BLIP ZS,74.78199601173401,97.32251763343811,93.45870614051819,92.35169887542725,75.80186724662781,87.57755756378174,36.72367036342621,73.40050339698792,60.75649857521057,58.82716178894043,76.23578906059265,67.57999658584595,63.87627720832825,57.74666666984558,88.60000371932983,
Namespace(accum_iter=1, adapter=0, adaptive_margin=0.0, bitfit=0, bs=32, cache_dir='/projectnb/textconv/cliao25/data', captioner='BLIP', checkpoint='', d=768, data_dir='/scratch/cliao25', dataset='', ema=0.995, eval_only=0, ice=True, ice_k=5, ice_lambda=0.3, init_lam=0.0, iters_per_epoch=750, label_smoothing=0.0, layer_start_t=9, layer_start_v=9, lora=0, loss='ce', lr=2e-05, lr_decay=0.0, maple=0, margin=0.0, modelname='coca_ViT-L-14', n_descriptors=-1, n_epochs=1, optimizer='sgd', pretrained='laion2B-s13B-b90k', prompt_lr_multi=10.0, rank=4, resblock_adapter=0, samples_per_class=1, save_model=0, seed=1, shallow_prompt_init='a photo of', shots=16, skip_ema_iters=0, ssf=0, subsample_classes='all', temp=60.0, text_prompt_depth=0, text_prompt_length=0, train_text_encoder=0, train_visual_encoder=0, use_all_logits=False, use_fixed_lambda=False, v=3, visual_prompt_depth=0, visual_prompt_length=0, wd=1e-05)
EVALUATING ON DATASET:  ImageNet
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/imagenet/shot_16-seed_1.pkl
ImageNet has 50000 test samples
loaded image features from cache/image_features.y_truth.ImageNetcoca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  73.76799583435059
EVALUATING ON DATASET:  Caltech101
Reading split from /scratch/cliao25/caltech-101/split_zhou_Caltech101.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/caltech-101/shot_16-seed_1.pkl
Caltech101 has 2465 test samples
loaded image features from cache/image_features.y_truth.Caltech101coca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  97.11967706680298
EVALUATING ON DATASET:  OxfordPets
Reading split from /scratch/cliao25/oxford_pets/split_zhou_OxfordPets.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/oxford_pets/shot_16-seed_1.pkl
OxfordPets has 3669 test samples
loaded image features from cache/image_features.y_truth.OxfordPetscoca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  92.88634061813354
EVALUATING ON DATASET:  StanfordCars
Reading split from /scratch/cliao25/stanford_cars/split_zhou_StanfordCars.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/stanford_cars/shot_16-seed_1.pkl
StanfordCars has 8041 test samples
loaded image features from cache/image_features.y_truth.StanfordCarscoca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  91.76719784736633
EVALUATING ON DATASET:  Flowers102
Reading split from /scratch/cliao25/oxford_flowers/split_zhou_OxfordFlowers.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/oxford_flowers/shot_16-seed_1.pkl
Flowers102 has 2463 test samples
loaded image features from cache/image_features.y_truth.Flowers102coca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  73.85302782058716
EVALUATING ON DATASET:  Food101
Reading split from /scratch/cliao25/food-101/split_zhou_Food101.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/food-101/shot_16-seed_1.pkl
Food101 has 30300 test samples
loaded image features from cache/image_features.y_truth.Food101coca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  86.55115365982056
EVALUATING ON DATASET:  FGVCAircraft
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/fgvc_aircraft/shot_16-seed_1.pkl
FGVCAircraft has 3333 test samples
loaded image features from cache/image_features.y_truth.FGVCAircraftcoca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  35.31352877616882
EVALUATING ON DATASET:  SUN397
Reading split from /scratch/cliao25/sun397/split_zhou_SUN397.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/sun397/shot_16-seed_1.pkl
SUN397 has 19850 test samples
loaded image features from cache/image_features.y_truth.SUN397coca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  72.46347069740295
EVALUATING ON DATASET:  DTD
Reading split from /scratch/cliao25/dtd/split_zhou_DescribableTextures.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/dtd/shot_16-seed_1.pkl
DTD has 1692 test samples
loaded image features from cache/image_features.y_truth.DTDcoca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  61.46572232246399
EVALUATING ON DATASET:  EuroSAT
Reading split from /scratch/cliao25/eurosat/split_zhou_EuroSAT.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/eurosat/shot_16-seed_1.pkl
EuroSAT has 8100 test samples
loaded image features from cache/image_features.y_truth.EuroSATcoca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  58.19752812385559
EVALUATING ON DATASET:  UCF101
Reading split from /scratch/cliao25/ucf101/split_zhou_UCF101.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/ucf101/shot_16-seed_1.pkl
UCF101 has 3783 test samples
loaded image features from cache/image_features.y_truth.UCF101coca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  75.81284642219543
EVALUATING ON DATASET:  ImageNetV2
ImageNetV2 has 10000 test samples
loaded image features from cache/image_features.y_truth.ImageNetV2coca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  66.61999821662903
EVALUATING ON DATASET:  ImageNetSketch
ImageNetSketch has 50889 test samples
loaded image features from cache/image_features.y_truth.ImageNetSketchcoca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  63.066673278808594
EVALUATING ON DATASET:  ImageNetA
ImageNetA has 7500 test samples
loaded image features from cache/image_features.y_truth.ImageNetAcoca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  57.96000361442566
EVALUATING ON DATASET:  ImageNetR
ImageNetR has 30000 test samples
loaded image features from cache/image_features.y_truth.ImageNetRcoca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  88.59666585922241
Results:
,ImageNet,Caltech101,OxfordPets,StanfordCars,Flowers102,Food101,FGVCAircraft,SUN397,DTD,EuroSAT,UCF101,ImageNetV2,ImageNetSketch,ImageNetA,ImageNetR,
coca_ViT-L-14 laion2B-s13B-b90k BLIP ZS,73.76799583435059,97.11967706680298,92.88634061813354,91.76719784736633,73.85302782058716,86.55115365982056,35.31352877616882,72.46347069740295,61.46572232246399,58.19752812385559,75.81284642219543,66.61999821662903,63.066673278808594,57.96000361442566,88.59666585922241,
Namespace(accum_iter=1, adapter=0, adaptive_margin=0.0, bitfit=0, bs=32, cache_dir='/projectnb/textconv/cliao25/data', captioner='BLIP', checkpoint='', d=768, data_dir='/scratch/cliao25', dataset='', ema=0.995, eval_only=0, ice=True, ice_k=5, ice_lambda=0.4, init_lam=0.0, iters_per_epoch=750, label_smoothing=0.0, layer_start_t=9, layer_start_v=9, lora=0, loss='ce', lr=2e-05, lr_decay=0.0, maple=0, margin=0.0, modelname='coca_ViT-L-14', n_descriptors=-1, n_epochs=1, optimizer='sgd', pretrained='laion2B-s13B-b90k', prompt_lr_multi=10.0, rank=4, resblock_adapter=0, samples_per_class=1, save_model=0, seed=1, shallow_prompt_init='a photo of', shots=16, skip_ema_iters=0, ssf=0, subsample_classes='all', temp=60.0, text_prompt_depth=0, text_prompt_length=0, train_text_encoder=0, train_visual_encoder=0, use_all_logits=False, use_fixed_lambda=False, v=3, visual_prompt_depth=0, visual_prompt_length=0, wd=1e-05)
EVALUATING ON DATASET:  ImageNet
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/imagenet/shot_16-seed_1.pkl
ImageNet has 50000 test samples
loaded image features from cache/image_features.y_truth.ImageNetcoca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  72.71599769592285
EVALUATING ON DATASET:  Caltech101
Reading split from /scratch/cliao25/caltech-101/split_zhou_Caltech101.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/caltech-101/shot_16-seed_1.pkl
Caltech101 has 2465 test samples
loaded image features from cache/image_features.y_truth.Caltech101coca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  96.99797034263611
EVALUATING ON DATASET:  OxfordPets
Reading split from /scratch/cliao25/oxford_pets/split_zhou_OxfordPets.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/oxford_pets/shot_16-seed_1.pkl
OxfordPets has 3669 test samples
loaded image features from cache/image_features.y_truth.OxfordPetscoca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  91.93240404129028
EVALUATING ON DATASET:  StanfordCars
Reading split from /scratch/cliao25/stanford_cars/split_zhou_StanfordCars.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/stanford_cars/shot_16-seed_1.pkl
StanfordCars has 8041 test samples
loaded image features from cache/image_features.y_truth.StanfordCarscoca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  90.73498845100403
EVALUATING ON DATASET:  Flowers102
Reading split from /scratch/cliao25/oxford_flowers/split_zhou_OxfordFlowers.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/oxford_flowers/shot_16-seed_1.pkl
Flowers102 has 2463 test samples
loaded image features from cache/image_features.y_truth.Flowers102coca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  71.37637138366699
EVALUATING ON DATASET:  Food101
Reading split from /scratch/cliao25/food-101/split_zhou_Food101.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/food-101/shot_16-seed_1.pkl
Food101 has 30300 test samples
loaded image features from cache/image_features.y_truth.Food101coca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  85.46534776687622
EVALUATING ON DATASET:  FGVCAircraft
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/fgvc_aircraft/shot_16-seed_1.pkl
FGVCAircraft has 3333 test samples
loaded image features from cache/image_features.y_truth.FGVCAircraftcoca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  34.6834659576416
EVALUATING ON DATASET:  SUN397
Reading split from /scratch/cliao25/sun397/split_zhou_SUN397.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/sun397/shot_16-seed_1.pkl
SUN397 has 19850 test samples
loaded image features from cache/image_features.y_truth.SUN397coca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  71.49621844291687
EVALUATING ON DATASET:  DTD
Reading split from /scratch/cliao25/dtd/split_zhou_DescribableTextures.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/dtd/shot_16-seed_1.pkl
DTD has 1692 test samples
loaded image features from cache/image_features.y_truth.DTDcoca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  61.82032823562622
EVALUATING ON DATASET:  EuroSAT
Reading split from /scratch/cliao25/eurosat/split_zhou_EuroSAT.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/eurosat/shot_16-seed_1.pkl
EuroSAT has 8100 test samples
loaded image features from cache/image_features.y_truth.EuroSATcoca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  56.876540184020996
EVALUATING ON DATASET:  UCF101
Reading split from /scratch/cliao25/ucf101/split_zhou_UCF101.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/ucf101/shot_16-seed_1.pkl
UCF101 has 3783 test samples
loaded image features from cache/image_features.y_truth.UCF101coca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  75.17842650413513
EVALUATING ON DATASET:  ImageNetV2
ImageNetV2 has 10000 test samples
loaded image features from cache/image_features.y_truth.ImageNetV2coca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  65.53999781608582
EVALUATING ON DATASET:  ImageNetSketch
ImageNetSketch has 50889 test samples
loaded image features from cache/image_features.y_truth.ImageNetSketchcoca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  62.35924959182739
EVALUATING ON DATASET:  ImageNetA
ImageNetA has 7500 test samples
loaded image features from cache/image_features.y_truth.ImageNetAcoca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  57.573336362838745
EVALUATING ON DATASET:  ImageNetR
ImageNetR has 30000 test samples
loaded image features from cache/image_features.y_truth.ImageNetRcoca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  88.4766697883606
Results:
,ImageNet,Caltech101,OxfordPets,StanfordCars,Flowers102,Food101,FGVCAircraft,SUN397,DTD,EuroSAT,UCF101,ImageNetV2,ImageNetSketch,ImageNetA,ImageNetR,
coca_ViT-L-14 laion2B-s13B-b90k BLIP ZS,72.71599769592285,96.99797034263611,91.93240404129028,90.73498845100403,71.37637138366699,85.46534776687622,34.6834659576416,71.49621844291687,61.82032823562622,56.876540184020996,75.17842650413513,65.53999781608582,62.35924959182739,57.573336362838745,88.4766697883606,
Namespace(accum_iter=1, adapter=0, adaptive_margin=0.0, bitfit=0, bs=32, cache_dir='/projectnb/textconv/cliao25/data', captioner='BLIP', checkpoint='', d=768, data_dir='/scratch/cliao25', dataset='', ema=0.995, eval_only=0, ice=True, ice_k=5, ice_lambda=0.5, init_lam=0.0, iters_per_epoch=750, label_smoothing=0.0, layer_start_t=9, layer_start_v=9, lora=0, loss='ce', lr=2e-05, lr_decay=0.0, maple=0, margin=0.0, modelname='coca_ViT-L-14', n_descriptors=-1, n_epochs=1, optimizer='sgd', pretrained='laion2B-s13B-b90k', prompt_lr_multi=10.0, rank=4, resblock_adapter=0, samples_per_class=1, save_model=0, seed=1, shallow_prompt_init='a photo of', shots=16, skip_ema_iters=0, ssf=0, subsample_classes='all', temp=60.0, text_prompt_depth=0, text_prompt_length=0, train_text_encoder=0, train_visual_encoder=0, use_all_logits=False, use_fixed_lambda=False, v=3, visual_prompt_depth=0, visual_prompt_length=0, wd=1e-05)
EVALUATING ON DATASET:  ImageNet
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/imagenet/shot_16-seed_1.pkl
ImageNet has 50000 test samples
loaded image features from cache/image_features.y_truth.ImageNetcoca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  71.73399925231934
EVALUATING ON DATASET:  Caltech101
Reading split from /scratch/cliao25/caltech-101/split_zhou_Caltech101.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/caltech-101/shot_16-seed_1.pkl
Caltech101 has 2465 test samples
loaded image features from cache/image_features.y_truth.Caltech101coca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  96.91683650016785
EVALUATING ON DATASET:  OxfordPets
Reading split from /scratch/cliao25/oxford_pets/split_zhou_OxfordPets.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/oxford_pets/shot_16-seed_1.pkl
OxfordPets has 3669 test samples
loaded image features from cache/image_features.y_truth.OxfordPetscoca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  90.97846746444702
EVALUATING ON DATASET:  StanfordCars
Reading split from /scratch/cliao25/stanford_cars/split_zhou_StanfordCars.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/stanford_cars/shot_16-seed_1.pkl
StanfordCars has 8041 test samples
loaded image features from cache/image_features.y_truth.StanfordCarscoca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  89.56598043441772
EVALUATING ON DATASET:  Flowers102
Reading split from /scratch/cliao25/oxford_flowers/split_zhou_OxfordFlowers.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/oxford_flowers/shot_16-seed_1.pkl
Flowers102 has 2463 test samples
loaded image features from cache/image_features.y_truth.Flowers102coca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  69.42752599716187
EVALUATING ON DATASET:  Food101
Reading split from /scratch/cliao25/food-101/split_zhou_Food101.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/food-101/shot_16-seed_1.pkl
Food101 has 30300 test samples
loaded image features from cache/image_features.y_truth.Food101coca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  84.47524905204773
EVALUATING ON DATASET:  FGVCAircraft
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/fgvc_aircraft/shot_16-seed_1.pkl
FGVCAircraft has 3333 test samples
loaded image features from cache/image_features.y_truth.FGVCAircraftcoca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  33.72337222099304
EVALUATING ON DATASET:  SUN397
Reading split from /scratch/cliao25/sun397/split_zhou_SUN397.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/sun397/shot_16-seed_1.pkl
SUN397 has 19850 test samples
loaded image features from cache/image_features.y_truth.SUN397coca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  70.56422829627991
EVALUATING ON DATASET:  DTD
Reading split from /scratch/cliao25/dtd/split_zhou_DescribableTextures.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/dtd/shot_16-seed_1.pkl
DTD has 1692 test samples
loaded image features from cache/image_features.y_truth.DTDcoca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  61.702126264572144
EVALUATING ON DATASET:  EuroSAT
Reading split from /scratch/cliao25/eurosat/split_zhou_EuroSAT.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/eurosat/shot_16-seed_1.pkl
EuroSAT has 8100 test samples
loaded image features from cache/image_features.y_truth.EuroSATcoca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  55.49382567405701
EVALUATING ON DATASET:  UCF101
Reading split from /scratch/cliao25/ucf101/split_zhou_UCF101.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/ucf101/shot_16-seed_1.pkl
UCF101 has 3783 test samples
loaded image features from cache/image_features.y_truth.UCF101coca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  74.67617988586426
EVALUATING ON DATASET:  ImageNetV2
ImageNetV2 has 10000 test samples
loaded image features from cache/image_features.y_truth.ImageNetV2coca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  64.88999724388123
EVALUATING ON DATASET:  ImageNetSketch
ImageNetSketch has 50889 test samples
loaded image features from cache/image_features.y_truth.ImageNetSketchcoca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  61.65575981140137
EVALUATING ON DATASET:  ImageNetA
ImageNetA has 7500 test samples
loaded image features from cache/image_features.y_truth.ImageNetAcoca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  57.24000334739685
EVALUATING ON DATASET:  ImageNetR
ImageNetR has 30000 test samples
loaded image features from cache/image_features.y_truth.ImageNetRcoca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  88.23666572570801
Results:
,ImageNet,Caltech101,OxfordPets,StanfordCars,Flowers102,Food101,FGVCAircraft,SUN397,DTD,EuroSAT,UCF101,ImageNetV2,ImageNetSketch,ImageNetA,ImageNetR,
coca_ViT-L-14 laion2B-s13B-b90k BLIP ZS,71.73399925231934,96.91683650016785,90.97846746444702,89.56598043441772,69.42752599716187,84.47524905204773,33.72337222099304,70.56422829627991,61.702126264572144,55.49382567405701,74.67617988586426,64.88999724388123,61.65575981140137,57.24000334739685,88.23666572570801,
Namespace(accum_iter=1, adapter=0, adaptive_margin=0.0, bitfit=0, bs=32, cache_dir='/projectnb/textconv/cliao25/data', captioner='BLIP', checkpoint='', d=768, data_dir='/scratch/cliao25', dataset='', ema=0.995, eval_only=0, ice=True, ice_k=5, ice_lambda=0.6, init_lam=0.0, iters_per_epoch=750, label_smoothing=0.0, layer_start_t=9, layer_start_v=9, lora=0, loss='ce', lr=2e-05, lr_decay=0.0, maple=0, margin=0.0, modelname='coca_ViT-L-14', n_descriptors=-1, n_epochs=1, optimizer='sgd', pretrained='laion2B-s13B-b90k', prompt_lr_multi=10.0, rank=4, resblock_adapter=0, samples_per_class=1, save_model=0, seed=1, shallow_prompt_init='a photo of', shots=16, skip_ema_iters=0, ssf=0, subsample_classes='all', temp=60.0, text_prompt_depth=0, text_prompt_length=0, train_text_encoder=0, train_visual_encoder=0, use_all_logits=False, use_fixed_lambda=False, v=3, visual_prompt_depth=0, visual_prompt_length=0, wd=1e-05)
EVALUATING ON DATASET:  ImageNet
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/imagenet/shot_16-seed_1.pkl
ImageNet has 50000 test samples
loaded image features from cache/image_features.y_truth.ImageNetcoca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  70.81800103187561
EVALUATING ON DATASET:  Caltech101
Reading split from /scratch/cliao25/caltech-101/split_zhou_Caltech101.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/caltech-101/shot_16-seed_1.pkl
Caltech101 has 2465 test samples
loaded image features from cache/image_features.y_truth.Caltech101coca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  96.87626957893372
EVALUATING ON DATASET:  OxfordPets
Reading split from /scratch/cliao25/oxford_pets/split_zhou_OxfordPets.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/oxford_pets/shot_16-seed_1.pkl
OxfordPets has 3669 test samples
loaded image features from cache/image_features.y_truth.OxfordPetscoca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  90.40610194206238
EVALUATING ON DATASET:  StanfordCars
Reading split from /scratch/cliao25/stanford_cars/split_zhou_StanfordCars.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/stanford_cars/shot_16-seed_1.pkl
StanfordCars has 8041 test samples
loaded image features from cache/image_features.y_truth.StanfordCarscoca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  88.45915198326111
EVALUATING ON DATASET:  Flowers102
Reading split from /scratch/cliao25/oxford_flowers/split_zhou_OxfordFlowers.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/oxford_flowers/shot_16-seed_1.pkl
Flowers102 has 2463 test samples
loaded image features from cache/image_features.y_truth.Flowers102coca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  68.25010180473328
EVALUATING ON DATASET:  Food101
Reading split from /scratch/cliao25/food-101/split_zhou_Food101.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/food-101/shot_16-seed_1.pkl
Food101 has 30300 test samples
loaded image features from cache/image_features.y_truth.Food101coca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  83.59405994415283
EVALUATING ON DATASET:  FGVCAircraft
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/fgvc_aircraft/shot_16-seed_1.pkl
FGVCAircraft has 3333 test samples
loaded image features from cache/image_features.y_truth.FGVCAircraftcoca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  33.24332237243652
EVALUATING ON DATASET:  SUN397
Reading split from /scratch/cliao25/sun397/split_zhou_SUN397.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/sun397/shot_16-seed_1.pkl
SUN397 has 19850 test samples
loaded image features from cache/image_features.y_truth.SUN397coca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  69.51637268066406
EVALUATING ON DATASET:  DTD
Reading split from /scratch/cliao25/dtd/split_zhou_DescribableTextures.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/dtd/shot_16-seed_1.pkl
DTD has 1692 test samples
loaded image features from cache/image_features.y_truth.DTDcoca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  61.583924293518066
EVALUATING ON DATASET:  EuroSAT
Reading split from /scratch/cliao25/eurosat/split_zhou_EuroSAT.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/eurosat/shot_16-seed_1.pkl
EuroSAT has 8100 test samples
loaded image features from cache/image_features.y_truth.EuroSATcoca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  54.17283773422241
EVALUATING ON DATASET:  UCF101
Reading split from /scratch/cliao25/ucf101/split_zhou_UCF101.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/ucf101/shot_16-seed_1.pkl
UCF101 has 3783 test samples
loaded image features from cache/image_features.y_truth.UCF101coca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  74.06819462776184
EVALUATING ON DATASET:  ImageNetV2
ImageNetV2 has 10000 test samples
loaded image features from cache/image_features.y_truth.ImageNetV2coca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  64.24999833106995
EVALUATING ON DATASET:  ImageNetSketch
ImageNetSketch has 50889 test samples
loaded image features from cache/image_features.y_truth.ImageNetSketchcoca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  61.14877462387085
EVALUATING ON DATASET:  ImageNetA
ImageNetA has 7500 test samples
loaded image features from cache/image_features.y_truth.ImageNetAcoca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  56.82666897773743
EVALUATING ON DATASET:  ImageNetR
ImageNetR has 30000 test samples
loaded image features from cache/image_features.y_truth.ImageNetRcoca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  88.0566656589508
Results:
,ImageNet,Caltech101,OxfordPets,StanfordCars,Flowers102,Food101,FGVCAircraft,SUN397,DTD,EuroSAT,UCF101,ImageNetV2,ImageNetSketch,ImageNetA,ImageNetR,
coca_ViT-L-14 laion2B-s13B-b90k BLIP ZS,70.81800103187561,96.87626957893372,90.40610194206238,88.45915198326111,68.25010180473328,83.59405994415283,33.24332237243652,69.51637268066406,61.583924293518066,54.17283773422241,74.06819462776184,64.24999833106995,61.14877462387085,56.82666897773743,88.0566656589508,
Namespace(accum_iter=1, adapter=0, adaptive_margin=0.0, bitfit=0, bs=32, cache_dir='/projectnb/textconv/cliao25/data', captioner='BLIP', checkpoint='', d=768, data_dir='/scratch/cliao25', dataset='', ema=0.995, eval_only=0, ice=True, ice_k=5, ice_lambda=0.7, init_lam=0.0, iters_per_epoch=750, label_smoothing=0.0, layer_start_t=9, layer_start_v=9, lora=0, loss='ce', lr=2e-05, lr_decay=0.0, maple=0, margin=0.0, modelname='coca_ViT-L-14', n_descriptors=-1, n_epochs=1, optimizer='sgd', pretrained='laion2B-s13B-b90k', prompt_lr_multi=10.0, rank=4, resblock_adapter=0, samples_per_class=1, save_model=0, seed=1, shallow_prompt_init='a photo of', shots=16, skip_ema_iters=0, ssf=0, subsample_classes='all', temp=60.0, text_prompt_depth=0, text_prompt_length=0, train_text_encoder=0, train_visual_encoder=0, use_all_logits=False, use_fixed_lambda=False, v=3, visual_prompt_depth=0, visual_prompt_length=0, wd=1e-05)
EVALUATING ON DATASET:  ImageNet
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/imagenet/shot_16-seed_1.pkl
ImageNet has 50000 test samples
loaded image features from cache/image_features.y_truth.ImageNetcoca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  70.02399563789368
EVALUATING ON DATASET:  Caltech101
Reading split from /scratch/cliao25/caltech-101/split_zhou_Caltech101.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/caltech-101/shot_16-seed_1.pkl
Caltech101 has 2465 test samples
loaded image features from cache/image_features.y_truth.Caltech101coca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  96.87626957893372
EVALUATING ON DATASET:  OxfordPets
Reading split from /scratch/cliao25/oxford_pets/split_zhou_OxfordPets.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/oxford_pets/shot_16-seed_1.pkl
OxfordPets has 3669 test samples
loaded image features from cache/image_features.y_truth.OxfordPetscoca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  89.61569666862488
EVALUATING ON DATASET:  StanfordCars
Reading split from /scratch/cliao25/stanford_cars/split_zhou_StanfordCars.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/stanford_cars/shot_16-seed_1.pkl
StanfordCars has 8041 test samples
loaded image features from cache/image_features.y_truth.StanfordCarscoca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  87.35232353210449
EVALUATING ON DATASET:  Flowers102
Reading split from /scratch/cliao25/oxford_flowers/split_zhou_OxfordFlowers.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/oxford_flowers/shot_16-seed_1.pkl
Flowers102 has 2463 test samples
loaded image features from cache/image_features.y_truth.Flowers102coca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  66.58546924591064
EVALUATING ON DATASET:  Food101
Reading split from /scratch/cliao25/food-101/split_zhou_Food101.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/food-101/shot_16-seed_1.pkl
Food101 has 30300 test samples
loaded image features from cache/image_features.y_truth.Food101coca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  82.81188011169434
EVALUATING ON DATASET:  FGVCAircraft
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/fgvc_aircraft/shot_16-seed_1.pkl
FGVCAircraft has 3333 test samples
loaded image features from cache/image_features.y_truth.FGVCAircraftcoca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  32.523250579833984
EVALUATING ON DATASET:  SUN397
Reading split from /scratch/cliao25/sun397/split_zhou_SUN397.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/sun397/shot_16-seed_1.pkl
SUN397 has 19850 test samples
loaded image features from cache/image_features.y_truth.SUN397coca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  68.59949231147766
EVALUATING ON DATASET:  DTD
Reading split from /scratch/cliao25/dtd/split_zhou_DescribableTextures.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/dtd/shot_16-seed_1.pkl
DTD has 1692 test samples
loaded image features from cache/image_features.y_truth.DTDcoca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  61.643028259277344
EVALUATING ON DATASET:  EuroSAT
Reading split from /scratch/cliao25/eurosat/split_zhou_EuroSAT.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/eurosat/shot_16-seed_1.pkl
EuroSAT has 8100 test samples
loaded image features from cache/image_features.y_truth.EuroSATcoca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  53.18518280982971
EVALUATING ON DATASET:  UCF101
Reading split from /scratch/cliao25/ucf101/split_zhou_UCF101.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/ucf101/shot_16-seed_1.pkl
UCF101 has 3783 test samples
loaded image features from cache/image_features.y_truth.UCF101coca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  73.40734601020813
EVALUATING ON DATASET:  ImageNetV2
ImageNetV2 has 10000 test samples
loaded image features from cache/image_features.y_truth.ImageNetV2coca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  63.37000131607056
EVALUATING ON DATASET:  ImageNetSketch
ImageNetSketch has 50889 test samples
loaded image features from cache/image_features.y_truth.ImageNetSketchcoca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  60.66144108772278
EVALUATING ON DATASET:  ImageNetA
ImageNetA has 7500 test samples
loaded image features from cache/image_features.y_truth.ImageNetAcoca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  56.45333528518677
EVALUATING ON DATASET:  ImageNetR
ImageNetR has 30000 test samples
loaded image features from cache/image_features.y_truth.ImageNetRcoca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  87.79333233833313
Results:
,ImageNet,Caltech101,OxfordPets,StanfordCars,Flowers102,Food101,FGVCAircraft,SUN397,DTD,EuroSAT,UCF101,ImageNetV2,ImageNetSketch,ImageNetA,ImageNetR,
coca_ViT-L-14 laion2B-s13B-b90k BLIP ZS,70.02399563789368,96.87626957893372,89.61569666862488,87.35232353210449,66.58546924591064,82.81188011169434,32.523250579833984,68.59949231147766,61.643028259277344,53.18518280982971,73.40734601020813,63.37000131607056,60.66144108772278,56.45333528518677,87.79333233833313,
Namespace(accum_iter=1, adapter=0, adaptive_margin=0.0, bitfit=0, bs=32, cache_dir='/projectnb/textconv/cliao25/data', captioner='BLIP', checkpoint='', d=768, data_dir='/scratch/cliao25', dataset='', ema=0.995, eval_only=0, ice=True, ice_k=5, ice_lambda=0.8, init_lam=0.0, iters_per_epoch=750, label_smoothing=0.0, layer_start_t=9, layer_start_v=9, lora=0, loss='ce', lr=2e-05, lr_decay=0.0, maple=0, margin=0.0, modelname='coca_ViT-L-14', n_descriptors=-1, n_epochs=1, optimizer='sgd', pretrained='laion2B-s13B-b90k', prompt_lr_multi=10.0, rank=4, resblock_adapter=0, samples_per_class=1, save_model=0, seed=1, shallow_prompt_init='a photo of', shots=16, skip_ema_iters=0, ssf=0, subsample_classes='all', temp=60.0, text_prompt_depth=0, text_prompt_length=0, train_text_encoder=0, train_visual_encoder=0, use_all_logits=False, use_fixed_lambda=False, v=3, visual_prompt_depth=0, visual_prompt_length=0, wd=1e-05)
EVALUATING ON DATASET:  ImageNet
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/imagenet/shot_16-seed_1.pkl
ImageNet has 50000 test samples
loaded image features from cache/image_features.y_truth.ImageNetcoca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  69.2900002002716
EVALUATING ON DATASET:  Caltech101
Reading split from /scratch/cliao25/caltech-101/split_zhou_Caltech101.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/caltech-101/shot_16-seed_1.pkl
Caltech101 has 2465 test samples
loaded image features from cache/image_features.y_truth.Caltech101coca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  96.83570265769958
EVALUATING ON DATASET:  OxfordPets
Reading split from /scratch/cliao25/oxford_pets/split_zhou_OxfordPets.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/oxford_pets/shot_16-seed_1.pkl
OxfordPets has 3669 test samples
loaded image features from cache/image_features.y_truth.OxfordPetscoca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  88.44371438026428
EVALUATING ON DATASET:  StanfordCars
Reading split from /scratch/cliao25/stanford_cars/split_zhou_StanfordCars.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/stanford_cars/shot_16-seed_1.pkl
StanfordCars has 8041 test samples
loaded image features from cache/image_features.y_truth.StanfordCarscoca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  86.29524111747742
EVALUATING ON DATASET:  Flowers102
Reading split from /scratch/cliao25/oxford_flowers/split_zhou_OxfordFlowers.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/oxford_flowers/shot_16-seed_1.pkl
Flowers102 has 2463 test samples
loaded image features from cache/image_features.y_truth.Flowers102coca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  65.57044386863708
EVALUATING ON DATASET:  Food101
Reading split from /scratch/cliao25/food-101/split_zhou_Food101.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/food-101/shot_16-seed_1.pkl
Food101 has 30300 test samples
loaded image features from cache/image_features.y_truth.Food101coca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  82.05610513687134
EVALUATING ON DATASET:  FGVCAircraft
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/fgvc_aircraft/shot_16-seed_1.pkl
FGVCAircraft has 3333 test samples
loaded image features from cache/image_features.y_truth.FGVCAircraftcoca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  31.713169813156128
EVALUATING ON DATASET:  SUN397
Reading split from /scratch/cliao25/sun397/split_zhou_SUN397.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/sun397/shot_16-seed_1.pkl
SUN397 has 19850 test samples
loaded image features from cache/image_features.y_truth.SUN397coca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  67.83878803253174
EVALUATING ON DATASET:  DTD
Reading split from /scratch/cliao25/dtd/split_zhou_DescribableTextures.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/dtd/shot_16-seed_1.pkl
DTD has 1692 test samples
loaded image features from cache/image_features.y_truth.DTDcoca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  61.288416385650635
EVALUATING ON DATASET:  EuroSAT
Reading split from /scratch/cliao25/eurosat/split_zhou_EuroSAT.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/eurosat/shot_16-seed_1.pkl
EuroSAT has 8100 test samples
loaded image features from cache/image_features.y_truth.EuroSATcoca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  52.172839641571045
EVALUATING ON DATASET:  UCF101
Reading split from /scratch/cliao25/ucf101/split_zhou_UCF101.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/ucf101/shot_16-seed_1.pkl
UCF101 has 3783 test samples
loaded image features from cache/image_features.y_truth.UCF101coca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  72.85223007202148
EVALUATING ON DATASET:  ImageNetV2
ImageNetV2 has 10000 test samples
loaded image features from cache/image_features.y_truth.ImageNetV2coca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  62.59999871253967
EVALUATING ON DATASET:  ImageNetSketch
ImageNetSketch has 50889 test samples
loaded image features from cache/image_features.y_truth.ImageNetSketchcoca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  60.16231179237366
EVALUATING ON DATASET:  ImageNetA
ImageNetA has 7500 test samples
loaded image features from cache/image_features.y_truth.ImageNetAcoca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  56.02666735649109
EVALUATING ON DATASET:  ImageNetR
ImageNetR has 30000 test samples
loaded image features from cache/image_features.y_truth.ImageNetRcoca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  87.54000067710876
Results:
,ImageNet,Caltech101,OxfordPets,StanfordCars,Flowers102,Food101,FGVCAircraft,SUN397,DTD,EuroSAT,UCF101,ImageNetV2,ImageNetSketch,ImageNetA,ImageNetR,
coca_ViT-L-14 laion2B-s13B-b90k BLIP ZS,69.2900002002716,96.83570265769958,88.44371438026428,86.29524111747742,65.57044386863708,82.05610513687134,31.713169813156128,67.83878803253174,61.288416385650635,52.172839641571045,72.85223007202148,62.59999871253967,60.16231179237366,56.02666735649109,87.54000067710876,
Namespace(accum_iter=1, adapter=0, adaptive_margin=0.0, bitfit=0, bs=32, cache_dir='/projectnb/textconv/cliao25/data', captioner='BLIP', checkpoint='', d=768, data_dir='/scratch/cliao25', dataset='', ema=0.995, eval_only=0, ice=True, ice_k=5, ice_lambda=0.9, init_lam=0.0, iters_per_epoch=750, label_smoothing=0.0, layer_start_t=9, layer_start_v=9, lora=0, loss='ce', lr=2e-05, lr_decay=0.0, maple=0, margin=0.0, modelname='coca_ViT-L-14', n_descriptors=-1, n_epochs=1, optimizer='sgd', pretrained='laion2B-s13B-b90k', prompt_lr_multi=10.0, rank=4, resblock_adapter=0, samples_per_class=1, save_model=0, seed=1, shallow_prompt_init='a photo of', shots=16, skip_ema_iters=0, ssf=0, subsample_classes='all', temp=60.0, text_prompt_depth=0, text_prompt_length=0, train_text_encoder=0, train_visual_encoder=0, use_all_logits=False, use_fixed_lambda=False, v=3, visual_prompt_depth=0, visual_prompt_length=0, wd=1e-05)
EVALUATING ON DATASET:  ImageNet
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/imagenet/shot_16-seed_1.pkl
ImageNet has 50000 test samples
loaded image features from cache/image_features.y_truth.ImageNetcoca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  68.64599585533142
EVALUATING ON DATASET:  Caltech101
Reading split from /scratch/cliao25/caltech-101/split_zhou_Caltech101.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/caltech-101/shot_16-seed_1.pkl
Caltech101 has 2465 test samples
loaded image features from cache/image_features.y_truth.Caltech101coca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  96.79512977600098
EVALUATING ON DATASET:  OxfordPets
Reading split from /scratch/cliao25/oxford_pets/split_zhou_OxfordPets.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/oxford_pets/shot_16-seed_1.pkl
OxfordPets has 3669 test samples
loaded image features from cache/image_features.y_truth.OxfordPetscoca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  87.43526339530945
EVALUATING ON DATASET:  StanfordCars
Reading split from /scratch/cliao25/stanford_cars/split_zhou_StanfordCars.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/stanford_cars/shot_16-seed_1.pkl
StanfordCars has 8041 test samples
loaded image features from cache/image_features.y_truth.StanfordCarscoca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  85.36251783370972
EVALUATING ON DATASET:  Flowers102
Reading split from /scratch/cliao25/oxford_flowers/split_zhou_OxfordFlowers.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/oxford_flowers/shot_16-seed_1.pkl
Flowers102 has 2463 test samples
loaded image features from cache/image_features.y_truth.Flowers102coca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  64.3930196762085
EVALUATING ON DATASET:  Food101
Reading split from /scratch/cliao25/food-101/split_zhou_Food101.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/food-101/shot_16-seed_1.pkl
Food101 has 30300 test samples
loaded image features from cache/image_features.y_truth.Food101coca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  81.43564462661743
EVALUATING ON DATASET:  FGVCAircraft
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/fgvc_aircraft/shot_16-seed_1.pkl
FGVCAircraft has 3333 test samples
loaded image features from cache/image_features.y_truth.FGVCAircraftcoca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  31.083106994628906
EVALUATING ON DATASET:  SUN397
Reading split from /scratch/cliao25/sun397/split_zhou_SUN397.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/sun397/shot_16-seed_1.pkl
SUN397 has 19850 test samples
loaded image features from cache/image_features.y_truth.SUN397coca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  67.18387603759766
EVALUATING ON DATASET:  DTD
Reading split from /scratch/cliao25/dtd/split_zhou_DescribableTextures.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/dtd/shot_16-seed_1.pkl
DTD has 1692 test samples
loaded image features from cache/image_features.y_truth.DTDcoca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  60.81560254096985
EVALUATING ON DATASET:  EuroSAT
Reading split from /scratch/cliao25/eurosat/split_zhou_EuroSAT.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/eurosat/shot_16-seed_1.pkl
EuroSAT has 8100 test samples
loaded image features from cache/image_features.y_truth.EuroSATcoca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  51.407408714294434
EVALUATING ON DATASET:  UCF101
Reading split from /scratch/cliao25/ucf101/split_zhou_UCF101.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/ucf101/shot_16-seed_1.pkl
UCF101 has 3783 test samples
loaded image features from cache/image_features.y_truth.UCF101coca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  72.32354879379272
EVALUATING ON DATASET:  ImageNetV2
ImageNetV2 has 10000 test samples
loaded image features from cache/image_features.y_truth.ImageNetV2coca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  62.00000047683716
EVALUATING ON DATASET:  ImageNetSketch
ImageNetSketch has 50889 test samples
loaded image features from cache/image_features.y_truth.ImageNetSketchcoca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  59.80074405670166
EVALUATING ON DATASET:  ImageNetA
ImageNetA has 7500 test samples
loaded image features from cache/image_features.y_truth.ImageNetAcoca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  55.693334341049194
EVALUATING ON DATASET:  ImageNetR
ImageNetR has 30000 test samples
loaded image features from cache/image_features.y_truth.ImageNetRcoca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  87.32666969299316
Results:
,ImageNet,Caltech101,OxfordPets,StanfordCars,Flowers102,Food101,FGVCAircraft,SUN397,DTD,EuroSAT,UCF101,ImageNetV2,ImageNetSketch,ImageNetA,ImageNetR,
coca_ViT-L-14 laion2B-s13B-b90k BLIP ZS,68.64599585533142,96.79512977600098,87.43526339530945,85.36251783370972,64.3930196762085,81.43564462661743,31.083106994628906,67.18387603759766,60.81560254096985,51.407408714294434,72.32354879379272,62.00000047683716,59.80074405670166,55.693334341049194,87.32666969299316,
Namespace(accum_iter=1, adapter=0, adaptive_margin=0.0, bitfit=0, bs=32, cache_dir='/projectnb/textconv/cliao25/data', captioner='BLIP', checkpoint='', d=768, data_dir='/scratch/cliao25', dataset='', ema=0.995, eval_only=0, ice=True, ice_k=5, ice_lambda=1.0, init_lam=0.0, iters_per_epoch=750, label_smoothing=0.0, layer_start_t=9, layer_start_v=9, lora=0, loss='ce', lr=2e-05, lr_decay=0.0, maple=0, margin=0.0, modelname='coca_ViT-L-14', n_descriptors=-1, n_epochs=1, optimizer='sgd', pretrained='laion2B-s13B-b90k', prompt_lr_multi=10.0, rank=4, resblock_adapter=0, samples_per_class=1, save_model=0, seed=1, shallow_prompt_init='a photo of', shots=16, skip_ema_iters=0, ssf=0, subsample_classes='all', temp=60.0, text_prompt_depth=0, text_prompt_length=0, train_text_encoder=0, train_visual_encoder=0, use_all_logits=False, use_fixed_lambda=False, v=3, visual_prompt_depth=0, visual_prompt_length=0, wd=1e-05)
EVALUATING ON DATASET:  ImageNet
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/imagenet/shot_16-seed_1.pkl
ImageNet has 50000 test samples
loaded image features from cache/image_features.y_truth.ImageNetcoca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  67.97999739646912
EVALUATING ON DATASET:  Caltech101
Reading split from /scratch/cliao25/caltech-101/split_zhou_Caltech101.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/caltech-101/shot_16-seed_1.pkl
Caltech101 has 2465 test samples
loaded image features from cache/image_features.y_truth.Caltech101coca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  96.79512977600098
EVALUATING ON DATASET:  OxfordPets
Reading split from /scratch/cliao25/oxford_pets/split_zhou_OxfordPets.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/oxford_pets/shot_16-seed_1.pkl
OxfordPets has 3669 test samples
loaded image features from cache/image_features.y_truth.OxfordPetscoca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  86.37230396270752
EVALUATING ON DATASET:  StanfordCars
Reading split from /scratch/cliao25/stanford_cars/split_zhou_StanfordCars.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/stanford_cars/shot_16-seed_1.pkl
StanfordCars has 8041 test samples
loaded image features from cache/image_features.y_truth.StanfordCarscoca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  84.76557731628418
EVALUATING ON DATASET:  Flowers102
Reading split from /scratch/cliao25/oxford_flowers/split_zhou_OxfordFlowers.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/oxford_flowers/shot_16-seed_1.pkl
Flowers102 has 2463 test samples
loaded image features from cache/image_features.y_truth.Flowers102coca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  63.33739757537842
EVALUATING ON DATASET:  Food101
Reading split from /scratch/cliao25/food-101/split_zhou_Food101.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/food-101/shot_16-seed_1.pkl
Food101 has 30300 test samples
loaded image features from cache/image_features.y_truth.Food101coca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  80.67326545715332
EVALUATING ON DATASET:  FGVCAircraft
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/fgvc_aircraft/shot_16-seed_1.pkl
FGVCAircraft has 3333 test samples
loaded image features from cache/image_features.y_truth.FGVCAircraftcoca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  30.963096022605896
EVALUATING ON DATASET:  SUN397
Reading split from /scratch/cliao25/sun397/split_zhou_SUN397.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/sun397/shot_16-seed_1.pkl
SUN397 has 19850 test samples
loaded image features from cache/image_features.y_truth.SUN397coca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  66.64987206459045
EVALUATING ON DATASET:  DTD
Reading split from /scratch/cliao25/dtd/split_zhou_DescribableTextures.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/dtd/shot_16-seed_1.pkl
DTD has 1692 test samples
loaded image features from cache/image_features.y_truth.DTDcoca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  60.52009463310242
EVALUATING ON DATASET:  EuroSAT
Reading split from /scratch/cliao25/eurosat/split_zhou_EuroSAT.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/eurosat/shot_16-seed_1.pkl
EuroSAT has 8100 test samples
loaded image features from cache/image_features.y_truth.EuroSATcoca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  50.654321908950806
EVALUATING ON DATASET:  UCF101
Reading split from /scratch/cliao25/ucf101/split_zhou_UCF101.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/ucf101/shot_16-seed_1.pkl
UCF101 has 3783 test samples
loaded image features from cache/image_features.y_truth.UCF101coca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  72.00633883476257
EVALUATING ON DATASET:  ImageNetV2
ImageNetV2 has 10000 test samples
loaded image features from cache/image_features.y_truth.ImageNetV2coca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  61.469995975494385
EVALUATING ON DATASET:  ImageNetSketch
ImageNetSketch has 50889 test samples
loaded image features from cache/image_features.y_truth.ImageNetSketchcoca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  59.39004421234131
EVALUATING ON DATASET:  ImageNetA
ImageNetA has 7500 test samples
loaded image features from cache/image_features.y_truth.ImageNetAcoca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  55.133336782455444
EVALUATING ON DATASET:  ImageNetR
ImageNetR has 30000 test samples
loaded image features from cache/image_features.y_truth.ImageNetRcoca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
pushing captions through encoder
pushing captions through encoder
ice acc:  87.07666993141174
Results:
,ImageNet,Caltech101,OxfordPets,StanfordCars,Flowers102,Food101,FGVCAircraft,SUN397,DTD,EuroSAT,UCF101,ImageNetV2,ImageNetSketch,ImageNetA,ImageNetR,
coca_ViT-L-14 laion2B-s13B-b90k BLIP ZS,67.97999739646912,96.79512977600098,86.37230396270752,84.76557731628418,63.33739757537842,80.67326545715332,30.963096022605896,66.64987206459045,60.52009463310242,50.654321908950806,72.00633883476257,61.469995975494385,59.39004421234131,55.133336782455444,87.07666993141174,
