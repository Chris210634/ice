Namespace(accum_iter=1, adapter=0, adaptive_margin=0.0, bitfit=0, bs=32, cache_dir='/projectnb/textconv/cliao25/data', captioner='BLIP', checkpoint='', d=768, data_dir='/scratch/cliao25', dataset='', ema=0.995, eval_only=0, ice=True, ice_k=5, ice_lambda=0.0, init_lam=0.0, iters_per_epoch=750, label_smoothing=0.0, layer_start_t=9, layer_start_v=9, lora=0, loss='ce', lr=2e-05, lr_decay=0.0, maple=0, margin=0.0, modelname='coca_ViT-L-14', n_descriptors=-1, n_epochs=1, optimizer='sgd', pretrained='laion2B-s13B-b90k', prompt_lr_multi=10.0, rank=4, resblock_adapter=0, samples_per_class=1, save_model=0, seed=1, shallow_prompt_init='a photo of', shots=16, skip_ema_iters=0, ssf=0, subsample_classes='all', temp=60.0, text_prompt_depth=0, text_prompt_length=0, train_text_encoder=0, train_visual_encoder=0, use_all_logits=True, use_fixed_lambda=True, v=1, visual_prompt_depth=0, visual_prompt_length=0, wd=1e-05)
EVALUATING ON DATASET:  ImageNet
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/imagenet/shot_16-seed_1.pkl
ImageNet has 50000 test samples
loaded image features from cache/image_features.y_truth.ImageNetcoca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
ice acc:  75.02999901771545
EVALUATING ON DATASET:  Caltech101
Reading split from /scratch/cliao25/caltech-101/split_zhou_Caltech101.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/caltech-101/shot_16-seed_1.pkl
Caltech101 has 2465 test samples
loaded image features from cache/image_features.y_truth.Caltech101coca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
ice acc:  97.32251763343811
EVALUATING ON DATASET:  OxfordPets
Reading split from /scratch/cliao25/oxford_pets/split_zhou_OxfordPets.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/oxford_pets/shot_16-seed_1.pkl
OxfordPets has 3669 test samples
loaded image features from cache/image_features.y_truth.OxfordPetscoca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
ice acc:  94.08558011054993
EVALUATING ON DATASET:  StanfordCars
Reading split from /scratch/cliao25/stanford_cars/split_zhou_StanfordCars.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/stanford_cars/shot_16-seed_1.pkl
StanfordCars has 8041 test samples
loaded image features from cache/image_features.y_truth.StanfordCarscoca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
ice acc:  92.63773560523987
EVALUATING ON DATASET:  Flowers102
Reading split from /scratch/cliao25/oxford_flowers/split_zhou_OxfordFlowers.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/oxford_flowers/shot_16-seed_1.pkl
Flowers102 has 2463 test samples
loaded image features from cache/image_features.y_truth.Flowers102coca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
ice acc:  77.01989412307739
EVALUATING ON DATASET:  Food101
Reading split from /scratch/cliao25/food-101/split_zhou_Food101.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/food-101/shot_16-seed_1.pkl
Food101 has 30300 test samples
loaded image features from cache/image_features.y_truth.Food101coca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
ice acc:  87.43894100189209
EVALUATING ON DATASET:  FGVCAircraft
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/fgvc_aircraft/shot_16-seed_1.pkl
FGVCAircraft has 3333 test samples
loaded image features from cache/image_features.y_truth.FGVCAircraftcoca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
ice acc:  36.36363446712494
EVALUATING ON DATASET:  SUN397
Reading split from /scratch/cliao25/sun397/split_zhou_SUN397.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/sun397/shot_16-seed_1.pkl
SUN397 has 19850 test samples
loaded image features from cache/image_features.y_truth.SUN397coca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
ice acc:  73.82367253303528
EVALUATING ON DATASET:  DTD
Reading split from /scratch/cliao25/dtd/split_zhou_DescribableTextures.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/dtd/shot_16-seed_1.pkl
DTD has 1692 test samples
loaded image features from cache/image_features.y_truth.DTDcoca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
ice acc:  57.97872543334961
EVALUATING ON DATASET:  EuroSAT
Reading split from /scratch/cliao25/eurosat/split_zhou_EuroSAT.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/eurosat/shot_16-seed_1.pkl
EuroSAT has 8100 test samples
loaded image features from cache/image_features.y_truth.EuroSATcoca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
ice acc:  57.43209719657898
EVALUATING ON DATASET:  UCF101
Reading split from /scratch/cliao25/ucf101/split_zhou_UCF101.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/ucf101/shot_16-seed_1.pkl
UCF101 has 3783 test samples
loaded image features from cache/image_features.y_truth.UCF101coca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
ice acc:  74.12106394767761
EVALUATING ON DATASET:  ImageNetV2
ImageNetV2 has 10000 test samples
loaded image features from cache/image_features.y_truth.ImageNetV2coca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
ice acc:  67.39000082015991
EVALUATING ON DATASET:  ImageNetSketch
ImageNetSketch has 50889 test samples
loaded image features from cache/image_features.y_truth.ImageNetSketchcoca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
ice acc:  63.52846026420593
EVALUATING ON DATASET:  ImageNetA
ImageNetA has 7500 test samples
loaded image features from cache/image_features.y_truth.ImageNetAcoca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
ice acc:  53.33333611488342
EVALUATING ON DATASET:  ImageNetR
ImageNetR has 30000 test samples
loaded image features from cache/image_features.y_truth.ImageNetRcoca_ViT-L-14laion2B-s13B-b90k.tup
pushing captions through encoder
ice acc:  86.90666556358337
Results:
,ImageNet,Caltech101,OxfordPets,StanfordCars,Flowers102,Food101,FGVCAircraft,SUN397,DTD,EuroSAT,UCF101,ImageNetV2,ImageNetSketch,ImageNetA,ImageNetR,
coca_ViT-L-14 laion2B-s13B-b90k BLIP ZS,75.02999901771545,97.32251763343811,94.08558011054993,92.63773560523987,77.01989412307739,87.43894100189209,36.36363446712494,73.82367253303528,57.97872543334961,57.43209719657898,74.12106394767761,67.39000082015991,63.52846026420593,53.33333611488342,86.90666556358337,
Namespace(accum_iter=1, adapter=0, adaptive_margin=0.0, bitfit=0, bs=32, cache_dir='/projectnb/textconv/cliao25/data', captioner='BLIP', checkpoint='', d=512, data_dir='/scratch/cliao25', dataset='', ema=0.995, eval_only=0, ice=True, ice_k=5, ice_lambda=0.0, init_lam=0.0, iters_per_epoch=750, label_smoothing=0.0, layer_start_t=9, layer_start_v=9, lora=0, loss='ce', lr=2e-05, lr_decay=0.0, maple=0, margin=0.0, modelname='ViT-B-16', n_descriptors=-1, n_epochs=1, optimizer='sgd', pretrained='laion2b_s34b_b88k', prompt_lr_multi=10.0, rank=4, resblock_adapter=0, samples_per_class=1, save_model=0, seed=1, shallow_prompt_init='a photo of', shots=16, skip_ema_iters=0, ssf=0, subsample_classes='all', temp=60.0, text_prompt_depth=0, text_prompt_length=0, train_text_encoder=0, train_visual_encoder=0, use_all_logits=True, use_fixed_lambda=True, v=1, visual_prompt_depth=0, visual_prompt_length=0, wd=1e-05)
EVALUATING ON DATASET:  ImageNet
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/imagenet/shot_16-seed_1.pkl
ImageNet has 50000 test samples
pushing captions through encoder
ice acc:  69.19199824333191
EVALUATING ON DATASET:  Caltech101
Reading split from /scratch/cliao25/caltech-101/split_zhou_Caltech101.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/caltech-101/shot_16-seed_1.pkl
Caltech101 has 2465 test samples
pushing captions through encoder
ice acc:  95.82149982452393
EVALUATING ON DATASET:  OxfordPets
Reading split from /scratch/cliao25/oxford_pets/split_zhou_OxfordPets.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/oxford_pets/shot_16-seed_1.pkl
OxfordPets has 3669 test samples
pushing captions through encoder
ice acc:  90.46061635017395
EVALUATING ON DATASET:  StanfordCars
Reading split from /scratch/cliao25/stanford_cars/split_zhou_StanfordCars.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/stanford_cars/shot_16-seed_1.pkl
StanfordCars has 8041 test samples
pushing captions through encoder
ice acc:  89.75251913070679
EVALUATING ON DATASET:  Flowers102
Reading split from /scratch/cliao25/oxford_flowers/split_zhou_OxfordFlowers.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/oxford_flowers/shot_16-seed_1.pkl
Flowers102 has 2463 test samples
pushing captions through encoder
ice acc:  71.66057825088501
EVALUATING ON DATASET:  Food101
Reading split from /scratch/cliao25/food-101/split_zhou_Food101.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/food-101/shot_16-seed_1.pkl
Food101 has 30300 test samples
pushing captions through encoder
ice acc:  83.27062726020813
EVALUATING ON DATASET:  FGVCAircraft
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/fgvc_aircraft/shot_16-seed_1.pkl
FGVCAircraft has 3333 test samples
pushing captions through encoder
ice acc:  26.432642340660095
EVALUATING ON DATASET:  SUN397
Reading split from /scratch/cliao25/sun397/split_zhou_SUN397.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/sun397/shot_16-seed_1.pkl
SUN397 has 19850 test samples
pushing captions through encoder
ice acc:  70.50881385803223
EVALUATING ON DATASET:  DTD
Reading split from /scratch/cliao25/dtd/split_zhou_DescribableTextures.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/dtd/shot_16-seed_1.pkl
DTD has 1692 test samples
pushing captions through encoder
ice acc:  52.71867513656616
EVALUATING ON DATASET:  EuroSAT
Reading split from /scratch/cliao25/eurosat/split_zhou_EuroSAT.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/eurosat/shot_16-seed_1.pkl
EuroSAT has 8100 test samples
pushing captions through encoder
ice acc:  41.65432155132294
EVALUATING ON DATASET:  UCF101
Reading split from /scratch/cliao25/ucf101/split_zhou_UCF101.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/ucf101/shot_16-seed_1.pkl
UCF101 has 3783 test samples
pushing captions through encoder
ice acc:  65.55643081665039
EVALUATING ON DATASET:  ImageNetV2
ImageNetV2 has 10000 test samples
pushing captions through encoder
ice acc:  61.37999892234802
EVALUATING ON DATASET:  ImageNetSketch
ImageNetSketch has 50889 test samples
pushing captions through encoder
ice acc:  54.84485626220703
EVALUATING ON DATASET:  ImageNetA
ImageNetA has 7500 test samples
pushing captions through encoder
ice acc:  36.68000102043152
EVALUATING ON DATASET:  ImageNetR
ImageNetR has 30000 test samples
pushing captions through encoder
ice acc:  78.77333164215088
Results:
,ImageNet,Caltech101,OxfordPets,StanfordCars,Flowers102,Food101,FGVCAircraft,SUN397,DTD,EuroSAT,UCF101,ImageNetV2,ImageNetSketch,ImageNetA,ImageNetR,
ViT-B-16 laion2b_s34b_b88k BLIP ZS,69.19199824333191,95.82149982452393,90.46061635017395,89.75251913070679,71.66057825088501,83.27062726020813,26.432642340660095,70.50881385803223,52.71867513656616,41.65432155132294,65.55643081665039,61.37999892234802,54.84485626220703,36.68000102043152,78.77333164215088,
Namespace(accum_iter=1, adapter=0, adaptive_margin=0.0, bitfit=0, bs=32, cache_dir='/projectnb/textconv/cliao25/data', captioner='BLIP', checkpoint='', d=512, data_dir='/scratch/cliao25', dataset='', ema=0.995, eval_only=0, ice=True, ice_k=5, ice_lambda=0.0, init_lam=0.0, iters_per_epoch=750, label_smoothing=0.0, layer_start_t=9, layer_start_v=9, lora=0, loss='ce', lr=2e-05, lr_decay=0.0, maple=0, margin=0.0, modelname='ViT-B-32', n_descriptors=-1, n_epochs=1, optimizer='sgd', pretrained='openai', prompt_lr_multi=10.0, rank=4, resblock_adapter=0, samples_per_class=1, save_model=0, seed=1, shallow_prompt_init='a photo of', shots=16, skip_ema_iters=0, ssf=0, subsample_classes='all', temp=60.0, text_prompt_depth=0, text_prompt_length=0, train_text_encoder=0, train_visual_encoder=0, use_all_logits=True, use_fixed_lambda=True, v=1, visual_prompt_depth=0, visual_prompt_length=0, wd=1e-05)
EVALUATING ON DATASET:  ImageNet
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/imagenet/shot_16-seed_1.pkl
ImageNet has 50000 test samples
pushing captions through encoder
ice acc:  61.9159996509552
EVALUATING ON DATASET:  Caltech101
Reading split from /scratch/cliao25/caltech-101/split_zhou_Caltech101.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/caltech-101/shot_16-seed_1.pkl
Caltech101 has 2465 test samples
pushing captions through encoder
ice acc:  91.1156177520752
EVALUATING ON DATASET:  OxfordPets
Reading split from /scratch/cliao25/oxford_pets/split_zhou_OxfordPets.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/oxford_pets/shot_16-seed_1.pkl
OxfordPets has 3669 test samples
pushing captions through encoder
ice acc:  87.32624650001526
EVALUATING ON DATASET:  StanfordCars
Reading split from /scratch/cliao25/stanford_cars/split_zhou_StanfordCars.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/stanford_cars/shot_16-seed_1.pkl
StanfordCars has 8041 test samples
pushing captions through encoder
ice acc:  60.26613712310791
EVALUATING ON DATASET:  Flowers102
Reading split from /scratch/cliao25/oxford_flowers/split_zhou_OxfordFlowers.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/oxford_flowers/shot_16-seed_1.pkl
Flowers102 has 2463 test samples
pushing captions through encoder
ice acc:  66.62606596946716
EVALUATING ON DATASET:  Food101
Reading split from /scratch/cliao25/food-101/split_zhou_Food101.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/food-101/shot_16-seed_1.pkl
Food101 has 30300 test samples
pushing captions through encoder
ice acc:  80.24422526359558
EVALUATING ON DATASET:  FGVCAircraft
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/fgvc_aircraft/shot_16-seed_1.pkl
FGVCAircraft has 3333 test samples
pushing captions through encoder
ice acc:  19.081906974315643
EVALUATING ON DATASET:  SUN397
Reading split from /scratch/cliao25/sun397/split_zhou_SUN397.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/sun397/shot_16-seed_1.pkl
SUN397 has 19850 test samples
pushing captions through encoder
ice acc:  62.12090253829956
EVALUATING ON DATASET:  DTD
Reading split from /scratch/cliao25/dtd/split_zhou_DescribableTextures.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/dtd/shot_16-seed_1.pkl
DTD has 1692 test samples
pushing captions through encoder
ice acc:  41.7257696390152
EVALUATING ON DATASET:  EuroSAT
Reading split from /scratch/cliao25/eurosat/split_zhou_EuroSAT.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/eurosat/shot_16-seed_1.pkl
EuroSAT has 8100 test samples
pushing captions through encoder
ice acc:  40.790122747421265
EVALUATING ON DATASET:  UCF101
Reading split from /scratch/cliao25/ucf101/split_zhou_UCF101.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/ucf101/shot_16-seed_1.pkl
UCF101 has 3783 test samples
pushing captions through encoder
ice acc:  62.12000846862793
EVALUATING ON DATASET:  ImageNetV2
ImageNetV2 has 10000 test samples
pushing captions through encoder
ice acc:  54.60000038146973
EVALUATING ON DATASET:  ImageNetSketch
ImageNetSketch has 50889 test samples
pushing captions through encoder
ice acc:  40.76126515865326
EVALUATING ON DATASET:  ImageNetA
ImageNetA has 7500 test samples
pushing captions through encoder
ice acc:  29.106667637825012
EVALUATING ON DATASET:  ImageNetR
ImageNetR has 30000 test samples
pushing captions through encoder
ice acc:  66.1899983882904
Results:
,ImageNet,Caltech101,OxfordPets,StanfordCars,Flowers102,Food101,FGVCAircraft,SUN397,DTD,EuroSAT,UCF101,ImageNetV2,ImageNetSketch,ImageNetA,ImageNetR,
ViT-B-32 openai BLIP ZS,61.9159996509552,91.1156177520752,87.32624650001526,60.26613712310791,66.62606596946716,80.24422526359558,19.081906974315643,62.12090253829956,41.7257696390152,40.790122747421265,62.12000846862793,54.60000038146973,40.76126515865326,29.106667637825012,66.1899983882904,
Namespace(accum_iter=1, adapter=0, adaptive_margin=0.0, bitfit=0, bs=32, cache_dir='/projectnb/textconv/cliao25/data', captioner='BLIP', checkpoint='', d=768, data_dir='/scratch/cliao25', dataset='', ema=0.995, eval_only=0, ice=True, ice_k=5, ice_lambda=0.0, init_lam=0.0, iters_per_epoch=750, label_smoothing=0.0, layer_start_t=9, layer_start_v=9, lora=0, loss='ce', lr=2e-05, lr_decay=0.0, maple=0, margin=0.0, modelname='ViT-L-14', n_descriptors=-1, n_epochs=1, optimizer='sgd', pretrained='laion2b_s32b_b82k', prompt_lr_multi=10.0, rank=4, resblock_adapter=0, samples_per_class=1, save_model=0, seed=1, shallow_prompt_init='a photo of', shots=16, skip_ema_iters=0, ssf=0, subsample_classes='all', temp=60.0, text_prompt_depth=0, text_prompt_length=0, train_text_encoder=0, train_visual_encoder=0, use_all_logits=True, use_fixed_lambda=True, v=1, visual_prompt_depth=0, visual_prompt_length=0, wd=1e-05)
EVALUATING ON DATASET:  ImageNet
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/imagenet/shot_16-seed_1.pkl
ImageNet has 50000 test samples
pushing captions through encoder
ice acc:  73.28599691390991
EVALUATING ON DATASET:  Caltech101
Reading split from /scratch/cliao25/caltech-101/split_zhou_Caltech101.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/caltech-101/shot_16-seed_1.pkl
Caltech101 has 2465 test samples
pushing captions through encoder
ice acc:  96.43002152442932
EVALUATING ON DATASET:  OxfordPets
Reading split from /scratch/cliao25/oxford_pets/split_zhou_OxfordPets.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/oxford_pets/shot_16-seed_1.pkl
OxfordPets has 3669 test samples
pushing captions through encoder
ice acc:  92.94085502624512
EVALUATING ON DATASET:  StanfordCars
Reading split from /scratch/cliao25/stanford_cars/split_zhou_StanfordCars.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/stanford_cars/shot_16-seed_1.pkl
StanfordCars has 8041 test samples
pushing captions through encoder
ice acc:  91.97861552238464
EVALUATING ON DATASET:  Flowers102
Reading split from /scratch/cliao25/oxford_flowers/split_zhou_OxfordFlowers.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/oxford_flowers/shot_16-seed_1.pkl
Flowers102 has 2463 test samples
pushing captions through encoder
ice acc:  75.76127052307129
EVALUATING ON DATASET:  Food101
Reading split from /scratch/cliao25/food-101/split_zhou_Food101.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/food-101/shot_16-seed_1.pkl
Food101 has 30300 test samples
pushing captions through encoder
ice acc:  85.80858111381531
EVALUATING ON DATASET:  FGVCAircraft
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/fgvc_aircraft/shot_16-seed_1.pkl
FGVCAircraft has 3333 test samples
pushing captions through encoder
ice acc:  34.17341709136963
EVALUATING ON DATASET:  SUN397
Reading split from /scratch/cliao25/sun397/split_zhou_SUN397.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/sun397/shot_16-seed_1.pkl
SUN397 has 19850 test samples
pushing captions through encoder
ice acc:  72.68513441085815
EVALUATING ON DATASET:  DTD
Reading split from /scratch/cliao25/dtd/split_zhou_DescribableTextures.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/dtd/shot_16-seed_1.pkl
DTD has 1692 test samples
pushing captions through encoder
ice acc:  57.03309774398804
EVALUATING ON DATASET:  EuroSAT
Reading split from /scratch/cliao25/eurosat/split_zhou_EuroSAT.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/eurosat/shot_16-seed_1.pkl
EuroSAT has 8100 test samples
pushing captions through encoder
ice acc:  50.62962770462036
EVALUATING ON DATASET:  UCF101
Reading split from /scratch/cliao25/ucf101/split_zhou_UCF101.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/ucf101/shot_16-seed_1.pkl
UCF101 has 3783 test samples
pushing captions through encoder
ice acc:  72.74649143218994
EVALUATING ON DATASET:  ImageNetV2
ImageNetV2 has 10000 test samples
pushing captions through encoder
ice acc:  65.49999713897705
EVALUATING ON DATASET:  ImageNetSketch
ImageNetSketch has 50889 test samples
pushing captions through encoder
ice acc:  61.04855537414551
EVALUATING ON DATASET:  ImageNetA
ImageNetA has 7500 test samples
pushing captions through encoder
ice acc:  47.34666645526886
EVALUATING ON DATASET:  ImageNetR
ImageNetR has 30000 test samples
pushing captions through encoder
ice acc:  85.64000129699707
Results:
,ImageNet,Caltech101,OxfordPets,StanfordCars,Flowers102,Food101,FGVCAircraft,SUN397,DTD,EuroSAT,UCF101,ImageNetV2,ImageNetSketch,ImageNetA,ImageNetR,
ViT-L-14 laion2b_s32b_b82k BLIP ZS,73.28599691390991,96.43002152442932,92.94085502624512,91.97861552238464,75.76127052307129,85.80858111381531,34.17341709136963,72.68513441085815,57.03309774398804,50.62962770462036,72.74649143218994,65.49999713897705,61.04855537414551,47.34666645526886,85.64000129699707,
Namespace(accum_iter=1, adapter=0, adaptive_margin=0.0, bitfit=0, bs=32, cache_dir='/projectnb/textconv/cliao25/data', captioner='BLIP', checkpoint='', d=768, data_dir='/scratch/cliao25', dataset='', ema=0.995, eval_only=0, ice=True, ice_k=5, ice_lambda=0.0, init_lam=0.0, iters_per_epoch=750, label_smoothing=0.0, layer_start_t=9, layer_start_v=9, lora=0, loss='ce', lr=2e-05, lr_decay=0.0, maple=0, margin=0.0, modelname='ViT-L-14', n_descriptors=-1, n_epochs=1, optimizer='sgd', pretrained='openai', prompt_lr_multi=10.0, rank=4, resblock_adapter=0, samples_per_class=1, save_model=0, seed=1, shallow_prompt_init='a photo of', shots=16, skip_ema_iters=0, ssf=0, subsample_classes='all', temp=60.0, text_prompt_depth=0, text_prompt_length=0, train_text_encoder=0, train_visual_encoder=0, use_all_logits=True, use_fixed_lambda=True, v=1, visual_prompt_depth=0, visual_prompt_length=0, wd=1e-05)
EVALUATING ON DATASET:  ImageNet
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/imagenet/shot_16-seed_1.pkl
ImageNet has 50000 test samples
pushing captions through encoder
ice acc:  73.82000088691711
EVALUATING ON DATASET:  Caltech101
Reading split from /scratch/cliao25/caltech-101/split_zhou_Caltech101.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/caltech-101/shot_16-seed_1.pkl
Caltech101 has 2465 test samples
pushing captions through encoder
ice acc:  94.64502930641174
EVALUATING ON DATASET:  OxfordPets
Reading split from /scratch/cliao25/oxford_pets/split_zhou_OxfordPets.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/oxford_pets/shot_16-seed_1.pkl
OxfordPets has 3669 test samples
pushing captions through encoder
ice acc:  93.59498023986816
EVALUATING ON DATASET:  StanfordCars
Reading split from /scratch/cliao25/stanford_cars/split_zhou_StanfordCars.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/stanford_cars/shot_16-seed_1.pkl
StanfordCars has 8041 test samples
pushing captions through encoder
ice acc:  76.85611844062805
EVALUATING ON DATASET:  Flowers102
Reading split from /scratch/cliao25/oxford_flowers/split_zhou_OxfordFlowers.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/oxford_flowers/shot_16-seed_1.pkl
Flowers102 has 2463 test samples
pushing captions through encoder
ice acc:  79.41535115242004
EVALUATING ON DATASET:  Food101
Reading split from /scratch/cliao25/food-101/split_zhou_Food101.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/food-101/shot_16-seed_1.pkl
Food101 has 30300 test samples
pushing captions through encoder
ice acc:  90.87458848953247
EVALUATING ON DATASET:  FGVCAircraft
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/fgvc_aircraft/shot_16-seed_1.pkl
FGVCAircraft has 3333 test samples
pushing captions through encoder
ice acc:  32.763275504112244
EVALUATING ON DATASET:  SUN397
Reading split from /scratch/cliao25/sun397/split_zhou_SUN397.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/sun397/shot_16-seed_1.pkl
SUN397 has 19850 test samples
pushing captions through encoder
ice acc:  67.97984838485718
EVALUATING ON DATASET:  DTD
Reading split from /scratch/cliao25/dtd/split_zhou_DescribableTextures.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/dtd/shot_16-seed_1.pkl
DTD has 1692 test samples
pushing captions through encoder
ice acc:  52.71867513656616
EVALUATING ON DATASET:  EuroSAT
Reading split from /scratch/cliao25/eurosat/split_zhou_EuroSAT.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/eurosat/shot_16-seed_1.pkl
EuroSAT has 8100 test samples
pushing captions through encoder
ice acc:  56.197530031204224
EVALUATING ON DATASET:  UCF101
Reading split from /scratch/cliao25/ucf101/split_zhou_UCF101.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/ucf101/shot_16-seed_1.pkl
UCF101 has 3783 test samples
pushing captions through encoder
ice acc:  74.70261454582214
EVALUATING ON DATASET:  ImageNetV2
ImageNetV2 has 10000 test samples
pushing captions through encoder
ice acc:  67.9699957370758
EVALUATING ON DATASET:  ImageNetSketch
ImageNetSketch has 50889 test samples
pushing captions through encoder
ice acc:  57.930004596710205
EVALUATING ON DATASET:  ImageNetA
ImageNetA has 7500 test samples
pushing captions through encoder
ice acc:  68.26666593551636
EVALUATING ON DATASET:  ImageNetR
ImageNetR has 30000 test samples
pushing captions through encoder
ice acc:  85.51999926567078
Results:
,ImageNet,Caltech101,OxfordPets,StanfordCars,Flowers102,Food101,FGVCAircraft,SUN397,DTD,EuroSAT,UCF101,ImageNetV2,ImageNetSketch,ImageNetA,ImageNetR,
ViT-L-14 openai BLIP ZS,73.82000088691711,94.64502930641174,93.59498023986816,76.85611844062805,79.41535115242004,90.87458848953247,32.763275504112244,67.97984838485718,52.71867513656616,56.197530031204224,74.70261454582214,67.9699957370758,57.930004596710205,68.26666593551636,85.51999926567078,
Namespace(accum_iter=1, adapter=0, adaptive_margin=0.0, bitfit=0, bs=32, cache_dir='/projectnb/textconv/cliao25/data', captioner='BLIP', checkpoint='', d=1024, data_dir='/scratch/cliao25', dataset='', ema=0.995, eval_only=0, ice=True, ice_k=5, ice_lambda=0.0, init_lam=0.0, iters_per_epoch=750, label_smoothing=0.0, layer_start_t=9, layer_start_v=9, lora=0, loss='ce', lr=2e-05, lr_decay=0.0, maple=0, margin=0.0, modelname='ViT-H-14', n_descriptors=-1, n_epochs=1, optimizer='sgd', pretrained='laion2b_s32b_b79k', prompt_lr_multi=10.0, rank=4, resblock_adapter=0, samples_per_class=1, save_model=0, seed=1, shallow_prompt_init='a photo of', shots=16, skip_ema_iters=0, ssf=0, subsample_classes='all', temp=60.0, text_prompt_depth=0, text_prompt_length=0, train_text_encoder=0, train_visual_encoder=0, use_all_logits=True, use_fixed_lambda=True, v=1, visual_prompt_depth=0, visual_prompt_length=0, wd=1e-05)
EVALUATING ON DATASET:  ImageNet
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/imagenet/shot_16-seed_1.pkl
ImageNet has 50000 test samples
pushing captions through encoder
ice acc:  76.81199908256531
EVALUATING ON DATASET:  Caltech101
Reading split from /scratch/cliao25/caltech-101/split_zhou_Caltech101.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/caltech-101/shot_16-seed_1.pkl
Caltech101 has 2465 test samples
pushing captions through encoder
ice acc:  97.56592512130737
EVALUATING ON DATASET:  OxfordPets
Reading split from /scratch/cliao25/oxford_pets/split_zhou_OxfordPets.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/oxford_pets/shot_16-seed_1.pkl
OxfordPets has 3669 test samples
pushing captions through encoder
ice acc:  94.63068842887878
EVALUATING ON DATASET:  StanfordCars
Reading split from /scratch/cliao25/stanford_cars/split_zhou_StanfordCars.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/stanford_cars/shot_16-seed_1.pkl
StanfordCars has 8041 test samples
pushing captions through encoder
ice acc:  93.11031103134155
EVALUATING ON DATASET:  Flowers102
Reading split from /scratch/cliao25/oxford_flowers/split_zhou_OxfordFlowers.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/oxford_flowers/shot_16-seed_1.pkl
Flowers102 has 2463 test samples
pushing captions through encoder
ice acc:  80.91758489608765
EVALUATING ON DATASET:  Food101
Reading split from /scratch/cliao25/food-101/split_zhou_Food101.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/food-101/shot_16-seed_1.pkl
Food101 has 30300 test samples
pushing captions through encoder
ice acc:  90.21121859550476
EVALUATING ON DATASET:  FGVCAircraft
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/fgvc_aircraft/shot_16-seed_1.pkl
FGVCAircraft has 3333 test samples
pushing captions through encoder
ice acc:  42.21422076225281
EVALUATING ON DATASET:  SUN397
Reading split from /scratch/cliao25/sun397/split_zhou_SUN397.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/sun397/shot_16-seed_1.pkl
SUN397 has 19850 test samples
pushing captions through encoder
ice acc:  75.16372799873352
EVALUATING ON DATASET:  DTD
Reading split from /scratch/cliao25/dtd/split_zhou_DescribableTextures.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/dtd/shot_16-seed_1.pkl
DTD has 1692 test samples
pushing captions through encoder
ice acc:  63.77068758010864
EVALUATING ON DATASET:  EuroSAT
Reading split from /scratch/cliao25/eurosat/split_zhou_EuroSAT.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/eurosat/shot_16-seed_1.pkl
EuroSAT has 8100 test samples
pushing captions through encoder
ice acc:  68.74074339866638
EVALUATING ON DATASET:  UCF101
Reading split from /scratch/cliao25/ucf101/split_zhou_UCF101.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/ucf101/shot_16-seed_1.pkl
UCF101 has 3783 test samples
pushing captions through encoder
ice acc:  78.05973887443542
EVALUATING ON DATASET:  ImageNetV2
ImageNetV2 has 10000 test samples
pushing captions through encoder
ice acc:  70.23999691009521
EVALUATING ON DATASET:  ImageNetSketch
ImageNetSketch has 50889 test samples
pushing captions through encoder
ice acc:  65.35400152206421
EVALUATING ON DATASET:  ImageNetA
ImageNetA has 7500 test samples
pushing captions through encoder
ice acc:  58.78666639328003
EVALUATING ON DATASET:  ImageNetR
ImageNetR has 30000 test samples
pushing captions through encoder
ice acc:  87.56666779518127
Results:
,ImageNet,Caltech101,OxfordPets,StanfordCars,Flowers102,Food101,FGVCAircraft,SUN397,DTD,EuroSAT,UCF101,ImageNetV2,ImageNetSketch,ImageNetA,ImageNetR,
ViT-H-14 laion2b_s32b_b79k BLIP ZS,76.81199908256531,97.56592512130737,94.63068842887878,93.11031103134155,80.91758489608765,90.21121859550476,42.21422076225281,75.16372799873352,63.77068758010864,68.74074339866638,78.05973887443542,70.23999691009521,65.35400152206421,58.78666639328003,87.56666779518127,
Namespace(accum_iter=1, adapter=0, adaptive_margin=0.0, bitfit=0, bs=32, cache_dir='/projectnb/textconv/cliao25/data', captioner='BLIP', checkpoint='', d=1024, data_dir='/scratch/cliao25', dataset='', ema=0.995, eval_only=0, ice=True, ice_k=5, ice_lambda=0.0, init_lam=0.0, iters_per_epoch=750, label_smoothing=0.0, layer_start_t=9, layer_start_v=9, lora=0, loss='ce', lr=2e-05, lr_decay=0.0, maple=0, margin=0.0, modelname='ViT-g-14', n_descriptors=-1, n_epochs=1, optimizer='sgd', pretrained='laion2b_s34b_b88k', prompt_lr_multi=10.0, rank=4, resblock_adapter=0, samples_per_class=1, save_model=0, seed=1, shallow_prompt_init='a photo of', shots=16, skip_ema_iters=0, ssf=0, subsample_classes='all', temp=60.0, text_prompt_depth=0, text_prompt_length=0, train_text_encoder=0, train_visual_encoder=0, use_all_logits=True, use_fixed_lambda=True, v=1, visual_prompt_depth=0, visual_prompt_length=0, wd=1e-05)
EVALUATING ON DATASET:  ImageNet
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/imagenet/shot_16-seed_1.pkl
ImageNet has 50000 test samples
pushing captions through encoder
ice acc:  77.67800092697144
EVALUATING ON DATASET:  Caltech101
Reading split from /scratch/cliao25/caltech-101/split_zhou_Caltech101.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/caltech-101/shot_16-seed_1.pkl
Caltech101 has 2465 test samples
pushing captions through encoder
ice acc:  97.36308455467224
EVALUATING ON DATASET:  OxfordPets
Reading split from /scratch/cliao25/oxford_pets/split_zhou_OxfordPets.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/oxford_pets/shot_16-seed_1.pkl
OxfordPets has 3669 test samples
pushing captions through encoder
ice acc:  93.64949464797974
EVALUATING ON DATASET:  StanfordCars
Reading split from /scratch/cliao25/stanford_cars/split_zhou_StanfordCars.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/stanford_cars/shot_16-seed_1.pkl
StanfordCars has 8041 test samples
pushing captions through encoder
ice acc:  93.6450719833374
EVALUATING ON DATASET:  Flowers102
Reading split from /scratch/cliao25/oxford_flowers/split_zhou_OxfordFlowers.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/oxford_flowers/shot_16-seed_1.pkl
Flowers102 has 2463 test samples
pushing captions through encoder
ice acc:  81.60779476165771
EVALUATING ON DATASET:  Food101
Reading split from /scratch/cliao25/food-101/split_zhou_Food101.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/food-101/shot_16-seed_1.pkl
Food101 has 30300 test samples
pushing captions through encoder
ice acc:  89.95709419250488
EVALUATING ON DATASET:  FGVCAircraft
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/fgvc_aircraft/shot_16-seed_1.pkl
FGVCAircraft has 3333 test samples
pushing captions through encoder
ice acc:  44.134411215782166
EVALUATING ON DATASET:  SUN397
Reading split from /scratch/cliao25/sun397/split_zhou_SUN397.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/sun397/shot_16-seed_1.pkl
SUN397 has 19850 test samples
pushing captions through encoder
ice acc:  74.37782883644104
EVALUATING ON DATASET:  DTD
Reading split from /scratch/cliao25/dtd/split_zhou_DescribableTextures.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/dtd/shot_16-seed_1.pkl
DTD has 1692 test samples
pushing captions through encoder
ice acc:  65.30733108520508
EVALUATING ON DATASET:  EuroSAT
Reading split from /scratch/cliao25/eurosat/split_zhou_EuroSAT.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/eurosat/shot_16-seed_1.pkl
EuroSAT has 8100 test samples
pushing captions through encoder
ice acc:  58.37036967277527
EVALUATING ON DATASET:  UCF101
Reading split from /scratch/cliao25/ucf101/split_zhou_UCF101.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/ucf101/shot_16-seed_1.pkl
UCF101 has 3783 test samples
pushing captions through encoder
ice acc:  79.91012334823608
EVALUATING ON DATASET:  ImageNetV2
ImageNetV2 has 10000 test samples
pushing captions through encoder
ice acc:  70.4099953174591
EVALUATING ON DATASET:  ImageNetSketch
ImageNetSketch has 50889 test samples
pushing captions through encoder
ice acc:  66.3778007030487
EVALUATING ON DATASET:  ImageNetA
ImageNetA has 7500 test samples
pushing captions through encoder
ice acc:  59.53333377838135
EVALUATING ON DATASET:  ImageNetR
ImageNetR has 30000 test samples
pushing captions through encoder
ice acc:  88.93666863441467
Results:
,ImageNet,Caltech101,OxfordPets,StanfordCars,Flowers102,Food101,FGVCAircraft,SUN397,DTD,EuroSAT,UCF101,ImageNetV2,ImageNetSketch,ImageNetA,ImageNetR,
ViT-g-14 laion2b_s34b_b88k BLIP ZS,77.67800092697144,97.36308455467224,93.64949464797974,93.6450719833374,81.60779476165771,89.95709419250488,44.134411215782166,74.37782883644104,65.30733108520508,58.37036967277527,79.91012334823608,70.4099953174591,66.3778007030487,59.53333377838135,88.93666863441467,
Namespace(accum_iter=1, adapter=0, adaptive_margin=0.0, bitfit=0, bs=32, cache_dir='/projectnb/textconv/cliao25/data', captioner='BLIP', checkpoint='', d=768, data_dir='/scratch/cliao25', dataset='', ema=0.995, eval_only=0, ice=True, ice_k=5, ice_lambda=0.0, init_lam=0.0, iters_per_epoch=750, label_smoothing=0.0, layer_start_t=9, layer_start_v=9, lora=0, loss='ce', lr=2e-05, lr_decay=0.0, maple=0, margin=0.0, modelname='ViT-L-14', n_descriptors=-1, n_epochs=1, optimizer='sgd', pretrained='datacomp_xl_s13b_b90k', prompt_lr_multi=10.0, rank=4, resblock_adapter=0, samples_per_class=1, save_model=0, seed=1, shallow_prompt_init='a photo of', shots=16, skip_ema_iters=0, ssf=0, subsample_classes='all', temp=60.0, text_prompt_depth=0, text_prompt_length=0, train_text_encoder=0, train_visual_encoder=0, use_all_logits=True, use_fixed_lambda=True, v=1, visual_prompt_depth=0, visual_prompt_length=0, wd=1e-05)
EVALUATING ON DATASET:  ImageNet
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/imagenet/shot_16-seed_1.pkl
ImageNet has 50000 test samples
pushing captions through encoder
ice acc:  78.78199815750122
EVALUATING ON DATASET:  Caltech101
Reading split from /scratch/cliao25/caltech-101/split_zhou_Caltech101.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/caltech-101/shot_16-seed_1.pkl
Caltech101 has 2465 test samples
pushing captions through encoder
ice acc:  97.52535820007324
EVALUATING ON DATASET:  OxfordPets
Reading split from /scratch/cliao25/oxford_pets/split_zhou_OxfordPets.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/oxford_pets/shot_16-seed_1.pkl
OxfordPets has 3669 test samples
pushing captions through encoder
ice acc:  95.06677389144897
EVALUATING ON DATASET:  StanfordCars
Reading split from /scratch/cliao25/stanford_cars/split_zhou_StanfordCars.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/stanford_cars/shot_16-seed_1.pkl
StanfordCars has 8041 test samples
pushing captions through encoder
ice acc:  93.47096681594849
EVALUATING ON DATASET:  Flowers102
Reading split from /scratch/cliao25/oxford_flowers/split_zhou_OxfordFlowers.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/oxford_flowers/shot_16-seed_1.pkl
Flowers102 has 2463 test samples
pushing captions through encoder
ice acc:  82.9882264137268
EVALUATING ON DATASET:  Food101
Reading split from /scratch/cliao25/food-101/split_zhou_Food101.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/food-101/shot_16-seed_1.pkl
Food101 has 30300 test samples
pushing captions through encoder
ice acc:  92.30692982673645
EVALUATING ON DATASET:  FGVCAircraft
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/fgvc_aircraft/shot_16-seed_1.pkl
FGVCAircraft has 3333 test samples
pushing captions through encoder
ice acc:  47.674766182899475
EVALUATING ON DATASET:  SUN397
Reading split from /scratch/cliao25/sun397/split_zhou_SUN397.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/sun397/shot_16-seed_1.pkl
SUN397 has 19850 test samples
pushing captions through encoder
ice acc:  74.29722547531128
EVALUATING ON DATASET:  DTD
Reading split from /scratch/cliao25/dtd/split_zhou_DescribableTextures.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/dtd/shot_16-seed_1.pkl
DTD has 1692 test samples
pushing captions through encoder
ice acc:  63.82978558540344
EVALUATING ON DATASET:  EuroSAT
Reading split from /scratch/cliao25/eurosat/split_zhou_EuroSAT.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/eurosat/shot_16-seed_1.pkl
EuroSAT has 8100 test samples
pushing captions through encoder
ice acc:  66.06172919273376
EVALUATING ON DATASET:  UCF101
Reading split from /scratch/cliao25/ucf101/split_zhou_UCF101.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/ucf101/shot_16-seed_1.pkl
UCF101 has 3783 test samples
pushing captions through encoder
ice acc:  75.12555718421936
EVALUATING ON DATASET:  ImageNetV2
ImageNetV2 has 10000 test samples
pushing captions through encoder
ice acc:  71.8999981880188
EVALUATING ON DATASET:  ImageNetSketch
ImageNetSketch has 50889 test samples
pushing captions through encoder
ice acc:  67.13435053825378
EVALUATING ON DATASET:  ImageNetA
ImageNetA has 7500 test samples
pushing captions through encoder
ice acc:  68.72000098228455
EVALUATING ON DATASET:  ImageNetR
ImageNetR has 30000 test samples
pushing captions through encoder
ice acc:  90.16667008399963
Results:
,ImageNet,Caltech101,OxfordPets,StanfordCars,Flowers102,Food101,FGVCAircraft,SUN397,DTD,EuroSAT,UCF101,ImageNetV2,ImageNetSketch,ImageNetA,ImageNetR,
ViT-L-14 datacomp_xl_s13b_b90k BLIP ZS,78.78199815750122,97.52535820007324,95.06677389144897,93.47096681594849,82.9882264137268,92.30692982673645,47.674766182899475,74.29722547531128,63.82978558540344,66.06172919273376,75.12555718421936,71.8999981880188,67.13435053825378,68.72000098228455,90.16667008399963,
Namespace(accum_iter=1, adapter=0, adaptive_margin=0.0, bitfit=0, bs=32, cache_dir='/projectnb/textconv/cliao25/data', captioner='BLIP', checkpoint='', d=768, data_dir='/scratch/cliao25', dataset='', ema=0.995, eval_only=0, ice=True, ice_k=5, ice_lambda=0.0, init_lam=0.0, iters_per_epoch=750, label_smoothing=0.0, layer_start_t=9, layer_start_v=9, lora=0, loss='ce', lr=2e-05, lr_decay=0.0, maple=0, margin=0.0, modelname='ViT-L-14-CLIPA', n_descriptors=-1, n_epochs=1, optimizer='sgd', pretrained='datacomp1b', prompt_lr_multi=10.0, rank=4, resblock_adapter=0, samples_per_class=1, save_model=0, seed=1, shallow_prompt_init='a photo of', shots=16, skip_ema_iters=0, ssf=0, subsample_classes='all', temp=60.0, text_prompt_depth=0, text_prompt_length=0, train_text_encoder=0, train_visual_encoder=0, use_all_logits=True, use_fixed_lambda=True, v=1, visual_prompt_depth=0, visual_prompt_length=0, wd=1e-05)
EVALUATING ON DATASET:  ImageNet
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/imagenet/shot_16-seed_1.pkl
ImageNet has 50000 test samples
pushing captions through encoder
ice acc:  77.73999571800232
EVALUATING ON DATASET:  Caltech101
Reading split from /scratch/cliao25/caltech-101/split_zhou_Caltech101.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/caltech-101/shot_16-seed_1.pkl
Caltech101 has 2465 test samples
pushing captions through encoder
ice acc:  97.20081090927124
EVALUATING ON DATASET:  OxfordPets
Reading split from /scratch/cliao25/oxford_pets/split_zhou_OxfordPets.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/oxford_pets/shot_16-seed_1.pkl
OxfordPets has 3669 test samples
pushing captions through encoder
ice acc:  93.21340918540955
EVALUATING ON DATASET:  StanfordCars
Reading split from /scratch/cliao25/stanford_cars/split_zhou_StanfordCars.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/stanford_cars/shot_16-seed_1.pkl
StanfordCars has 8041 test samples
pushing captions through encoder
ice acc:  92.77453422546387
EVALUATING ON DATASET:  Flowers102
Reading split from /scratch/cliao25/oxford_flowers/split_zhou_OxfordFlowers.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/oxford_flowers/shot_16-seed_1.pkl
Flowers102 has 2463 test samples
pushing captions through encoder
ice acc:  79.94316220283508
EVALUATING ON DATASET:  Food101
Reading split from /scratch/cliao25/food-101/split_zhou_Food101.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/food-101/shot_16-seed_1.pkl
Food101 has 30300 test samples
pushing captions through encoder
ice acc:  91.77557826042175
EVALUATING ON DATASET:  FGVCAircraft
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/fgvc_aircraft/shot_16-seed_1.pkl
FGVCAircraft has 3333 test samples
pushing captions through encoder
ice acc:  42.45424270629883
EVALUATING ON DATASET:  SUN397
Reading split from /scratch/cliao25/sun397/split_zhou_SUN397.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/sun397/shot_16-seed_1.pkl
SUN397 has 19850 test samples
pushing captions through encoder
ice acc:  71.85893654823303
EVALUATING ON DATASET:  DTD
Reading split from /scratch/cliao25/dtd/split_zhou_DescribableTextures.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/dtd/shot_16-seed_1.pkl
DTD has 1692 test samples
pushing captions through encoder
ice acc:  57.6241135597229
EVALUATING ON DATASET:  EuroSAT
Reading split from /scratch/cliao25/eurosat/split_zhou_EuroSAT.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/eurosat/shot_16-seed_1.pkl
EuroSAT has 8100 test samples
pushing captions through encoder
ice acc:  56.18518590927124
EVALUATING ON DATASET:  UCF101
Reading split from /scratch/cliao25/ucf101/split_zhou_UCF101.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/ucf101/shot_16-seed_1.pkl
UCF101 has 3783 test samples
pushing captions through encoder
ice acc:  75.4692018032074
EVALUATING ON DATASET:  ImageNetV2
ImageNetV2 has 10000 test samples
pushing captions through encoder
ice acc:  71.38999700546265
EVALUATING ON DATASET:  ImageNetSketch
ImageNetSketch has 50889 test samples
pushing captions through encoder
ice acc:  65.85902571678162
EVALUATING ON DATASET:  ImageNetA
ImageNetA has 7500 test samples
pushing captions through encoder
ice acc:  71.77333235740662
EVALUATING ON DATASET:  ImageNetR
ImageNetR has 30000 test samples
pushing captions through encoder
ice acc:  90.78333377838135
Results:
,ImageNet,Caltech101,OxfordPets,StanfordCars,Flowers102,Food101,FGVCAircraft,SUN397,DTD,EuroSAT,UCF101,ImageNetV2,ImageNetSketch,ImageNetA,ImageNetR,
ViT-L-14-CLIPA datacomp1b BLIP ZS,77.73999571800232,97.20081090927124,93.21340918540955,92.77453422546387,79.94316220283508,91.77557826042175,42.45424270629883,71.85893654823303,57.6241135597229,56.18518590927124,75.4692018032074,71.38999700546265,65.85902571678162,71.77333235740662,90.78333377838135,
Namespace(accum_iter=1, adapter=0, adaptive_margin=0.0, bitfit=0, bs=32, cache_dir='/projectnb/textconv/cliao25/data', captioner='BLIP', checkpoint='', d=1024, data_dir='/scratch/cliao25', dataset='', ema=0.995, eval_only=0, ice=True, ice_k=5, ice_lambda=0.0, init_lam=0.0, iters_per_epoch=750, label_smoothing=0.0, layer_start_t=9, layer_start_v=9, lora=0, loss='ce', lr=2e-05, lr_decay=0.0, maple=0, margin=0.0, modelname='ViT-H-14-CLIPA', n_descriptors=-1, n_epochs=1, optimizer='sgd', pretrained='datacomp1b', prompt_lr_multi=10.0, rank=4, resblock_adapter=0, samples_per_class=1, save_model=0, seed=1, shallow_prompt_init='a photo of', shots=16, skip_ema_iters=0, ssf=0, subsample_classes='all', temp=60.0, text_prompt_depth=0, text_prompt_length=0, train_text_encoder=0, train_visual_encoder=0, use_all_logits=True, use_fixed_lambda=True, v=1, visual_prompt_depth=0, visual_prompt_length=0, wd=1e-05)
EVALUATING ON DATASET:  ImageNet
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/imagenet/shot_16-seed_1.pkl
ImageNet has 50000 test samples
pushing captions through encoder
ice acc:  79.43999767303467
EVALUATING ON DATASET:  Caltech101
Reading split from /scratch/cliao25/caltech-101/split_zhou_Caltech101.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/caltech-101/shot_16-seed_1.pkl
Caltech101 has 2465 test samples
pushing captions through encoder
ice acc:  97.6064920425415
EVALUATING ON DATASET:  OxfordPets
Reading split from /scratch/cliao25/oxford_pets/split_zhou_OxfordPets.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/oxford_pets/shot_16-seed_1.pkl
OxfordPets has 3669 test samples
pushing captions through encoder
ice acc:  95.50285935401917
EVALUATING ON DATASET:  StanfordCars
Reading split from /scratch/cliao25/stanford_cars/split_zhou_StanfordCars.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/stanford_cars/shot_16-seed_1.pkl
StanfordCars has 8041 test samples
pushing captions through encoder
ice acc:  94.11765336990356
EVALUATING ON DATASET:  Flowers102
Reading split from /scratch/cliao25/oxford_flowers/split_zhou_OxfordFlowers.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/oxford_flowers/shot_16-seed_1.pkl
Flowers102 has 2463 test samples
pushing captions through encoder
ice acc:  83.96264910697937
EVALUATING ON DATASET:  Food101
Reading split from /scratch/cliao25/food-101/split_zhou_Food101.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/food-101/shot_16-seed_1.pkl
Food101 has 30300 test samples
pushing captions through encoder
ice acc:  92.98349618911743
EVALUATING ON DATASET:  FGVCAircraft
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/fgvc_aircraft/shot_16-seed_1.pkl
FGVCAircraft has 3333 test samples
pushing captions through encoder
ice acc:  46.684667468070984
EVALUATING ON DATASET:  SUN397
Reading split from /scratch/cliao25/sun397/split_zhou_SUN397.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/sun397/shot_16-seed_1.pkl
SUN397 has 19850 test samples
pushing captions through encoder
ice acc:  73.31989407539368
EVALUATING ON DATASET:  DTD
Reading split from /scratch/cliao25/dtd/split_zhou_DescribableTextures.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/dtd/shot_16-seed_1.pkl
DTD has 1692 test samples
pushing captions through encoder
ice acc:  64.3617033958435
EVALUATING ON DATASET:  EuroSAT
Reading split from /scratch/cliao25/eurosat/split_zhou_EuroSAT.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/eurosat/shot_16-seed_1.pkl
EuroSAT has 8100 test samples
pushing captions through encoder
ice acc:  59.345680475234985
EVALUATING ON DATASET:  UCF101
Reading split from /scratch/cliao25/ucf101/split_zhou_UCF101.json
Loading preprocessed few-shot data from /projectnb/textconv/cliao25/DG/word_soups/datasets/splits/ucf101/shot_16-seed_1.pkl
UCF101 has 3783 test samples
pushing captions through encoder
ice acc:  78.7998914718628
EVALUATING ON DATASET:  ImageNetV2
ImageNetV2 has 10000 test samples
pushing captions through encoder
ice acc:  73.3199954032898
EVALUATING ON DATASET:  ImageNetSketch
ImageNetSketch has 50889 test samples
pushing captions through encoder
ice acc:  69.413822889328
EVALUATING ON DATASET:  ImageNetA
ImageNetA has 7500 test samples
pushing captions through encoder
ice acc:  76.82666778564453
EVALUATING ON DATASET:  ImageNetR
ImageNetR has 30000 test samples
pushing captions through encoder
ice acc:  91.7900025844574
Results:
,ImageNet,Caltech101,OxfordPets,StanfordCars,Flowers102,Food101,FGVCAircraft,SUN397,DTD,EuroSAT,UCF101,ImageNetV2,ImageNetSketch,ImageNetA,ImageNetR,
ViT-H-14-CLIPA datacomp1b BLIP ZS,79.43999767303467,97.6064920425415,95.50285935401917,94.11765336990356,83.96264910697937,92.98349618911743,46.684667468070984,73.31989407539368,64.3617033958435,59.345680475234985,78.7998914718628,73.3199954032898,69.413822889328,76.82666778564453,91.7900025844574,
